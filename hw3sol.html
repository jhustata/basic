

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>HW3 &#8212; Stata Programming</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'hw3sol';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="https://brand.jhu.edu/assets/uploads/sites/5/2014/06/university_logo_small_vertical_blue.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="https://brand.jhu.edu/assets/uploads/sites/5/2014/06/university_logo_small_vertical_blue.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Preface
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter1.html">1. Philosophy, overview, commands, syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter2.html">2. Return values, macros, programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter3.html">3. Loops, Program Syntax, and Miscellany</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter4.html">4. Basic file management, Programming options</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter5.html">5. Review of Weeks 1 - 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter6.html">6 Nested Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter7.html">7. Survival Analysis: Non-parametric, Semi-parametric, Parametric</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter8.html">8. Multilevel, Hierarchical Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickrefs.html">Quick References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fhw3sol.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/hw3sol.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>HW3</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">HW3</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-hw3">Solution to HW3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#annotated-explanation-of-the-hw3-solution-script">Annotated Explanation of the HW3 Solution Script</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-file-path-ambiguity"><strong>Handling File Path Ambiguity</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-explanation"><strong>Code Explanation</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#version-control">Version Control</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#effective-management-of-script-execution-in-stata"><strong>Effective Management of Script Execution in Stata</strong></a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="hw3">
<h1>HW3<a class="headerlink" href="#hw3" title="Permalink to this heading">#</a></h1>
<section id="solution-to-hw3">
<h2>Solution to HW3<a class="headerlink" href="#solution-to-hw3" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">quietly</span> { 
	cls
<span class="k">	if</span> <span class="m">0</span> { <span class="c1">//background, purpose. </span>
		<span class="m">1</span>. HW3 solution
		<span class="m">2</span>. One approach among many
	}
<span class="k">	if</span> <span class="m">1</span> { <span class="c1">//methods, log, settings, data              </span>
<span class="k">        clear</span> 
<span class="k">		capture log close</span>           
<span class="k">        log</span> using <span class="s">&quot;hw3.lastname.firstname.log&quot;</span>,<span class="k"> replace</span>          
<span class="k">        set more</span> off          
		<span class="c1">//by default, stata times-out at 30 seconds</span>
		<span class="c1">//increase if internet is slow, and dataset remote</span>
<span class="k">		set</span> timeout1 <span class="m">1000</span>                      
		<span class="c1">//ambiguity of filepaths is a hallmark of collaboration</span>
		<span class="c1">//lets set up the paths for local and remote data access</span>
<span class="k">        local</span> local_path <span class="s">&quot;/users/d/downloads/hw1.txt&quot;</span> <span class="c1">//change to whatever suits you</span>
<span class="k">		global</span> path <span class="s">&quot;https://github.com/jhustata/basic/raw/main/hw1.txt&quot;</span> <span class="c1">//URL or filepath  </span>
        <span class="c1">//check if the local file exists</span>
<span class="k">		capture confirm file</span> <span class="s">&quot;</span><span class="nv">`local_path&#39;</span><span class="s">&quot;</span>
<span class="k">        if</span> _rc <span class="o">==</span> <span class="m">0</span> {
<span class="c1">           * if the local file exists, use the local path</span>
<span class="k">           global</span> path <span class="s">&quot;</span><span class="nv">`local_path&#39;</span><span class="s">&quot;</span>
        }
<span class="k">        else</span> {
<span class="c1">           * if the local file does not exist, fall back to the URL</span>
<span class="k">           global</span> path <span class="s">&quot;</span><span class="vg">${path}</span><span class="s">&quot;</span>
        }

<span class="c1">        * now proceed to import the data using the defined path</span>
        import delimited <span class="s">&quot;</span><span class="vg">${path}</span><span class="s">&quot;</span>,<span class="k"> clear</span>

	}
<span class="k">    if</span> <span class="m">2</span> { <span class="c1">//results, Q1</span>
<span class="k">        gen</span> htn = dx <span class="o">==</span> <span class="s">&quot;4=Hypertensive&quot;</span>
<span class="k">        replace</span> htn = <span class="m">0</span><span class="k"> if</span> <span class="nf">missing</span>(htn)
        
        <span class="c1">// Label values for hypertension</span>
<span class="k">        label</span> define htn_lab <span class="m">0</span> <span class="s">&quot;No&quot;</span> <span class="m">1</span> <span class="s">&quot;Yes&quot;</span>
<span class="k">        label</span> values htn htn_lab 
<span class="k">        noi tab</span> htn
		
		<span class="c1">// create space between Q1 &amp; Q2</span>
<span class="k">		noi di</span> <span class="s">&quot;&quot;</span> 
<span class="k">		noi di</span> <span class="s">&quot;&quot;</span>
<span class="k">		noi di</span> <span class="s">&quot;&quot;</span>
    }
<span class="k">	if</span> <span class="m">3</span> { <span class="c1">//results, Q2</span>
		<span class="c1">//capture program drop q2</span>
		<span class="c1">//program define q2</span>
		   <span class="c1">//.xlsx output</span>
		   putexcel<span class="k"> set</span> question2,<span class="k"> replace</span> 
		   
		   <span class="c1">//labels</span>
<span class="k">		   label</span> variable init_age <span class="s">&quot;Age, median (IQR)&quot;</span>
<span class="k">		   label</span> variable prev <span class="s">&quot;Previous transplant, %&quot;</span>
		   
		   <span class="c1">//label macros </span>
<span class="k">		   local</span> agelab: variable<span class="k"> label</span> init_age
<span class="k">		   local</span> prevlab: variable<span class="k"> label</span> prev 
<span class="k">			  </span>
<span class="k">		   local</span> start_row = <span class="m">1</span> <span class="c1">//tracking .xlsx output</span>
<span class="k">		   forvalues</span> i = <span class="m">0</span><span class="o">/</span><span class="m">1</span> {
		   	   
			   <span class="c1">//+5 points: for innovative use of loops to avoid repetition</span>
			   <span class="c1">//0=Males, 1=Females </span>
		       <span class="c1">//row 1</span>
<span class="k">			   count if</span> female<span class="o">==</span><span class="nv">`i&#39;</span>  
<span class="k">		       local</span> female<span class="nv">`i&#39;</span>_n=<span class="nf">r</span>(N)
		   
		       <span class="c1">//row2</span>
<span class="k">			   sum</span> init_age<span class="k"> if</span> female<span class="o">==</span><span class="nv">`i&#39;</span>, detail
<span class="k">		       local</span> female<span class="nv">`i&#39;</span>_age_p50:<span class="k"> di</span> <span class="nx">%2.0f</span> <span class="nf">r</span>(p50)
<span class="k">		       local</span> female<span class="nv">`i&#39;</span>_age_p25:<span class="k"> di</span> <span class="nx">%2.0f</span> <span class="nf">r</span>(p25)
<span class="k">		       local</span> female<span class="nv">`i&#39;</span>_age_p75:<span class="k"> di</span> <span class="nx">%2.0f</span> <span class="nf">r</span>(p75)

		       <span class="c1">//row3</span>
<span class="k">		       sum</span> prev<span class="k"> if</span> female<span class="o">==</span><span class="nv">`i&#39;</span>  
<span class="k">		       local</span> female<span class="nv">`i&#39;</span>_prev:<span class="k"> di</span> <span class="nx">%2.1f</span> <span class="nf">r</span>(mean)<span class="o">*</span><span class="m">100</span>
			   
			             <span class="c1">// Output for males and females, assuming they start from row 1</span>
                putexcel A<span class="nv">`start_row&#39;</span> = <span class="s">&quot;Question 2&quot;</span> <span class="cs">///</span>
                   B<span class="nv">`start_row&#39;</span> = <span class="s">&quot;Males (N=</span><span class="nv">`female0_n&#39;</span><span class="s">)&quot;</span> <span class="cs">///</span>
                   C<span class="nv">`start_row&#39;</span> = <span class="s">&quot;Females (N=</span><span class="nv">`female1_n&#39;</span><span class="s">)&quot;</span>

<span class="k">                local</span> age_label = <span class="s">&quot;Age, median (IQR)&quot;</span>
<span class="k">                local</span> age_row = <span class="nv">`start_row&#39;</span> <span class="o">+</span> <span class="m">1</span> <span class="c1">// This will be row 2</span>
                putexcel A<span class="nv">`age_row&#39;</span> = <span class="s">&quot;</span><span class="nv">`age_label&#39;</span><span class="s">&quot;</span> <span class="cs">///</span>
                   B<span class="nv">`age_row&#39;</span> = <span class="s">&quot;</span><span class="nv">`female0_age_p50&#39;</span><span class="s"> (</span><span class="nv">`female0_age_p25&#39;</span><span class="s"> - </span><span class="nv">`female0_age_p75&#39;</span><span class="s">)&quot;</span> <span class="cs">///</span>
                   C<span class="nv">`age_row&#39;</span> = <span class="s">&quot;</span><span class="nv">`female1_age_p50&#39;</span><span class="s"> (</span><span class="nv">`female1_age_p25&#39;</span><span class="s"> - </span><span class="nv">`female1_age_p75&#39;</span><span class="s">)&quot;</span>

<span class="k">                local</span> prev_label = <span class="s">&quot;Previous transplant, %&quot;</span>
<span class="k">                local</span> prev_row = <span class="nv">`age_row&#39;</span> <span class="o">+</span> <span class="m">1</span> <span class="c1">// This will be row 3</span>
                putexcel A<span class="nv">`prev_row&#39;</span> = <span class="s">&quot;</span><span class="nv">`prev_label&#39;</span><span class="s">&quot;</span> <span class="cs">///</span>
                   B<span class="nv">`prev_row&#39;</span> = <span class="s">&quot;</span><span class="nv">`female0_prev&#39;</span><span class="s">&quot;</span> <span class="cs">///</span>
                   C<span class="nv">`prev_row&#39;</span> = <span class="s">&quot;</span><span class="nv">`female1_prev&#39;</span><span class="s">&quot;</span> 
			 
		   }   
		   
		   
		   <span class="c1">//align output for .log file using &quot;_col()&quot;</span>
<span class="k">		    local</span> row1:<span class="k"> di</span> <span class="s">&quot;Question 2&quot;</span> <span class="cs">///</span>
		      _col(<span class="m">30</span>) <span class="s">&quot;Males (N=</span><span class="nv">`female0_n&#39;</span><span class="s">)&quot;</span> <span class="cs">///</span>
		      _col(<span class="m">60</span>) <span class="s">&quot;Females (N=</span><span class="nv">`female1_n&#39;</span><span class="s">)&quot;</span>
<span class="k">		   local</span> row2:<span class="k"> di</span> <span class="s">&quot;</span><span class="nv">`agelab&#39;</span><span class="s">&quot;</span>   <span class="cs">///</span>
		      _col(<span class="m">30</span>) <span class="s">&quot;</span><span class="nv">`female0_age_p50&#39;</span><span class="s"> (</span><span class="nv">`female0_age_p25&#39;</span><span class="s"> - </span><span class="nv">`female0_age_p75&#39;</span><span class="s">)&quot;</span> <span class="cs">///</span>
		      _col(<span class="m">60</span>) <span class="s">&quot;</span><span class="nv">`female1_age_p50&#39;</span><span class="s"> (</span><span class="nv">`female1_age_p25&#39;</span><span class="s"> - </span><span class="nv">`female1_age_p75&#39;</span><span class="s">)&quot;</span>
<span class="k">		   local</span> row3:<span class="k"> di</span> <span class="s">&quot;</span><span class="nv">`prevlab&#39;</span><span class="s">&quot;</span>  <span class="cs">///</span>
		      _col(<span class="m">30</span>) <span class="s">&quot;</span><span class="nv">`female0_prev&#39;</span><span class="s">&quot;</span> <span class="cs">///</span>
			  _col(<span class="m">60</span>) <span class="s">&quot;</span><span class="nv">`female1_prev&#39;</span><span class="s">&quot;</span>
<span class="k">		   local</span> excel_row=<span class="m">1</span>
<span class="k">		   </span>
<span class="k">	   </span>
<span class="k">		   forvalues</span> i=<span class="m">1</span><span class="o">/</span><span class="m">3</span> {
		      
			  <span class="c1">//.log file</span>
<span class="k">			  noi di</span> <span class="s">&quot;</span><span class="nv">`row`i&#39;&#39;</span><span class="s">&quot;</span>	

	       }
 
	}	   
<span class="k">	</span>
<span class="k">	</span>
<span class="k">	log close</span> 
    
	<span class="c1">// Restore initial settings</span>
<span class="k">    set more on</span>
<span class="k">	set</span> timeout1 <span class="m">30</span>
}
</pre></div>
</div>
</section>
<section id="annotated-explanation-of-the-hw3-solution-script">
<h2>Annotated Explanation of the HW3 Solution Script<a class="headerlink" href="#annotated-explanation-of-the-hw3-solution-script" title="Permalink to this heading">#</a></h2>
<p>The script is structured to manage data import and analysis with attention to potential variations in file locations and to perform detailed statistical analysis. Here’s a breakdown with annotations to help you understand each part of the code:</p>
<section id="handling-file-path-ambiguity">
<h3><strong>Handling File Path Ambiguity</strong><a class="headerlink" href="#handling-file-path-ambiguity" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Link to Concept</strong>: The script settings handle <a class="reference external" href="https://en.wikipedia.org/wiki/Sfumato">ambiguity</a> of file paths, a practical challenge when collaborating in different environments.</p></li>
<li><p><strong>Advice</strong>: Use different file paths for collaborators and ensure TA compatibility to avoid losing points.</p></li>
</ul>
</section>
<section id="code-explanation">
<h3><strong>Code Explanation</strong><a class="headerlink" href="#code-explanation" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">quietly</span> { <span class="c1">//first line of code</span>
    cls
<span class="k">    if</span> <span class="m">0</span> { <span class="c1">//background, purpose. </span>
        <span class="m">1</span>. HW3 solution
        <span class="m">2</span>. One approach among many
    } <span class="c1">//last line of code</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Purpose</strong>: This section, though commented out (<code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">0</span></code>), serves as a placeholder for background information or script metadata, which can include the script’s purpose or versioning info.</p></li>
</ul>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">    if</span> <span class="m">1</span> { <span class="c1">//methods, log, settings, data  </span>
        cls              
<span class="k">        clear</span> 
<span class="k">        capture log close</span>           
<span class="k">        log</span> using <span class="s">&quot;hw3.lastname.firstname.log&quot;</span>,<span class="k"> replace</span>          
<span class="k">        set more</span> off          
<span class="k">        set</span> timeout1 <span class="m">1000</span> <span class="c1">// Handling slow network responses</span>
<span class="k">        local</span> local_path <span class="s">&quot;/users/d/downloads/hw1.txt&quot;</span>
<span class="k">        global</span> path <span class="s">&quot;https://github.com/jhustata/basic/raw/main/hw1.txt&quot;</span>  
<span class="k">        </span>
<span class="k">        capture confirm file</span> <span class="s">&quot;</span><span class="nv">`local_path&#39;</span><span class="s">&quot;</span>
<span class="k">        if</span> _rc <span class="o">==</span> <span class="m">0</span> {
<span class="k">            global</span> path <span class="s">&quot;</span><span class="nv">`local_path&#39;</span><span class="s">&quot;</span>
        }<span class="k"> else</span> {
<span class="k">            global</span> path <span class="s">&quot;</span><span class="vg">${path}</span><span class="s">&quot;</span>
        }
        import delimited <span class="s">&quot;</span><span class="vg">${path}</span><span class="s">&quot;</span>,<span class="k"> clear</span>
    }
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Dynamic Path Handling</strong>: This block sets up paths for local and remote data access and uses the <code class="docutils literal notranslate"><span class="pre">capture</span> <span class="pre">confirm</span> <span class="pre">file</span></code> to check if a local file exists, switching to a remote URL if not. This ensures flexibility depending on the user’s environment (source: <a class="reference external" href="https://stackoverflow.com/questions/17414357/using-shell-to-check-whether-a-file-exists-and-only-if-it-does-execute-a-set-o">stackoverflow</a>).</p></li>
<li><p><strong>Logging</strong>: The <code class="docutils literal notranslate"><span class="pre">log</span></code> command starts recording all commands and results, useful for debugging and reviewing the analysis process.</p></li>
</ul>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">    if</span> <span class="m">2</span> { <span class="c1">//results, Q1</span>
<span class="k">        gen</span> htn = dx <span class="o">==</span> <span class="s">&quot;4=Hypertensive&quot;</span>
<span class="k">        replace</span> htn = <span class="m">0</span><span class="k"> if</span> <span class="nf">missing</span>(htn)
<span class="k">        label</span> define htn_lab <span class="m">0</span> <span class="s">&quot;No&quot;</span> <span class="m">1</span> <span class="s">&quot;Yes&quot;</span>
<span class="k">        label</span> values htn htn_lab 
<span class="k">        noi tab</span> htn
<span class="k">        noi di</span> <span class="s">&quot;&quot;</span> 
<span class="k">        noi di</span> <span class="s">&quot;&quot;</span>
<span class="k">        noi di</span> <span class="s">&quot;&quot;</span>
    }
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Data Analysis for Q1</strong>: Analyzes hypertension data, creating and labeling a new variable <code class="docutils literal notranslate"><span class="pre">htn</span></code>. Outputs are neatly tabulated and spaced for clarity. If you only wish to run Q2, you can change <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">2</span></code> to <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">0</span></code>. Never highlight a section of your <code class="docutils literal notranslate"><span class="pre">.do</span></code> file, as you may omit code that defines macros.</p></li>
</ul>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">    if</span> <span class="m">3</span> { <span class="c1">//results, Q2</span>
        putexcel<span class="k"> set</span> question2,<span class="k"> replace</span> 
<span class="k">        label</span> variable init_age <span class="s">&quot;Age, median (IQR)&quot;</span>
<span class="k">        label</span> variable prev <span class="s">&quot;Previous transplant, %&quot;</span>
<span class="k">        </span>
<span class="k">        local</span> start_row = <span class="m">1</span>
<span class="k">        forvalues</span> i = <span class="m">0</span><span class="o">/</span><span class="m">1</span> {
<span class="k">            count if</span> female<span class="o">==</span><span class="nv">`i&#39;</span>  
<span class="k">            local</span> female<span class="nv">`i&#39;</span>_n=<span class="nf">r</span>(N)
<span class="k">            sum</span> init_age<span class="k"> if</span> female<span class="o">==</span><span class="nv">`i&#39;</span>, detail
<span class="k">            local</span> female<span class="nv">`i&#39;</span>_age_p50:<span class="k"> di</span> <span class="nx">%2.0f</span> <span class="nf">r</span>(p50)
<span class="k">            local</span> female<span class="nv">`i&#39;</span>_age_p25:<span class="k"> di</span> <span class="nx">%2.0f</span> <span class="nf">r</span>(p25)
<span class="k">            local</span> female<span class="nv">`i&#39;</span>_age_p75:<span class="k"> di</span> <span class="nx">%2.0f</span> <span class="nf">r</span>(p75)
<span class="k">            sum</span> prev<span class="k"> if</span> female<span class="o">==</span><span class="nv">`i&#39;</span>
<span class="k">            local</span> female<span class="nv">`i&#39;</span>_prev:<span class="k"> di</span> <span class="nx">%2.1f</span> <span class="nf">r</span>(mean)<span class="o">*</span><span class="m">100</span>
            
            putexcel A<span class="nv">`start_row&#39;</span> = <span class="s">&quot;Question 2&quot;</span> B<span class="nv">`start_row&#39;</span> = <span class="s">&quot;Males (N=</span><span class="nv">`female0_n&#39;</span><span class="s">)&quot;</span> C<span class="nv">`start_row&#39;</span> = <span class="s">&quot;Females (N=</span><span class="nv">`female1_n&#39;</span><span class="s">)&quot;</span>
<span class="k">            local</span> age_row = <span class="nv">`start_row&#39;</span> <span class="o">+</span> <span class="m">1</span>
            putexcel A<span class="nv">`age_row&#39;</span> = <span class="s">&quot;Age, median (IQR)&quot;</span> B<span class="nv">`age_row&#39;</span> = <span class="s">&quot;</span><span class="nv">`female0_age_p50&#39;</span><span class="s"> (</span><span class="nv">`female0_age_p25&#39;</span><span class="s"> - </span><span class="nv">`female0_age_p75&#39;</span><span class="s">)&quot;</span> C<span class="nv">`age_row&#39;</span> = <span class="s">&quot;</span><span class="nv">`female1_age_p50&#39;</span><span class="s"> (</span><span class="nv">`female1_age_p25&#39;</span><span class="s"> - </span><span class="nv">`female1_age_p75&#39;</span><span class="s">)&quot;</span>
<span class="k">            local</span> prev_row = <span class="nv">`age_row&#39;</span> <span class="o">+</span> <span class="m">1</span>
            putexcel A<span class="nv">`prev_row&#39;</span> = <span class="s">&quot;Previous transplant, %&quot;</span> B<span class="nv">`prev_row&#39;</span> = <span class="s">&quot;</span><span class="nv">`female0_prev&#39;</span><span class="s">&quot;</span> C<span class="nv">`prev_row&#39;</span> = <span class="s">&quot;</span><span class="nv">`female1_prev&#39;</span><span class="s">&quot;</span>
        }
    }
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Data Analysis for Q2</strong>: More complex, using loops to process gender-specific data. Outputs to Excel, showing innovative data handling and presentation. Labels and macros facilitate dynamic updating of results based on data.</p></li>
</ul>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">    log close</span>
<span class="k">    set more on</span>
<span class="k">    set</span> timeout1 <span class="m">30</span>
}
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Cleanup</strong>: Properly closes the log file and restores Stata settings to their default state to avoid impacting</p></li>
</ul>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="version-control">
<h1>Version Control<a class="headerlink" href="#version-control" title="Permalink to this heading">#</a></h1>
<p>Managing your workflow in Stata effectively, especially when dealing with complex scripts, is crucial for both learning and practical application. Here’s some guidance on this topic:</p>
<section id="effective-management-of-script-execution-in-stata">
<h2><strong>Effective Management of Script Execution in Stata</strong><a class="headerlink" href="#effective-management-of-script-execution-in-stata" title="Permalink to this heading">#</a></h2>
<p><strong>1. Understand Script Sections:</strong></p>
<ul class="simple">
<li><p><strong>Familiarize Yourself:</strong> Before running any part of the script, understand what each section does. This will help you avoid running unnecessary parts that might alter your data or results unintentionally.</p></li>
</ul>
<p><strong>2. Use Conditional Blocks Wisely:</strong></p>
<ul class="simple">
<li><p><strong>Leverage Conditional <code class="docutils literal notranslate"><span class="pre">if</span></code>:</strong> Instead of manually highlighting and running sections of the code, use the conditional <code class="docutils literal notranslate"><span class="pre">if</span></code> statements to control which parts of the script execute. For example, changing <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">1</span></code> to <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">0</span></code> will prevent that block from running without needing to delete or comment out potentially large chunks of code.</p></li>
<li><p><strong>Modularity:</strong> Organize your script into distinct blocks that can be easily turned on or off. This approach helps in focusing on specific analyses or tasks without interference from other parts of the script.</p></li>
</ul>
<p><strong>3. Advantages of Conditional Execution:</strong></p>
<ul class="simple">
<li><p><strong>Reduce Risk of Errors:</strong> By controlling script execution through conditions, you minimize the risk of accidentally running incorrect parts or using outdated data settings.</p></li>
<li><p><strong>Save Time:</strong> Running only relevant sections saves time, particularly with large datasets or complex computations.</p></li>
<li><p><strong>Keep Everything Intact:</strong> Using conditionals allows you to keep all your code in the script for reference without running it. This is especially useful for educational purposes and when scripts are handed over for grading or collaborative projects.</p></li>
</ul>
<p><strong>4. Script Control Examples:</strong></p>
<ul class="simple">
<li><p><strong>Silencing Blocks:</strong> To skip a block, simply change its condition to zero (<code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">0</span></code>). This effectively “silences” the block without removing it from the script. For instance, if you are currently interested only in the results of <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">3</span></code>, you can set <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">2</span></code> to <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>Activating Specific Sections:</strong> To run a specific section, ensure that section’s <code class="docutils literal notranslate"><span class="pre">if</span></code> condition evaluates to true (non-zero). You can manage this dynamically by setting a global or local macro at the beginning of your script and using it in your <code class="docutils literal notranslate"><span class="pre">if</span></code> statements.</p></li>
</ul>
<p><strong>5. Encourage Good Practices:</strong></p>
<ul class="simple">
<li><p><strong>Commenting:</strong> Encourage adding comments on why certain blocks are turned off (e.g., <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">0</span> <span class="pre">//</span> <span class="pre">temporarily</span> <span class="pre">disabled</span> <span class="pre">for</span> <span class="pre">debugging</span></code>).</p></li>
<li><p><strong>Version Control:</strong> Use of version control systems like Git. This allows you to experiment with different script versions without fear of losing the original settings or analyses. <a class="reference external" href="https://github.com">GitHub</a> is the most widely used system for version control. Create an account and start saving your <code class="docutils literal notranslate"><span class="pre">.do</span></code> and <code class="docutils literal notranslate"><span class="pre">.ado</span></code> files there, as well as any other files such as manuscripts, presentations, capstones, theses. More on this in the Intermediate Class.</p></li>
</ul>
<p><strong>6. Example for Clarity:</strong></p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define which sections to run</span>
<span class="k">global</span> run_section1 <span class="m">0</span>  <span class="c1">// Do not run section 1</span>
<span class="k">global</span> run_section2 <span class="m">0</span>  <span class="c1">// Do not run section 2</span>
<span class="k">global</span> run_section3 <span class="m">1</span>  <span class="c1">// Only run section 3</span>

<span class="c1">// Section 1: Data Preparation</span>
<span class="k">if</span> <span class="vg">$run_section1</span> {
    <span class="c1">// Data cleaning and preparation steps here</span>
}

<span class="c1">// Section 2: Initial Analysis</span>
<span class="k">if</span> <span class="vg">$run_section2</span> {
    <span class="c1">// Initial exploratory analysis here</span>
}

<span class="c1">// Section 3: Detailed Analysis</span>
<span class="k">if</span> <span class="vg">$run_section3</span> {
    <span class="c1">// Detailed statistical analysis here</span>
}
</pre></div>
</div>
<p><strong>7. Continuous Learning:</strong></p>
<ul class="simple">
<li><p><strong>Regular Revisions:</strong> Think of <code class="docutils literal notranslate"><span class="pre">.do</span></code> file script management as akin to DNA transcription in a cell. Just as a cell selectively activates certain genes in response to environmental changes, you’re encouraged to adaptively revise your scripts as new data or analysis needs arise. This dynamic process (e.g. changing <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">2</span></code> or the reverse), much like the activation and silencing of genes, ensures that your analytical tools remain responsive and tailored to specific tasks at hand.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">HW3</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-hw3">Solution to HW3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#annotated-explanation-of-the-hw3-solution-script">Annotated Explanation of the HW3 Solution Script</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-file-path-ambiguity"><strong>Handling File Path Ambiguity</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-explanation"><strong>Code Explanation</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#version-control">Version Control</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#effective-management-of-script-execution-in-stata"><strong>Effective Management of Script Execution in Stata</strong></a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Abimereki Muzaale
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>