

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3. Loops, Program Syntax, and Miscellany &#8212; Stata Programming</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter3';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Basic file management, Programming options" href="chapter4.html" />
    <link rel="prev" title="2. Return values, macros, programs" href="chapter2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="https://brand.jhu.edu/assets/uploads/sites/5/2014/06/university_logo_small_vertical_blue.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="https://brand.jhu.edu/assets/uploads/sites/5/2014/06/university_logo_small_vertical_blue.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Preface
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter1.html">1. Philosophy, overview, commands, syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter2.html">2. Return values, macros, programs</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Loops, Program Syntax, and Miscellany</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter4.html">4. Basic file management, Programming options</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter5.html">5. Review of Weeks 1 - 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter6.html">6 Nested, Hierarchical, Multilevel, Longitudinal Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter7.html">7. Visualizing data in Stata</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter8.html">8.Survival Analysis: Non-parametric, Semi-parametric, Parametric</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickrefs.html">Quick References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapter3.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chapter3.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3. Loops, Program Syntax, and Miscellany</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loops">3<span class="xref myst">.</span>1 Loops</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forvalues">3.1.1 <code class="docutils literal notranslate"><span class="pre">forvalues</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-this-does">What This Does</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-it-s-useful">Why It’s Useful</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#but-here-s-the-catch">But Here’s the Catch</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#foreach">3.1.2 <code class="docutils literal notranslate"><span class="pre">foreach</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#syntax-varlist">3.2 <code class="docutils literal notranslate"><span class="pre">syntax</span> <span class="pre">varlist</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#myfirst">3.2.1 myfirst</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mysecond">3.2.2 mysecond</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mythird">3.2.3 mythird</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#myfourth">3.2.4. myfourth</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#miscellany">3.3 Miscellany</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import">3.3.0 <code class="docutils literal notranslate"><span class="pre">import</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xlxs"><code class="docutils literal notranslate"><span class="pre">.xlxs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#csv"><code class="docutils literal notranslate"><span class="pre">.csv</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sav"><code class="docutils literal notranslate"><span class="pre">.sav</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sas7bdat"><code class="docutils literal notranslate"><span class="pre">.sas7bdat</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jdbc">JDBC</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#obdc">OBDC</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#txt"><code class="docutils literal notranslate"><span class="pre">.txt</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#v8xpt-xpt"><code class="docutils literal notranslate"><span class="pre">.v8xpt</span></code>, <code class="docutils literal notranslate"><span class="pre">.xpt</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fred">FRED</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dbf"><code class="docutils literal notranslate"><span class="pre">.dbf</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#commands-that-run-without-additional-syntax">3.3.1 Commands that run without additional syntax</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#anatomy-of-a-command-with-syntax">3.3.2 Anatomy of a command with syntax</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#taking-on-one-or-more-options">3.3.3 Taking on one or more options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#some-command-options-take-arguments-describing-the-options">3.3.4 Some command options take arguments describing the options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#involving-file-name-usually-preceeded-by-using-or-delimited">3.3.5 Involving file name, usually preceeded by <code class="docutils literal notranslate"><span class="pre">using</span></code> or <code class="docutils literal notranslate"><span class="pre">delimited</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulating-data-with-conditional-statements-if-in">3.3.6 Manipulating data with conditional statements: <code class="docutils literal notranslate"><span class="pre">if</span></code>, <code class="docutils literal notranslate"><span class="pre">in</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log">3.3.7 <code class="docutils literal notranslate"><span class="pre">log</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stuff-that-belongs-in-every-do-file">3.3.7 Stuff that belongs in every <code class="docutils literal notranslate"><span class="pre">.do</span></code> file</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-github-to-manage-versions-of-your-do-and-ado-files">3.3.8 Use GitHub to manage versions of your <code class="docutils literal notranslate"><span class="pre">.do</span></code> and <code class="docutils literal notranslate"><span class="pre">ado.</span></code> files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-a-file-into-memory">3.3.9 Loading a file into memory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#describe">3.3.10 <code class="docutils literal notranslate"><span class="pre">describe</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codebook">3.3.12 <code class="docutils literal notranslate"><span class="pre">codebook</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#list">3.3.13 <code class="docutils literal notranslate"><span class="pre">list</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#count">3.3.14 <code class="docutils literal notranslate"><span class="pre">count</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tabulate">3.3.15 <code class="docutils literal notranslate"><span class="pre">tabulate</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summarize">3.3.16 <code class="docutils literal notranslate"><span class="pre">summarize</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#if-missing">3.3.17 <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">missing</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate">3.3.18 <code class="docutils literal notranslate"><span class="pre">generate</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-for-your-practice">3.3.19 More for your practice</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preserve-restore">3.3.20 <code class="docutils literal notranslate"><span class="pre">preserve</span></code>, <code class="docutils literal notranslate"><span class="pre">restore</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#by">3.3.21 <code class="docutils literal notranslate"><span class="pre">by</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creturn-list-ereturn-list-return-list">3.3.22 <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">ereturn</span> <span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">list</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#line-continuation">3.3.23 Line continuation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#label-variable">3.3.24 <code class="docutils literal notranslate"><span class="pre">label</span> <span class="pre">variable</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tag">3.3.25 <code class="docutils literal notranslate"><span class="pre">tag</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drop-keep">3.3.26 <code class="docutils literal notranslate"><span class="pre">drop</span></code>, <code class="docutils literal notranslate"><span class="pre">keep</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replace">3.3.27 <code class="docutils literal notranslate"><span class="pre">replace</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rename">3.3.28 <code class="docutils literal notranslate"><span class="pre">rename</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sort-gsort">3.3.29 <code class="docutils literal notranslate"><span class="pre">sort</span></code>, <code class="docutils literal notranslate"><span class="pre">gsort</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recode">3.3.30 <code class="docutils literal notranslate"><span class="pre">recode</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#display">3.3.31 <code class="docutils literal notranslate"><span class="pre">display</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#capture">3.3.32 <code class="docutils literal notranslate"><span class="pre">capture</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assert">3.3.33 <code class="docutils literal notranslate"><span class="pre">assert</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalars-macros-matrices">3.3.34 Scalars, macros, matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#return-list">3.3.35 <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">list</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-from-the-r-class">Examples from the R-class</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ereturn-list">3.3.36 <code class="docutils literal notranslate"><span class="pre">ereturn</span> <span class="pre">list</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creturn-list">3.3.37 <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#indentation">3.3.38 Indentation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notes-on-indentation">Notes on Indentation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#general-annotation-tips">General Annotation Tips</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regress">3.3.39 <code class="docutils literal notranslate"><span class="pre">regress</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#local">3.3.40 <code class="docutils literal notranslate"><span class="pre">local</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quietly">3.3.41 <code class="docutils literal notranslate"><span class="pre">quietly</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#which">3.3.42 <code class="docutils literal notranslate"><span class="pre">which</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#program-define">3.3.43 <code class="docutils literal notranslate"><span class="pre">program</span> <span class="pre">define</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3.3.44 <code class="docutils literal notranslate"><span class="pre">by</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#egen">3.3.45 <code class="docutils literal notranslate"><span class="pre">egen</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">3.3.46 <code class="docutils literal notranslate"><span class="pre">tag</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#if">3.3.47 <code class="docutils literal notranslate"><span class="pre">if</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for">3.3.48 <code class="docutils literal notranslate"><span class="pre">for</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#table1">3.3.49 <code class="docutils literal notranslate"><span class="pre">table1</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge">3.3.50 <code class="docutils literal notranslate"><span class="pre">merge</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#postfile">3.3.51 <code class="docutils literal notranslate"><span class="pre">postfile</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#export-excel">3.3.52 <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">excel</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#options">3.3.53 Options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set">3.3.54 <code class="docutils literal notranslate"><span class="pre">set</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collapse">3.3.55 <code class="docutils literal notranslate"><span class="pre">collapse</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reshape">3.3.56 <code class="docutils literal notranslate"><span class="pre">reshape</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#expand">3.3.57 <code class="docutils literal notranslate"><span class="pre">expand</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#local-extended">3.3.58 <code class="docutils literal notranslate"><span class="pre">local</span></code>, extended</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#global-vs-local">3.3.59 <code class="docutils literal notranslate"><span class="pre">global</span></code> vs. <code class="docutils literal notranslate"><span class="pre">local</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram">3.3.60 <code class="docutils literal notranslate"><span class="pre">histogram</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#twoway">3.3.61 <code class="docutils literal notranslate"><span class="pre">twoway</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#min-max">3.3.62 <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#strings">3.3.63 strings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#special-numeric-variables-dates-times">3.3.64 special numeric variables: dates &amp; times</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cond">3.3.65 <code class="docutils literal notranslate"><span class="pre">cond</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nested-macros">3.3.70 Nested Macros</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graph">3.3.71 <code class="docutils literal notranslate"><span class="pre">graph</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frame">3.3.80 <code class="docutils literal notranslate"><span class="pre">frame</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#putdocx">3.3.81 <code class="docutils literal notranslate"><span class="pre">putdocx</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#levelsof">3.3.82 <code class="docutils literal notranslate"><span class="pre">levelsof</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tables-beyond-table1">3.3.83 tables beyond <code class="docutils literal notranslate"><span class="pre">table1</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab">3.4 Lab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#homework">3.5 Homework</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-mistakes-from-hw1">Common Mistakes from HW1</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="loops-program-syntax-and-miscellany">
<h1>3. Loops, Program Syntax, and Miscellany<a class="headerlink" href="#loops-program-syntax-and-miscellany" title="Permalink to this heading">#</a></h1>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1">#import numpy as np</span>
<span class="c1">#import sklearn as skl</span>
<span class="c1"># </span>

<span class="c1">#plt.figure(figsize=[2, 2])</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">,</span>  <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">550</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;system&quot;</span><span class="p">,</span>  <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">550</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;program&quot;</span><span class="p">,</span>  <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">960</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;syntax&quot;</span><span class="p">,</span>  <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">950</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;ado&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">550</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;do&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">550</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1900</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;queue&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1900</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;dta&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">475</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1900</span><span class="p">,</span> <span class="o">-</span><span class="mi">475</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;excel&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">4000</span><span class="p">,</span> <span class="o">-</span><span class="mi">475</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1900</span><span class="p">,</span> <span class="o">-</span><span class="mi">475</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;html&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="o">-</span><span class="mi">475</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;publish&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">950</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([</span> <span class="p">(</span><span class="s2">&quot;program&quot;</span><span class="p">,</span><span class="s2">&quot;ado&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;syntax&quot;</span><span class="p">,</span> <span class="s2">&quot;do&quot;</span><span class="p">)])</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s2">&quot;ado&quot;</span><span class="p">,</span> <span class="s2">&quot;command&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;do&quot;</span><span class="p">,</span> <span class="s2">&quot;queue&quot;</span><span class="p">)</span> <span class="p">])</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;results&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;queue&quot;</span><span class="p">,</span> <span class="s2">&quot;results&quot;</span><span class="p">),(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span><span class="s2">&quot;excel&quot;</span><span class="p">),(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span><span class="s2">&quot;word&quot;</span><span class="p">),(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span><span class="s2">&quot;html&quot;</span><span class="p">)])</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span><span class="s2">&quot;dta&quot;</span><span class="p">),(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span><span class="s2">&quot;log&quot;</span><span class="p">)])</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s2">&quot;dta&quot;</span><span class="p">,</span><span class="s2">&quot;publish&quot;</span><span class="p">),(</span><span class="s2">&quot;log&quot;</span><span class="p">,</span><span class="s2">&quot;publish&quot;</span><span class="p">),(</span><span class="s2">&quot;excel&quot;</span><span class="p">,</span><span class="s2">&quot;publish&quot;</span><span class="p">),(</span><span class="s2">&quot;word&quot;</span><span class="p">,</span><span class="s2">&quot;publish&quot;</span><span class="p">),(</span><span class="s2">&quot;html&quot;</span><span class="p">,</span><span class="s2">&quot;publish&quot;</span><span class="p">)])</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> 
        <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="s1">&#39;pos&#39;</span><span class="p">),</span> 
        <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
        <span class="n">font_weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> 
        <span class="n">node_size</span> <span class="o">=</span> <span class="mi">4500</span><span class="p">,</span>
        <span class="n">node_color</span> <span class="o">=</span> <span class="s2">&quot;lightblue&quot;</span><span class="p">,</span>
        <span class="n">linewidths</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s2">&quot;#000000&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/68b0bc74161d7710f53566e5ee9be406db910130ddbc8f918781f1977ed8e80e.png" src="_images/68b0bc74161d7710f53566e5ee9be406db910130ddbc8f918781f1977ed8e80e.png" />
</div>
</div>
<p>By now you should be aware that our key ambitions are to:</p>
<ol class="arabic simple">
<li><p>Learn the commands and syntax that generate output, typically for statistical inference</p></li>
<li><p>Identify the names of the <code class="docutils literal notranslate"><span class="pre">c()</span></code>, <code class="docutils literal notranslate"><span class="pre">r()</span></code>, or <code class="docutils literal notranslate"><span class="pre">e()</span></code> class <u>system-defined</u> macros that define key parameters in our output</p></li>
<li><p>Format these values to fit aesthetic, publication, or editorial criteria and save them as <u>user-defined</u> macros</p></li>
<li><p>Embed the macros into text, graph, or file (.xlsx, .log, .dta, .docx, .html)</p></li>
<li><p>Achieve these aims in a workflow that is automated, collaborative, open, reproducible, legible, user-friendly, and therefore <strong>rigorous</strong></p></li>
</ol>
<p>Today we are going to focus on commands and syntax that exponentially increase our efficiency in coding, a key step towards automation. One way to achieve this is by learning about loops. The other is by writing flexible programs that are driven by user-defined inputs. We’ll also include miscellaneous code-snippets that you’ll incorporate into your loops and programs. Please look out for the <code class="docutils literal notranslate"><span class="pre">macros</span></code> that emerge when you define a loop (e.g. <code class="docutils literal notranslate"><span class="pre">i</span></code>) or program (e.g. <code class="docutils literal notranslate"><span class="pre">varname</span></code>)</p>
<section id="loops">
<h2>3<a class="reference internal" href="loops.html"><span class="doc std std-doc">.</span></a>1 Loops<a class="headerlink" href="#loops" title="Permalink to this heading">#</a></h2>
<section id="forvalues">
<h3>3.1.1 <code class="docutils literal notranslate"><span class="pre">forvalues</span></code><a class="headerlink" href="#forvalues" title="Permalink to this heading">#</a></h3>
<p>In the realm of data analysis, especially when dealing with repetitive tasks, loops are your steadfast allies. They save time, reduce errors, and make your code cleaner. Consider the following Stata code snippet:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">forvalues</span> i = <span class="m">1</span><span class="o">/</span><span class="m">26</span> {
<span class="k">    di</span> <span class="nv">`i&#39;</span>
}
</pre></div>
</div>
<section id="what-this-does">
<h4>What This Does<a class="headerlink" href="#what-this-does" title="Permalink to this heading">#</a></h4>
<p>This loop iterates over a series of numbers—from 1 to 26, in this case. For each iteration, it executes the command <code class="docutils literal notranslate"><span class="pre">di</span></code> (short for “display”), printing the current value of <code class="docutils literal notranslate"><span class="pre">i</span></code> to the screen. At its core, this is a demonstration of Stata’s <code class="docutils literal notranslate"><span class="pre">forvalues</span></code> command, a powerful tool for numeric iterations.</p>
</section>
<section id="why-it-s-useful">
<h4>Why It’s Useful<a class="headerlink" href="#why-it-s-useful" title="Permalink to this heading">#</a></h4>
<p>Imagine you’re tasked with generating a report that requires you to repeatedly perform an action for a set range of numbers. Doing this manually is not only tedious but prone to error. By employing a loop like the one above, you automate the process, ensuring accuracy and efficiency. It’s particularly handy for batch processing of data, running simulations, or automating the generation of graphs for different subsets of your dataset.</p>
</section>
<section id="but-here-s-the-catch">
<h4>But Here’s the Catch<a class="headerlink" href="#but-here-s-the-catch" title="Permalink to this heading">#</a></h4>
<p>While loops are powerful, they come with a caveat: misuse can lead to inefficiencies or, worse, infinite loops that can crash your system or bog down your computations. Always ensure your loop has a clear exit condition. In the example provided, the exit condition is built into the <code class="docutils literal notranslate"><span class="pre">forvalues</span></code> structure, terminating the loop after reaching the number 26.</p>
</section>
</section>
<section id="foreach">
<h3>3.1.2 <code class="docutils literal notranslate"><span class="pre">foreach</span></code><a class="headerlink" href="#foreach" title="Permalink to this heading">#</a></h3>
<p>Looping through numeric ranges is just the tip of the iceberg. When you’re knee-deep in data analysis, more often than not, you’ll find yourself needing to apply operations across numerous variables within your dataset. Here’s where the <code class="docutils literal notranslate"><span class="pre">foreach</span></code> loop comes into play, showcasing its versatility:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span> {
<span class="k">	di</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span>
}
</pre></div>
</div>
<p>Notice the subtle difference between the above code snippet and the one below:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span> {
<span class="k">	di</span> <span class="nv">`v&#39;</span>
}
</pre></div>
</div>
<p>Type <code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">in</span> <span class="pre">1</span></code> to make sense of the above output. Are you interested in this output? How about trying something even more subtle:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span> {
    <span class="c1">// To display the variable label instead</span>
<span class="k">    local</span> vlabel : variable<span class="k"> label</span> <span class="nv">`v&#39;</span>
<span class="k">    di</span> <span class="s">&quot;</span><span class="nv">`vlabel&#39;</span><span class="s">&quot;</span>
}
</pre></div>
</div>
</section>
</section>
<section id="syntax-varlist">
<h2>3.2 <code class="docutils literal notranslate"><span class="pre">syntax</span> <span class="pre">varlist</span></code><a class="headerlink" href="#syntax-varlist" title="Permalink to this heading">#</a></h2>
<p>We wrote our first program last week and it now time to build on that foundation</p>
<section id="myfirst">
<h3>3.2.1 myfirst<a class="headerlink" href="#myfirst" title="Permalink to this heading">#</a></h3>
<p>We revisit our first program here:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">capture program drop</span> myfirst
<span class="k">program</span> define myfirst
   cls
<span class="k">   di</span> <span class="s">&quot;Hello, class!&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Type <code class="docutils literal notranslate"><span class="pre">myfirst</span></code> to execute it</p>
</section>
<section id="mysecond">
<h3>3.2.2 mysecond<a class="headerlink" href="#mysecond" title="Permalink to this heading">#</a></h3>
<p>Let our second program introduce <code class="docutils literal notranslate"><span class="pre">syntax</span> <span class="pre">varlist</span></code></p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">capture program drop</span> mysecond
<span class="k">program</span> define mysecond
<span class="k">     syntax varlist</span>
<span class="k">     di</span> <span class="s">&quot;This is my second program&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Execute this program with the command. Note: it requires <strong>some</strong> syntax beyond the <code class="docutils literal notranslate"><span class="pre">mysecond</span></code> command. In this case not any syntax would do; only a list of at least one of the variables in Stata’s memory. This tells us that we also need to have a dataset in memory to use this command</p>
</section>
<section id="mythird">
<h3>3.2.3 mythird<a class="headerlink" href="#mythird" title="Permalink to this heading">#</a></h3>
<p>Our third program will perform <strong>something</strong> potentially useful</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">capture program drop</span> mythird
<span class="k">program</span> define mythird
<span class="k">     syntax varlist</span>
<span class="k">        logistic</span> died gender 
<span class="k">end</span>
</pre></div>
</div>
<p>But notice that the code is “hardcoded” to perform stricly one task. How may we make it flexible?</p>
</section>
<section id="myfourth">
<h3>3.2.4. myfourth<a class="headerlink" href="#myfourth" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">capture program drop</span> myfourth
<span class="k">program</span> define myfourth
<span class="k">     syntax varlist</span>
<span class="k">	 logistic</span> <span class="nv">`varlist&#39;</span>	 
<span class="k">end</span>
</pre></div>
</div>
</section>
</section>
<section id="miscellany">
<h2>3.3 Miscellany<a class="headerlink" href="#miscellany" title="Permalink to this heading">#</a></h2>
<p>In this section, we continue what was began in <code class="docutils literal notranslate"><span class="pre">lab</span> <span class="pre">1</span> <span class="pre">&amp;</span> <span class="pre">2</span></code>: expanding our Stata vocubulary. As we master Program syntax, we’ll need to write programs that give the end-user power, efficiency, and flexibility. And there is no end to this journey. Keep learning something new, and please do share anything interesting you learn with peers and colleagues. We’ll update this section each week so remain vigillant! Ultimately, there’ll be a course Stata syntax <a class="reference internal" href="catalog.html"><span class="doc std std-doc">catalog</span></a></p>
<section id="import">
<h3>3.3.0 <code class="docutils literal notranslate"><span class="pre">import</span></code><a class="headerlink" href="#import" title="Permalink to this heading">#</a></h3>
<p>You might find comfort in the familiar <code class="docutils literal notranslate"><span class="pre">.dta</span></code> format presented to you during your Epidemiology and Biostatistics classes. However, when you collaborate with other researchers within or outside your institution, there is no guarantee that <code class="docutils literal notranslate"><span class="pre">.dta</span></code> will be the format of datasets available to you. So use this as a resource to quickly reference the syntax you may need. The choices here are based on the Stata dropdown menu: <code class="docutils literal notranslate"><span class="pre">file</span> <span class="pre">&gt;</span> <span class="pre">import</span></code>. Here’s a <a class="reference external" href="https://jhustata.github.io/basic/import_data.html">resource</a> you may use. Otherwise, this section will be updated each week to offer more examples for your practice.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.xlxs</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.csv</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.sav</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.sas7bdat</span></code></p></li>
<li><p>JDBC data source</p></li>
<li><p>ODBC data source</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.txt</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.v8xpt</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.xpt</span></code></p></li>
<li><p>FRED</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.dbf</span></code></p></li>
</ol>
<section id="xlxs">
<h4><code class="docutils literal notranslate"><span class="pre">.xlxs</span></code><a class="headerlink" href="#xlxs" title="Permalink to this heading">#</a></h4>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>import excel <span class="s">&quot;https://raw.githubusercontent.com/jhustata/book/main/1-first%20gen%20antihisitamines.xlsx&quot;</span>, sheet(<span class="s">&quot;de-duplicated list&quot;</span>)<span class="k"> clear</span>
</pre></div>
</div>
</section>
<section id="csv">
<h4><code class="docutils literal notranslate"><span class="pre">.csv</span></code><a class="headerlink" href="#csv" title="Permalink to this heading">#</a></h4>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>import delimited <span class="s">&quot;https://raw.githubusercontent.com/jhustata/basic/main/entry_poll.csv&quot;</span>, bindquote(strict) varn(<span class="m">1</span>)<span class="k"> clear</span> 

<span class="c1">//learn more about the options</span>
<span class="k">help</span> import delimited
</pre></div>
</div>
</section>
<section id="sav">
<h4><code class="docutils literal notranslate"><span class="pre">.sav</span></code><a class="headerlink" href="#sav" title="Permalink to this heading">#</a></h4>
<p>Coming soon</p>
</section>
<section id="sas7bdat">
<h4><code class="docutils literal notranslate"><span class="pre">.sas7bdat</span></code><a class="headerlink" href="#sas7bdat" title="Permalink to this heading">#</a></h4>
<p>Coming soon</p>
</section>
<section id="jdbc">
<h4>JDBC<a class="headerlink" href="#jdbc" title="Permalink to this heading">#</a></h4>
<p>Coming soon</p>
</section>
<section id="obdc">
<h4>OBDC<a class="headerlink" href="#obdc" title="Permalink to this heading">#</a></h4>
<p>Coming soon</p>
</section>
<section id="txt">
<h4><code class="docutils literal notranslate"><span class="pre">.txt</span></code><a class="headerlink" href="#txt" title="Permalink to this heading">#</a></h4>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>import delimited <span class="s">&quot;https://github.com/jhustata/book/raw/main/hw1.html&quot;</span>,<span class="k"> clear</span>
</pre></div>
</div>
<p>You used this for your <a class="reference external" href="https://jhustata.github.io/basic/chapter1.html#homework">HW1</a></p>
</section>
<section id="v8xpt-xpt">
<h4><code class="docutils literal notranslate"><span class="pre">.v8xpt</span></code>, <code class="docutils literal notranslate"><span class="pre">.xpt</span></code><a class="headerlink" href="#v8xpt-xpt" title="Permalink to this heading">#</a></h4>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>import sasxport5 <span class="s">&quot;https://wwwn.cdc.gov/Nchs/Nhanes/1999-2000/DEMO.XPT&quot;</span>,<span class="k"> clear</span>
</pre></div>
</div>
<p>Codebook available <a class="reference external" href="https://wwwn.cdc.gov/Nchs/Nhanes/1999-2000/DEMO.htm">here</a></p>
</section>
<section id="fred">
<h4>FRED<a class="headerlink" href="#fred" title="Permalink to this heading">#</a></h4>
<p>Coming soon</p>
</section>
<section id="dbf">
<h4><code class="docutils literal notranslate"><span class="pre">.dbf</span></code><a class="headerlink" href="#dbf" title="Permalink to this heading">#</a></h4>
<p>Coming soon</p>
</section>
</section>
<section id="commands-that-run-without-additional-syntax">
<h3>3.3.1 Commands that run without additional syntax<a class="headerlink" href="#commands-that-run-without-additional-syntax" title="Permalink to this heading">#</a></h3>
<p>We’ll use this familiar <code class="docutils literal notranslate"><span class="pre">.dta</span></code> dataset for most of the examples in this section</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> transplants,<span class="k"> clear</span>
</pre></div>
</div>
<p>Learn a little more about your dataset:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">describe</span>
<span class="k">summarize</span>
<span class="k">exit</span> <span class="c1">//don&#39;t include in your homeworks!!</span>
</pre></div>
</div>
</section>
<section id="anatomy-of-a-command-with-syntax">
<h3>3.3.2 Anatomy of a command with syntax<a class="headerlink" href="#anatomy-of-a-command-with-syntax" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">summarize</span> wait_yrs age
<span class="k">tab</span> rec_hcv
<span class="k">regress</span> wait_yrs age rec_hcv
</pre></div>
</div>
</section>
<section id="taking-on-one-or-more-options">
<h3>3.3.3 Taking on one or more options<a class="headerlink" href="#taking-on-one-or-more-options" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">describe</span>, fullnames
<span class="k">exit</span>,<span class="k"> clear</span>
<span class="k">tab</span> race prev_ki, col nofreq
</pre></div>
</div>
</section>
<section id="some-command-options-take-arguments-describing-the-options">
<h3>3.3.4 Some command options take arguments describing the options<a class="headerlink" href="#some-command-options-take-arguments-describing-the-options" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">tab</span> rec_education, <span class="k"> sum</span>(age)
<span class="k">regress</span> wait_yrs age, level(<span class="m">90</span>)
</pre></div>
</div>
</section>
<section id="involving-file-name-usually-preceeded-by-using-or-delimited">
<h3>3.3.5 Involving file name, usually preceeded by <code class="docutils literal notranslate"><span class="pre">using</span></code> or <code class="docutils literal notranslate"><span class="pre">delimited</span></code><a class="headerlink" href="#involving-file-name-usually-preceeded-by-using-or-delimited" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">append</span> using transplants<span class="m">.</span>dta
<span class="k">insheet</span> using transplants<span class="m">.</span>txt
</pre></div>
</div>
</section>
<section id="manipulating-data-with-conditional-statements-if-in">
<h3>3.3.6 Manipulating data with conditional statements: <code class="docutils literal notranslate"><span class="pre">if</span></code>, <code class="docutils literal notranslate"><span class="pre">in</span></code><a class="headerlink" href="#manipulating-data-with-conditional-statements-if-in" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">count if</span> age <span class="o">&gt;</span> <span class="m">50</span>
<span class="k">list</span> age dx rec_education<span class="k"> in</span> <span class="m">1</span><span class="o">/</span><span class="m">5</span>
</pre></div>
</div>
</section>
<section id="log">
<h3>3.3.7 <code class="docutils literal notranslate"><span class="pre">log</span></code><a class="headerlink" href="#log" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">log</span> using filename<span class="m">.</span>log,<span class="k"> replace</span> 
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">log close</span>
</pre></div>
</div>
</section>
<section id="stuff-that-belongs-in-every-do-file">
<h3>3.3.7 Stuff that belongs in every <code class="docutils literal notranslate"><span class="pre">.do</span></code> file<a class="headerlink" href="#stuff-that-belongs-in-every-do-file" title="Permalink to this heading">#</a></h3>
<p>Review the <a class="reference external" href="https://jhustata.github.io/basic/quickrefs.html#datasets-and-supplementary-materials">supplemental .do files</a> for examples</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//log</span>

<span class="c1">//purpose</span>

<span class="c1">//settings</span>

<span class="c1">//code blocks</span>

<span class="c1">//close log</span>
</pre></div>
</div>
</section>
<section id="use-github-to-manage-versions-of-your-do-and-ado-files">
<h3>3.3.8 Use GitHub to manage versions of your <code class="docutils literal notranslate"><span class="pre">.do</span></code> and <code class="docutils literal notranslate"><span class="pre">ado.</span></code> files<a class="headerlink" href="#use-github-to-manage-versions-of-your-do-and-ado-files" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>The days of having filenames such as <code class="docutils literal notranslate"><span class="pre">project.do</span></code>, <code class="docutils literal notranslate"><span class="pre">project_jul12.do</span></code>, <code class="docutils literal notranslate"><span class="pre">project_final.do</span></code> are over</p></li>
<li><p>You’ll only need a <code class="docutils literal notranslate"><span class="pre">project.do</span></code> and update the version with the same name in the same GitHub repo</p></li>
<li><p>Commit statements will keep track of the version history if you make meaningful “commit” statements each time</p></li>
<li><p>Perhaps consider taking the <a class="reference external" href="https://publichealth.jhu.edu/course/38942">Intermediate class</a> for more on this topic</p></li>
</ul>
</section>
<section id="loading-a-file-into-memory">
<h3>3.3.9 Loading a file into memory<a class="headerlink" href="#loading-a-file-into-memory" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> age dx using transplants
<span class="k">use</span> transplants<span class="k"> in</span> <span class="m">1</span><span class="o">/</span><span class="m">50</span>,<span class="k"> clear</span>
<span class="k">use</span> transplants<span class="k"> in</span> <span class="m">44</span>
<span class="k">use</span> transplants<span class="k"> if</span> rec_work<span class="o">==</span><span class="m">1</span>
<span class="k">use</span> a<span class="o">*</span> p<span class="o">*</span> using transplants<span class="k"> in</span> <span class="m">1</span><span class="o">/</span><span class="m">100</span>
</pre></div>
</div>
</section>
<section id="describe">
<h3>3.3.10 <code class="docutils literal notranslate"><span class="pre">describe</span></code><a class="headerlink" href="#describe" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">describe</span>
<span class="k">describe</span>, simple
<span class="k">describe</span>, short
<span class="k">describe</span> a<span class="o">*</span>
<span class="k">describe</span> using transplants<span class="m">.</span>dta
<span class="k">describe</span> r<span class="o">*</span>, fullnames
</pre></div>
</div>
</section>
<section id="codebook">
<h3>3.3.12 <code class="docutils literal notranslate"><span class="pre">codebook</span></code><a class="headerlink" href="#codebook" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">codebook</span> a<span class="o">*</span><span class="k"> e</span><span class="o">*</span>, compact
<span class="k">codebook</span>, problems
</pre></div>
</div>
</section>
<section id="list">
<h3>3.3.13 <code class="docutils literal notranslate"><span class="pre">list</span></code><a class="headerlink" href="#list" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">list</span>
<span class="k">list</span> prev_ki wait_yrs<span class="k"> if</span> race<span class="o">==</span><span class="m">9</span>
<span class="k">list</span> <span class="o">*</span>date<span class="k"> in</span> <span class="m">1</span><span class="o">/</span><span class="m">10</span>
<span class="k">list</span> dx<span class="k"> in</span> <span class="m">1</span><span class="o">/</span><span class="m">10</span>, clean noobs
<span class="k">list</span> age, fast
</pre></div>
</div>
</section>
<section id="count">
<h3>3.3.14 <code class="docutils literal notranslate"><span class="pre">count</span></code><a class="headerlink" href="#count" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">count</span>
<span class="k">count if</span> rec_work<span class="o">==</span><span class="m">1</span>
<span class="k">count if</span> rec_work<span class="o">!=</span><span class="m">1</span>
<span class="k">count if</span> bmi <span class="o">&lt;</span> <span class="m">20</span>  | bmi <span class="o">&gt;</span> <span class="m">35</span>
<span class="k">count if</span> bmi <span class="o">&gt;</span> <span class="m">25</span> <span class="o">&amp;</span> bmi <span class="o">&lt;</span> <span class="m">30</span><span class="o">&gt;</span>
<span class="k">count if</span> <span class="o">!</span>(age<span class="o">&gt;</span><span class="m">18</span>)
<span class="k">count if</span> <span class="nf">inrange</span>(wait_yrs, <span class="m">4</span>,<span class="m">6</span>)
<span class="k">count if</span> <span class="o">!</span><span class="nf">inlist</span>(gender,<span class="m">0</span>,<span class="m">1</span>)
</pre></div>
</div>
</section>
<section id="tabulate">
<h3>3.3.15 <code class="docutils literal notranslate"><span class="pre">tabulate</span></code><a class="headerlink" href="#tabulate" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//tabulate</span>
<span class="k">tab</span> abo
<span class="k">tab</span> abo rec_hcv
<span class="k">tab</span> gender,<span class="k"> sum</span>(age)
<span class="k">tab</span> dx gender<span class="k"> if</span> age<span class="o">&lt;</span><span class="m">40</span>
<span class="k">tab</span> dx gender,row
<span class="k">tab</span> dx gender,col nofreq

<span class="k">tab</span> dx gender, col nofreq chi2
<span class="k">return list</span> 
</pre></div>
</div>
</section>
<section id="summarize">
<h3>3.3.16 <code class="docutils literal notranslate"><span class="pre">summarize</span></code><a class="headerlink" href="#summarize" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//summarize</span>
<span class="k">sum</span>
<span class="k">return list</span> <span class="c1">//not very useful; see schema above</span>

<span class="k">sum</span> age wait_yrs
<span class="k">return list</span> <span class="c1">//much more useful!</span>

<span class="k">sum</span> age wait_yrs, detail
</pre></div>
</div>
</section>
<section id="if-missing">
<h3>3.3.17 <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">missing</span></code><a class="headerlink" href="#if-missing" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//missingness</span>
<span class="k">count if</span> bmi <span class="o">&gt;</span> <span class="m">30</span>
<span class="k">count if</span> bmi <span class="o">&gt;</span> <span class="m">1000</span> <span class="c1">//wha? </span>
<span class="k">sum</span> bmi <span class="c1">//whats going on?</span>
<span class="k">assert</span> <span class="nf">c</span>(N) <span class="o">==</span> <span class="nf">r</span>(N) <span class="c1">//when do these diverge?</span>
<span class="k">tab</span> bmi<span class="k"> if</span> bmi <span class="o">&gt;</span> <span class="m">1000</span>
<span class="k">tab</span> bmi<span class="k"> if</span> bmi <span class="o">&gt;</span> <span class="m">1000</span>, missing

<span class="k">count if</span> bmi<span class="o">==</span>.
<span class="k">count if</span> bmi<span class="o">==</span>.a
<span class="k">count if</span> <span class="nf">missing</span>(bmi)
</pre></div>
</div>
</section>
<section id="generate">
<h3>3.3.18 <code class="docutils literal notranslate"><span class="pre">generate</span></code><a class="headerlink" href="#generate" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">gen</span> age_lastyear=age<span class="m">-1</span>
<span class="k">g</span> any_college=(rec_educ<span class="o">&gt;=</span><span class="m">3</span>)
<span class="k">g</span> youngman=(age<span class="o">&lt;</span><span class="m">40</span>) <span class="o">&amp;</span> (gender<span class="o">==</span><span class="m">0</span>)
<span class="k">g</span> byte young=(age<span class="o">&lt;</span><span class="m">30</span>)
<span class="k">g</span> age_f=age<span class="k"> if</span> gender<span class="o">==</span><span class="m">1</span>
<span class="k">g</span> age_spline=(age<span class="o">&gt;</span><span class="m">40</span>)<span class="o">*</span>(age<span class="m">-40</span>)
</pre></div>
</div>
</section>
<section id="more-for-your-practice">
<h3>3.3.19 More for your practice<a class="headerlink" href="#more-for-your-practice" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//_n and _N</span>
<span class="k">g</span> new_id=_n
<span class="k">gen</span> total_records=_N
<span class="k">g</span> percentile=<span class="m">100</span><span class="o">*</span>_n<span class="o">/</span>_N
</pre></div>
</div>
</section>
<section id="preserve-restore">
<h3>3.3.20 <code class="docutils literal notranslate"><span class="pre">preserve</span></code>, <code class="docutils literal notranslate"><span class="pre">restore</span></code><a class="headerlink" href="#preserve-restore" title="Permalink to this heading">#</a></h3>
<p>This has briefly been covered in the preceeding section. But lets revisit it:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//preserve &amp; restore</span>
<span class="k">sum</span> age

<span class="c1">//indentation!</span>
<span class="k">preserve</span>
<span class="k">    drop if</span> age<span class="o">&lt;</span><span class="nf">r</span>(mean)
<span class="k">    sum</span> age
<span class="k">restore</span> 

<span class="k">sum</span> age

<span class="c1">//</span>

<span class="k">di</span> <span class="nf">c</span>(N)

<span class="k">di</span> <span class="nf">c</span>(k)
</pre></div>
</div>
<p>Lets create a <code class="docutils literal notranslate"><span class="pre">disturbance</span></code> to our setup to learn a few additional commands and their value to us:</p>
<div class="highlight-Stata notranslate"><div class="highlight"><pre><span></span><span class="k">qui do</span> https:<span class="o">//</span>raw<span class="m">.</span>githubusercontent<span class="m">.</span>com<span class="o">/</span>jhustata<span class="o">/</span>book<span class="o">/</span>main<span class="o">/</span>sample<span class="o">-</span>keep<span class="m">.</span>ado
</pre></div>
</div>
<p>We’ve just installed a program called <code class="docutils literal notranslate"><span class="pre">samplekeep</span></code>. How do I know its name? You can past the URL into your browser to see the raw content and <code class="docutils literal notranslate"><span class="pre">program</span> <span class="pre">syntax</span></code>.</p>
<p>Focus on the structure of the program:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">capture program drop</span> samplekeep
<span class="k">program</span> define samplekeep

<span class="k">	preserve</span> 
	    
       <span class="c1">//code</span>

<span class="k">	restore</span> 
<span class="k">	</span>
<span class="k">end</span>
</pre></div>
</div>
<p>So the .ado program we just installed has code sandwiched between <code class="docutils literal notranslate"><span class="pre">preserve</span></code> and <code class="docutils literal notranslate"><span class="pre">restore</span></code> commands. Let’s executive the program:</p>
<div class="highlight-Stata notranslate"><div class="highlight"><pre><span></span>samplekeep
</pre></div>
</div>
<p>Wow!!</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">di</span> <span class="nf">c</span>(N)

<span class="k">di</span> <span class="nf">c</span>(k)
</pre></div>
</div>
<p>Does any of this make sense?</p>
</section>
<section id="by">
<h3>3.3.21 <code class="docutils literal notranslate"><span class="pre">by</span></code><a class="headerlink" href="#by" title="Permalink to this heading">#</a></h3>
<p>Ok, then. It was a temporary disturbance and peace was <code class="docutils literal notranslate"><span class="pre">restored</span></code>!! We will talk more about the <code class="docutils literal notranslate"><span class="pre">preserve</span></code> and <code class="docutils literal notranslate"><span class="pre">restore</span></code> commands, often used together.</p>
<p>Let’s now explore the <code class="docutils literal notranslate"><span class="pre">by</span></code> command</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">bys</span> abo:<span class="k"> egen</span> age_byabo =<span class="k"> mean</span>(age)
</pre></div>
</div>
<p>Any idea what this command just achieved?</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">codebook</span> age_byabo
</pre></div>
</div>
<p>What do you notice? Only four unique values! The <code class="docutils literal notranslate"><span class="pre">egen</span></code> command, like the <code class="docutils literal notranslate"><span class="pre">gen</span></code> command is used to define new variables in the dataset. However, the <code class="docutils literal notranslate"><span class="pre">gen</span></code> command applies values at the level of the individual. The <code class="docutils literal notranslate"><span class="pre">egen</span></code> command does so <code class="docutils literal notranslate"><span class="pre">by</span></code> group and yields summary <code class="docutils literal notranslate"><span class="pre">estimates</span></code>. To learn more type <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">egen</span></code>.</p>
</section>
<section id="creturn-list-ereturn-list-return-list">
<h3>3.3.22 <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">ereturn</span> <span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">list</span></code><a class="headerlink" href="#creturn-list-ereturn-list-return-list" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">qui regress</span> peak_pra prev_ki
<span class="k">local</span> coef_of_det:<span class="k"> di</span> <span class="nx">%3.2f</span><span class="k"> e</span>(r2_a)<span class="o">*</span><span class="m">100</span>

<span class="k">di</span> <span class="s">&quot;History of kidney transplant explains </span><span class="nv">`coef_of_det&#39;</span><span class="s">% of the variance in peak_pra.&quot;</span>
</pre></div>
</div>
<p>From whence does <code class="docutils literal notranslate"><span class="pre">e(r2_a)</span></code> come? Where does it fit into our schema? (Hint: <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">ereturn</span> <span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code>)</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//lets revisit this </span>
<span class="k">regress</span> age i<span class="m">.</span>abo
<span class="k">lincom</span> _b[<span class="m">3.</span>abo]
</pre></div>
</div>
<p>What blood group has value 3?</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">return list</span>
<span class="k">di</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(p)
<span class="k">di</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(estimate)
</pre></div>
</div>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//does this output look familiar?</span>
<span class="k"> lincom</span> _cons <span class="o">+</span> _b[<span class="m">3.</span>abo]
<span class="k"> return list</span> 

<span class="c1">//regression is a fancy way of estimating means for specified groups</span>
<span class="k"> codebook</span> age_byabo
</pre></div>
</div>
<p>Remember to use <code class="docutils literal notranslate"><span class="pre">lincom</span></code> appropriately, depending on what you wish to describe!</p>
<p>After a regression we may type <code class="docutils literal notranslate"><span class="pre">ereturn</span> <span class="pre">list</span></code> for all sorts of estimated values:</p>
<div class="highlight-Stata notranslate"><div class="highlight"><pre><span></span><span class="k">matrix</span> define b =<span class="k"> e</span>(b)
<span class="k">matrix list</span> b
<span class="k">di</span> b[<span class="m">1</span>,<span class="m">3</span>]
</pre></div>
</div>
</section>
<section id="line-continuation">
<h3>3.3.23 Line continuation<a class="headerlink" href="#line-continuation" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//line continuation</span>

<span class="c1">//Use `///` to make a Stata command span several lines in a .do file</span>

<span class="k">recode</span> race <span class="cs">///</span>
    (<span class="m">1</span>=<span class="m">1</span>) <span class="cs">///</span>
    (<span class="m">2</span>=<span class="m">2</span>) <span class="cs">///</span>
    (<span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="m">7</span> <span class="m">9</span> = <span class="m">9</span>)

<span class="c1">//That is the main-stream approach to line continuation. Ours?</span>

#delimit ;
<span class="k">recode</span> race
    (<span class="m">1</span>=<span class="m">1</span>)
    (<span class="m">2</span>=<span class="m">2</span>)
    (<span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="m">7</span> <span class="m">9</span>)
;
#delimit cr

<span class="c1">//recode+label, with unique line continuation with &quot;delimit&quot;</span>
#delimit ;
<span class="k">recode</span> race 
    (<span class="m">1</span>=<span class="m">0</span> <span class="s">&quot;Cauc&quot;</span>)
    (<span class="m">2</span>=<span class="m">1</span> <span class="s">&quot;AA)</span>
    (<span class="m">4</span>=<span class="m">2</span> <span class="s">&quot;Hisp/Latino&quot;</span>)
    (<span class="m">5</span><span class="o">/</span><span class="m">9</span>=<span class="m">3</span> <span class="s">&quot;Other&quot;</span>),
<span class="k">        gen</span>(race_cat)
;
#delimit cr
</pre></div>
</div>
</section>
<section id="label-variable">
<h3>3.3.24 <code class="docutils literal notranslate"><span class="pre">label</span> <span class="pre">variable</span></code><a class="headerlink" href="#label-variable" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//labels</span>
<span class="k">describe</span> dx
<span class="k">label var</span> dx <span class="s">&quot;kidney disease diagnosis&quot;</span>

<span class="k">tab</span> gender <span class="c1">//is 1 male or female?</span>
#delimit ;
<span class="k">label</span> define g_label 
    <span class="m">0</span> <span class="s">&quot;0=Male&quot;</span>
    <span class="m">1</span> <span class="s">&quot;1-Female&quot;</span>
;
#delimit cr
<span class="k">label</span> values gender g_label
<span class="k">tab</span> gender <span class="c1">//much better</span>
<span class="k">tab</span> gender, nolabel <span class="c1">//don&#39;t show label</span>

<span class="c1">//or?</span>
<span class="k">g</span> female=gender<span class="o">==</span><span class="m">1</span> <span class="c1">//intuitive meaning of 1 &amp; 0</span>
</pre></div>
</div>
</section>
<section id="tag">
<h3>3.3.25 <code class="docutils literal notranslate"><span class="pre">tag</span></code><a class="headerlink" href="#tag" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//tagging</span>
<span class="k">list</span> abo gender spread
<span class="k">egen</span> = tag
<span class="k">egen</span> grouptag = tag(abo gender)
<span class="k">list</span> abo gender spread<span class="k"> if</span> grouptag
</pre></div>
</div>
</section>
<section id="drop-keep">
<h3>3.3.26 <code class="docutils literal notranslate"><span class="pre">drop</span></code>, <code class="docutils literal notranslate"><span class="pre">keep</span></code><a class="headerlink" href="#drop-keep" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//drop, keep</span>
<span class="k">keep</span> age gender bmi fake_id ra<span class="o">*</span>
<span class="k">drop</span> end_date

<span class="c1">//remember: to load the original dataset again</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">keep in</span> <span class="m">1</span><span class="o">/</span><span class="m">100</span>
<span class="k">drop if</span> wait_yrs<span class="o">&lt;</span><span class="m">1</span>
<span class="k">keep if</span> prev_ki<span class="o">==</span><span class="m">1</span>
<span class="k">drop if</span> age<span class="o">&lt;</span><span class="m">18</span> <span class="o">&amp;</span> abo<span class="o">==</span><span class="m">2</span>
</pre></div>
</div>
</section>
<section id="replace">
<h3>3.3.27 <code class="docutils literal notranslate"><span class="pre">replace</span></code><a class="headerlink" href="#replace" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//load data again</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">replace</span> prev=<span class="m">0</span>
<span class="k">replace</span> wait_yrs=<span class="m">5</span><span class="k"> if</span> wait_yrs<span class="o">&gt;</span><span class="m">5</span>
<span class="k">replace</span> gender=gender<span class="m">+1</span>
<span class="k">replace</span> bmi=.<span class="k"> if</span> <span class="o">!</span><span class="nf">inrange</span>(bmi,<span class="m">17</span>,<span class="m">50</span>)
</pre></div>
</div>
</section>
<section id="rename">
<h3>3.3.28 <code class="docutils literal notranslate"><span class="pre">rename</span></code><a class="headerlink" href="#rename" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//rename</span>
<span class="k">rename</span> age age_at_transplant
<span class="k">rename</span> gender female

<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">rename</span> (age gender)(age_at_transplant female)
</pre></div>
</div>
</section>
<section id="sort-gsort">
<h3>3.3.29 <code class="docutils literal notranslate"><span class="pre">sort</span></code>, <code class="docutils literal notranslate"><span class="pre">gsort</span></code><a class="headerlink" href="#sort-gsort" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//sort, gsort</span>
<span class="k">list in</span> <span class="m">1</span><span class="o">/</span><span class="m">10</span> 
<span class="k">sort</span> age
<span class="k">list in</span> <span class="m">1</span><span class="o">/</span><span class="m">10</span>
<span class="k">sort</span> age dx
<span class="k">list in</span> <span class="m">1</span><span class="o">/</span><span class="m">10</span>
<span class="k">gsort</span> <span class="o">-</span>age dx <span class="o">-</span>race 
<span class="k">list in</span> <span class="m">1</span><span class="o">/</span><span class="m">10</span>
</pre></div>
</div>
</section>
<section id="recode">
<h3>3.3.30 <code class="docutils literal notranslate"><span class="pre">recode</span></code><a class="headerlink" href="#recode" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//recode</span>
<span class="k">recode</span> rec_education (<span class="m">3</span> <span class="m">4</span> <span class="m">5</span> =<span class="m">9</span>)
<span class="k">recode</span> dx (<span class="m">1</span>=<span class="m">1</span>)(<span class="m">2</span>=<span class="m">2</span>)(<span class="o">*</span>=<span class="m">9</span>)
<span class="k">recode</span> gender (<span class="m">0</span>=<span class="m">1</span>)(<span class="m">1</span>=<span class="m">0</span>),gen(male)

<span class="c1">// recode + label, simultaneously!</span>

<span class="k">recode</span> race <span class="cs">///</span>
    (<span class="m">1</span>=<span class="m">0</span> <span class="s">&quot;Cauc&quot;</span>) <span class="cs">///</span>
    (<span class="m">2</span>=<span class="m">1</span> <span class="s">&quot;AA) ///</span>
    (<span class="m">4</span>=<span class="m">2</span> <span class="s">&quot;Hisp/Latino&quot;</span>) <span class="cs">///</span>
    (<span class="m">5</span><span class="o">/</span><span class="m">9</span>=<span class="m">3</span> <span class="s">&quot;Other&quot;</span>), <span class="cs">///</span>
<span class="k">        gen</span>(race_cat)
</pre></div>
</div>
</section>
<section id="display">
<h3>3.3.31 <code class="docutils literal notranslate"><span class="pre">display</span></code><a class="headerlink" href="#display" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//display</span>
<span class="k">sum</span> wait_yrs
<span class="k">di</span> <span class="s">&quot;variable&quot;</span> _col(<span class="m">20</span>) <span class="s">&quot;mean&quot;</span>
<span class="k">di</span> <span class="s">&quot;wait time&quot;</span> _col(<span class="m">20</span>) <span class="nf">r</span>(mean)
</pre></div>
</div>
</section>
<section id="capture">
<h3>3.3.32 <code class="docutils literal notranslate"><span class="pre">capture</span></code><a class="headerlink" href="#capture" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">capture sum</span> nonexistent_variable
<span class="k">capture di</span> <span class="m">4+3</span>
<span class="k">capture di</span> <span class="m">4</span><span class="o">+</span>
</pre></div>
</div>
</section>
<section id="assert">
<h3>3.3.33 <code class="docutils literal notranslate"><span class="pre">assert</span></code><a class="headerlink" href="#assert" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//assert </span>
<span class="k">assert</span> age<span class="o">&lt;</span><span class="m">100</span>
<span class="k">assert</span> end_date<span class="o">&gt;=</span>transplant_date
<span class="k">assert</span> <span class="nf">inlist</span>(gender,<span class="m">0</span>,<span class="m">1</span>)
<span class="k">assert</span> <span class="m">2</span><span class="o">&lt;</span><span class="m">1</span>
<span class="k">assert</span> <span class="m">0</span>
<span class="k">assert</span> <span class="nf">c</span>(edition_real)<span class="o">==</span><span class="s">&quot;BE&quot;</span>
<span class="k">assert</span> <span class="nf">c</span>(edition_real)<span class="o">==</span><span class="s">&quot;MP&quot;</span>
</pre></div>
</div>
</section>
<section id="scalars-macros-matrices">
<h3>3.3.34 Scalars, macros, matrices<a class="headerlink" href="#scalars-macros-matrices" title="Permalink to this heading">#</a></h3>
<p>Saved results can be either of the following:</p>
<ul class="simple">
<li><p>Scalars (numbers)</p></li>
<li><p>Macros (numbers, string, or both)</p></li>
<li><p>Matrices (lists or tables of numbers)</p></li>
</ul>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">sum</span> bmi, detail
<span class="k">disp</span> <span class="s">&quot;median: &quot;</span> _col(<span class="m">12</span>) <span class="nf">r</span>(p50)
<span class="k">disp</span> <span class="s">&quot;IQR: &quot;</span> _col(<span class="m">12</span>) <span class="nf">r</span>(p25) <span class="s">&quot;-&quot;</span> <span class="nf">r</span>(p75)<span class="k"> disp</span> <span class="s">&quot;kurtosis: &quot;</span> _col(<span class="m">12</span>) <span class="nf">r</span>(kurtosis)
</pre></div>
</div>
</section>
<section id="return-list">
<h3>3.3.35 <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">list</span></code><a class="headerlink" href="#return-list" title="Permalink to this heading">#</a></h3>
<p>A command that saves results in <code class="docutils literal notranslate"><span class="pre">r()</span></code> is said to be an “r-class command”</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">summarize</span>
<span class="k">tabulate</span>
<span class="k">describe</span>
<span class="k">codebook</span>
<span class="k">count</span>
<span class="k">duplicates</span>
<span class="k">compare</span>
<span class="k">correlate</span>
<span class="k">lincom</span>
<span class="k">test</span>
<span class="k">roctab</span>
<span class="k">sample</span> 
<span class="k">centile</span>
<span class="c1">//etc</span>
</pre></div>
</div>
<p>Type <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">list</span></code> after running one of these commands and see what you get</p>
<section id="examples-from-the-r-class">
<h4>Examples from the R-class<a class="headerlink" href="#examples-from-the-r-class" title="Permalink to this heading">#</a></h4>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">count if</span> age <span class="o">&lt;</span> <span class="m">45</span>
<span class="k">disp</span> <span class="nf">r</span>(N) <span class="s">&quot; young patients&quot;</span>
<span class="k">tab</span> race abo, chi2
<span class="k">disp</span> <span class="s">&quot;p-value: &quot;</span> <span class="nf">r</span>(p)

<span class="c1">//</span>
<span class="k">sum</span> age
<span class="k">assert</span> <span class="nf">inrange</span>(<span class="nf">r</span>(mean), <span class="m">45</span>, <span class="m">55</span>)
<span class="k">tab</span> race abo, chi2
<span class="k">assert</span> <span class="nf">r</span>(p) <span class="o">&lt;</span> <span class="m">0.05</span>

<span class="c1">//</span>
<span class="k">sum</span> bmi
<span class="k">disp</span> <span class="s">&quot;Mean BMI: &quot;</span> <span class="nf">r</span>(mean)

<span class="c1">//</span>
<span class="k">sum</span> bmi
<span class="k">disp</span> <span class="s">&quot;Mean BMI: &quot;</span> <span class="nx">%4.1f</span> <span class="nf">r</span>(mean)

<span class="c1">//</span>
<span class="k">sum</span> bmi
<span class="k">disp</span> <span class="s">&quot;Mean BMI: &quot;</span> <span class="nx">%4.0f</span> <span class="nf">r</span>(mean)
</pre></div>
</div>
<p>There are dozens of different %format codes. For now, know that the format code for floating-point numbers looks like this: <code class="docutils literal notranslate"><span class="pre">%4.2f</span></code></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%</span></code> character means “formatting code”</p></li>
<li><p>total width (oftenignored)</p></li>
<li><p>decimal point</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#</span></code> of digits to right of decimal point (mustbe &lt; total width)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> character means “floatingpoint”(decimal <code class="docutils literal notranslate"><span class="pre">#</span></code>)</p></li>
</ol>
</section>
</section>
<section id="ereturn-list">
<h3>3.3.36 <code class="docutils literal notranslate"><span class="pre">ereturn</span> <span class="pre">list</span></code><a class="headerlink" href="#ereturn-list" title="Permalink to this heading">#</a></h3>
<p>Some commands (mostly regression commands) are e-class. (The “e” stands for “estimation”).</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">regress</span> bmi gender age 
<span class="k">ereturn list</span>

<span class="c1">//log likelihood </span>
<span class="k">disp e</span>(ll) <span class="o">-</span><span class="m">17256.867</span>
</pre></div>
</div>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//_b coefficient matrix</span>
<span class="k">regress</span> bmi gender age
<span class="k">disp</span> _b[gender]

<span class="k">disp</span> <span class="s">&quot;estimated BMI: &quot;</span> <span class="nx">%3.2f</span> <span class="cs">/// </span>
   _b[_cons] <span class="s">&quot; + &quot;</span> <span class="nx">%3.2f</span> _b[age] <span class="cs">/// </span>
      <span class="s">&quot;*age (+ &quot;</span> _b[gender] <span class="cs">///</span>
   <span class="s">&quot; if male)&quot;</span>
</pre></div>
</div>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//_se coefficient matrix</span>
<span class="k">disp</span> _se[gender]
<span class="k">disp</span> _se[age]
</pre></div>
</div>
</section>
<section id="creturn-list">
<h3>3.3.37 <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code><a class="headerlink" href="#creturn-list" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">creturn list</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code> command in Stata is a powerful tool that provides a snapshot of current system properties and settings, which can be essential for managing data analyses in Stata. When discussing this command in your Jupyter book, you might want to include several key points:</p>
<ol class="arabic simple">
<li><p><strong>Explanation and Usage</strong>: Begin by explaining what the <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code> command does. It displays a list of characteristics related to the current Stata session, such as the amount of memory in use, the number of variables and observations in the dataset, and the version of Stata being used. This command is particularly useful for troubleshooting and optimizing performance.</p></li>
<li><p><strong>Interpreting Output</strong>: Detail the types of outputs provided by <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code> and what each one means. For example, <code class="docutils literal notranslate"><span class="pre">c(return_memory_total)</span></code> shows the total memory Stata has allocated for the session, and <code class="docutils literal notranslate"><span class="pre">c(N)</span></code> shows the number of observations in the current dataset.</p></li>
<li><p><strong>Practical Examples</strong>: Include practical examples showing how <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code> can be used in real-world scenarios. For instance, you can demonstrate how to use this command to monitor memory usage over time, or how it can help determine whether Stata’s settings need adjustment for handling large datasets.</p></li>
<li><p><strong>Comparison with Other Commands</strong>: Contrast <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code> with similar commands like <code class="docutils literal notranslate"><span class="pre">ereturn</span> <span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">sreturn</span> <span class="pre">list</span></code>, which provide information about the results of the most recent estimation command and string results, respectively. This comparison will help users understand when to use each command.</p></li>
<li><p><strong>Advanced Tips</strong>: Offer advanced tips for leveraging <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code> in programming and automation within Stata. For example, you could show how to capture these system properties programmatically and use them to make conditional decisions in do-files or ado-files.</p></li>
<li><p><strong>Updates and Version Specifics</strong>: Note any version-specific features or limitations of the <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code> command. Stata updates may introduce changes to how system properties are handled, so highlighting these nuances can be very beneficial for users who work across different versions.</p></li>
<li><p><strong>Visual Aids</strong>: Since you are working on a Jupyter book, make use of the interactive features available. Include code snippets directly in the text and possibly interactive widgets that allow readers to execute Stata commands and see the results in real-time.</p></li>
</ol>
<p>By emphasizing these points, your section on the <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code> command will not only be informative but also practical, helping readers to effectively harness this tool in their data analysis tasks.</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">disp</span> <span class="nf">c</span>(edition)
<span class="k">disp</span> <span class="nf">c</span>(current_date)
<span class="k">disp</span> <span class="nf">c</span>(os)
<span class="k">disp</span> <span class="nf">c</span>(pi)
</pre></div>
</div>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nf">c</span>(version) <span class="o">&gt;=</span> <span class="m">17</span> {
<span class="k">    disp</span> <span class="s">&quot;You are running Stata 17&quot;</span>
}
<span class="k">else</span> {
<span class="k">    disp</span> <span class="s">&quot;You are running an earlier version of Stata&quot;</span>
}

<span class="c1">//transparent graph colors</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>

<span class="k">if</span> <span class="nf">c</span>(version) <span class="o">&gt;=</span> <span class="m">15</span> {
<span class="k">    tw scatter</span> rec_wgt_kg rec_hgt_cm<span class="k"> if</span> age<span class="o">&gt;</span><span class="m">18</span>, mcolor(%<span class="m">20</span>)
<span class="k">    tw scatter</span> rec_wgt_kg rec_hgt_cm<span class="k"> if</span> age<span class="o">&gt;</span><span class="m">18</span>, mcolor(red%<span class="m">20</span>)
}


<span class="c1">//FRAMES (version 16)</span>
<span class="k">if</span> <span class="nf">c</span>(version) <span class="o">&gt;=</span> <span class="m">16</span> {
<span class="k">    do</span> lecture8_frames_2021
}


<span class="k">if</span> <span class="nf">c</span>(version) <span class="o">&gt;=</span> <span class="m">15</span> {
<span class="k">    do</span> lecture8_putdocx_2021
}
</pre></div>
</div>
<p>Also, remember that <code class="docutils literal notranslate"><span class="pre">c(N)</span></code>, <code class="docutils literal notranslate"><span class="pre">e(N)</span></code>, and <code class="docutils literal notranslate"><span class="pre">r(N)</span></code> may be identical or diverge depending on patterns of missingness in your dataset</p>
</section>
<section id="indentation">
<h3>3.3.38 Indentation<a class="headerlink" href="#indentation" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">qui</span> {
cls
<span class="k">capture program drop</span> myprogram 
<span class="k">program</span> define myprogram
<span class="k">forvalues</span> i = <span class="m">1</span><span class="o">/</span><span class="m">10</span> {
<span class="k">if</span> <span class="nv">`i&#39;</span> <span class="o">&lt;</span> <span class="m">5</span> {
<span class="k">display</span> <span class="s">&quot;</span><span class="nv">`i&#39;</span><span class="s"> is less than five&quot;</span>
}
<span class="k">else</span> {
<span class="k">display</span> <span class="s">&quot;</span><span class="nv">`i&#39;</span><span class="s"> is at least five&quot;</span>
}
}
<span class="k">end</span>
}
</pre></div>
</div>
<section id="notes-on-indentation">
<h4>Notes on Indentation<a class="headerlink" href="#notes-on-indentation" title="Permalink to this heading">#</a></h4>
<p>Indentation is crucial in programming for several reasons:</p>
<ul class="simple">
<li><p><strong>Readability:</strong> Proper indentation makes it easier for someone (including future you) to read and understand the code. It visually separates code blocks that belong to different logical structures like loops, if-else conditions, etc.</p></li>
<li><p><strong>Debugging:</strong> Indented code helps quickly identify structural errors such as missing loops or misaligned end statements.</p></li>
<li><p><strong>Maintainability:</strong> Well-indented code is easier to modify or expand because the structure of the program is clear and logical.</p></li>
</ul>
<p>In the context of Stata:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Stata</span></code> does not require indentation for functionality (the program will run the same way whether it’s indented or not), but it’s considered best practice to use indentation to improve clarity. In contrast, <code class="docutils literal notranslate"><span class="pre">Python</span></code>, the most widely used language, will not run if you don’t indent your code.</p></li>
</ul>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">qui</span> {  <span class="c1">// Begin a block of commands to be executed quietly</span>
    cls  <span class="c1">// Clear the Stata results window</span>

<span class="k">    capture program drop</span> myprogram  <span class="c1">// Safely remove any existing program named &#39;myprogram&#39;</span>
<span class="k">    </span>
<span class="k">    program</span> define myprogram  <span class="c1">// Begin defining a new program called &#39;myprogram&#39;</span>
<span class="k">        forvalues</span> i = <span class="m">1</span><span class="o">/</span><span class="m">10</span> {  <span class="c1">// Start a loop from 1 to 10, storing each value in &#39;i&#39;</span>
<span class="k">            if</span> <span class="nv">`i&#39;</span> <span class="o">&lt;</span> <span class="m">5</span> {  <span class="c1">// Check if the current value of &#39;i&#39; is less than 5</span>
<span class="k">                display</span> <span class="s">&quot;</span><span class="nv">`i&#39;</span><span class="s"> is less than five&quot;</span>  <span class="c1">// Display this message if the condition is true</span>
            }
<span class="k">            else</span> {  <span class="c1">// If the condition is not true (i.e., `i` is 5 or more)</span>
<span class="k">                display</span> <span class="s">&quot;</span><span class="nv">`i&#39;</span><span class="s"> is at least five&quot;</span>  <span class="c1">// Display this message</span>
            }
        }  <span class="c1">// End of the loop</span>
<span class="k">    end</span>  <span class="c1">// End the program definition</span>
}  <span class="c1">// End of the quiet block</span>
</pre></div>
</div>
</section>
<section id="general-annotation-tips">
<h4>General Annotation Tips<a class="headerlink" href="#general-annotation-tips" title="Permalink to this heading">#</a></h4>
<p>When annotating code:</p>
<ul class="simple">
<li><p><strong>Comment Generously:</strong> Explain what each major block of code is intended to do, especially if the logic might not be immediately clear.</p></li>
<li><p><strong>Use Clear, Descriptive Names:</strong> While this script uses ‘i’ for a loop variable, which is quite common, always ensure that variable names elsewhere are descriptive.</p></li>
<li><p><strong>Explain the Purpose:</strong> Especially explain why certain commands are used (like <code class="docutils literal notranslate"><span class="pre">capture</span></code> which is used here to avoid errors if the program does not exist when trying to drop it).</p></li>
<li><p><strong>GPT-4 for indentation, annotation, debugging:</strong> You may copy and paste your code snippet into a generative AI interface and ask it to annotate your code. The above code block was both indented and annotated by <code class="docutils literal notranslate"><span class="pre">GPT-4</span></code>. <code class="docutils literal notranslate"><span class="pre">GitHub</span> <span class="pre">co-pilot</span></code> is also specifically develop to help with coding, but its a $15/month service and you may have to code in a GitHub compatible environment such as <code class="docutils literal notranslate"><span class="pre">Visual</span> <span class="pre">Studio</span> <span class="pre">Code</span></code>. Explore free GPTs including <code class="docutils literal notranslate"><span class="pre">GPT-3.5</span></code>, <code class="docutils literal notranslate"><span class="pre">Gemini</span></code>, and <code class="docutils literal notranslate"><span class="pre">Claude</span></code>.</p></li>
</ul>
</section>
</section>
<section id="regress">
<h3>3.3.39 <code class="docutils literal notranslate"><span class="pre">regress</span></code><a class="headerlink" href="#regress" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//an easier way to do 95% CIs (version 15 and up)</span>
<span class="k">version</span> <span class="m">15</span>
<span class="k">regress</span> bmi gender age
<span class="k">lincom</span> age
<span class="k">return list</span>
<span class="k">disp</span> <span class="s">&quot;Beta: &quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(estimate)
<span class="k">disp</span> <span class="s">&quot;CI: &quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(lb) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(ub)
<span class="k">lincom</span> _cons
<span class="k">disp</span> <span class="s">&quot;Beta: &quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(estimate)
<span class="k">disp</span> <span class="s">&quot;CI: &quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(lb) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(ub)

<span class="k">logit</span> don_ecd i<span class="m">.</span>don_cod
<span class="k">lincom</span> <span class="m">2.</span>don_cod
<span class="k">return list</span>
<span class="k">disp</span> <span class="s">&quot;OR: &quot;</span> <span class="nx">%3.2f</span> <span class="nf">exp</span>(<span class="nf">r</span>(estimate))
<span class="k">disp</span> <span class="s">&quot;CI: &quot;</span> <span class="nx">%3.2f</span> <span class="nf">exp</span>(<span class="nf">r</span>(lb)) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">exp</span>(<span class="nf">r</span>(ub))
<span class="k">lincom</span> <span class="m">2.</span>don_cod, eform
<span class="k">disp</span> <span class="s">&quot;OR: &quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(estimate)
<span class="k">disp</span> <span class="s">&quot;CI: &quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(lb) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(ub)

<span class="k">disp</span> <span class="s">&quot;r(p): &quot;</span> <span class="nf">r</span>(p)
</pre></div>
</div>
</section>
<section id="local">
<h3>3.3.40 <code class="docutils literal notranslate"><span class="pre">local</span></code><a class="headerlink" href="#local" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//local macros</span>
<span class="c1">//there&#39;s also such a thing as a *global* macro </span>
<span class="c1">//but let&#39;s worry about those later</span>
<span class="k">local</span> a = <span class="m">4</span>  <span class="c1">//set macro a equal to 4</span>
<span class="k">disp</span> <span class="nv">`a&#39;</span>   <span class="c1">//display the value of macro a</span>

<span class="k">local</span> a <span class="m">4</span> <span class="c1">//another way to set the value of a macro</span>
<span class="k">disp</span> <span class="nv">`a&#39;</span>

<span class="k">local</span> a <span class="m">4</span> <span class="o">+</span> <span class="m">7</span>  <span class="c1">//this means, set a equal to &quot;4 + 7&quot;. </span>
<span class="c1">//At this point, Stata doesn&#39;t actually compute what 4+7 is</span>

<span class="k">disp</span> <span class="nv">`a&#39;</span><span class="o">*</span><span class="m">2</span>  <span class="c1">//becomes &quot;disp 4 + 7*2&quot; which is the same as 4+14 which is 18</span>

<span class="k">local</span> a = <span class="m">4</span> <span class="o">+</span> <span class="m">7</span> <span class="c1">//the equals means, *COMPUTE* 4+7 and set a equal to the answer</span>
<span class="k">disp</span> <span class="nv">`a&#39;</span><span class="o">*</span><span class="m">2</span>  <span class="c1">//becomes &quot;disp 11*2&quot; which is 22</span>


<span class="c1">//another macro example</span>
<span class="c1">//we want to display the mean age for males, and the mean age for females,</span>
<span class="c1">//on the same line</span>
<span class="k">quietly sum</span> age<span class="k"> if</span> gender<span class="o">==</span><span class="m">0</span>
<span class="k">local</span> age_m = <span class="nf">r</span>(mean)  <span class="c1">//store mean age for males in macro &quot;age_m&quot;</span>
<span class="k">quietly sum</span> age<span class="k"> if</span> gender<span class="o">==</span><span class="m">1</span>
<span class="k">local</span> age_f = <span class="nf">r</span>(mean)  <span class="c1">//store mean age for females in macro &quot;age_f&quot;</span>
<span class="k">disp</span> <span class="s">&quot;Mean age: &quot;</span> <span class="nx">%3.1f</span> <span class="nv">`age_m&#39;</span> <span class="s">&quot; (males) &quot;</span> <span class="nx">%3.1f</span> <span class="nv">`age_f&#39;</span> <span class="s">&quot; (females)&quot;</span>
<span class="c1">//Note the use of formatting code %3.1f. </span>
<span class="c1">//one digit to the right of the decimal point will be shown.</span>

<span class="c1">//More macro examples</span>
<span class="k">local</span> my_var age  <span class="c1">//my_var is a macro which equals &quot;age&quot;</span>
<span class="k">disp</span> <span class="s">&quot;Here&#39;s a summary of </span><span class="nv">`my_var&#39;</span><span class="s">&quot;</span>  <span class="c1">//displays &quot;Here&#39;s a summary of age&quot;</span>
<span class="k">sum</span> <span class="nv">`my_var&#39;</span> <span class="c1">//sumarizes age</span>

<span class="k">local</span> my_option detail
<span class="k">summarize</span> <span class="nv">`my_var&#39;</span>, <span class="nv">`my_option&#39;</span>
<span class="c1">//Stata sees &quot;summarize age, detail&quot;</span>

<span class="k">local</span> my_command<span class="k"> summarize</span>  <span class="c1">//my_command is a macro which equals &quot;summarize&quot;</span>
<span class="c1">//Stata sees &quot;summarize age, detail&quot;</span>
<span class="nv">`my_command&#39;</span> <span class="nv">`my_var&#39;</span>, <span class="nv">`my_option&#39;</span>

<span class="c1">//here are some additional macros not in the slides.</span>
<span class="c1">//they are a bit more complex but they show how this macro thing works</span>
<span class="k">local</span> mymacro<span class="k"> gen</span>
<span class="k">sum</span> <span class="nv">`mymacro&#39;</span>der  <span class="c1">//Stata sees &quot;sum gender&quot;</span>

<span class="k">local</span> macro1<span class="k"> ma</span>  <span class="c1">//macro1 is &quot;ma&quot;</span>
<span class="k">local</span> macro2 age gender <span class="c1">//macro2 is &quot;age gender&quot;</span>
<span class="k">sum</span> <span class="nv">``macro1&#39;cro2&#39;</span> 
<span class="c1">//first, `macro1&#39; becomes &quot;ma&quot;</span>
<span class="c1">//so ``macro1&#39;cro2&#39; becomes `macro2&#39;</span>
<span class="c1">//next, `macro2&#39; becomes &quot;age gender&quot;</span>
<span class="c1">//so &quot;sum `macro2&#39;&quot; becomes &quot;sum age gender&quot;</span>

<span class="c1">//In this case, in_study defines a subpopulation of age&lt;45 and gender==male</span>
<span class="c1">//and then we run several commands using this macro</span>
<span class="c1">//if we later decide to include females instead, </span>
<span class="c1">//all we have to do is change &quot;gender==0&quot; to &quot;gender==1&quot;</span>
<span class="c1">//and everything will run on females instead of males</span>
<span class="k">local</span> in_study<span class="k"> if</span> age<span class="o">&lt;</span><span class="m">45</span> <span class="o">&amp;</span> gender<span class="o">==</span><span class="m">0</span>
<span class="k">sum</span> bmi <span class="nv">`in_study&#39;</span>
<span class="k">sum</span> peak_pra <span class="nv">`in_study&#39;</span>
<span class="k">regress</span> bmi age <span class="nv">`in_study&#39;</span>

<span class="c1">//here, &quot;confounders&quot; refers to a set of three variables</span>
<span class="c1">//you can imagine that we would do several different analyses </span>
<span class="c1">//treating these variables the same.</span>
<span class="c1">//if we change the list of confounders, we just have to change the macro</span>
<span class="c1">//instead of changing every command</span>
<span class="k">local</span> confounders age gender peak_pra
<span class="k">regress</span> bmi wait_yrs <span class="nv">`confounders&#39;</span>
</pre></div>
</div>
</section>
<section id="quietly">
<h3>3.3.41 <code class="docutils literal notranslate"><span class="pre">quietly</span></code><a class="headerlink" href="#quietly" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//review: quietly</span>
<span class="c1">//run a regression. Don&#39;t print any output or error messages</span>
<span class="k">quietly regress</span> bmi age

<span class="c1">//a &quot;quietly block&quot;: run several commands without printing anything</span>
<span class="k">quietly</span> {
<span class="k">    gen</span> over40 = (age <span class="o">&gt;</span> <span class="m">40</span>)
<span class="k">    count if</span> over40 <span class="o">==</span> <span class="m">1</span>
<span class="k">    regress</span> bmi over40
}

<span class="k">drop</span> over40
<span class="c1">//now, let&#39;s run several commands and only print output from the last one</span>
<span class="k">quietly</span> {
<span class="k">    gen</span> over40 = (age <span class="o">&gt;</span> <span class="m">40</span>)
<span class="k">    sum</span> bmi<span class="k"> if</span> over40 <span class="o">==</span> <span class="m">1</span>
<span class="k">    noisily di</span> <span class="s">&quot;mean BMI: &quot;</span> <span class="nx">%3.1f</span> <span class="nf">r</span>(mean)
}
</pre></div>
</div>
</section>
<section id="which">
<h3>3.3.42 <code class="docutils literal notranslate"><span class="pre">which</span></code><a class="headerlink" href="#which" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//which command. Show whether a command is built-in, or a stata .do file</span>
<span class="k">which tab</span>
<span class="k">which chelp</span>
<span class="k">which gen</span>
<span class="k">which regress</span>
<span class="k">which help</span>
<span class="k">which graph</span>
</pre></div>
</div>
</section>
<section id="program-define">
<h3>3.3.43 <code class="docutils literal notranslate"><span class="pre">program</span> <span class="pre">define</span></code><a class="headerlink" href="#program-define" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//define a program &quot;do_something&quot;</span>
<span class="c1">//first, if the program already exists in memory, delete it</span>
<span class="c1">//(NOTE: this is superfluous here, since line 9 says &quot;clear all&quot; which deletes</span>
<span class="c1">//all programs in memory... but it&#39;s a good idea to do &quot;capture program drop&quot;</span>
<span class="c1">//before any &quot;program define&quot;</span>
<span class="k">capture program drop</span> do_something

<span class="c1">//now, define the program. All it does is display &quot;It doesn&#39;t do much.&quot;</span>
<span class="k">program</span> define do_something  <span class="c1">//create a program called do_something</span>
<span class="k">    disp</span> <span class="s">&quot;It doesn&#39;t do much.&quot;</span>  <span class="c1">//here&#39;s what the program does.</span>
<span class="k">end</span>  <span class="c1">//that&#39;s the end of the program definition</span>

do_something

<span class="k">capture program drop</span> do_something_else
<span class="k">program</span> define do_something_else  <span class="c1">//create a program called do_something</span>
<span class="k">    disp</span> <span class="s">&quot;One line is not enough.&quot;</span>
<span class="k">    disp</span> <span class="s">&quot;So display two lines.&quot;</span>
<span class="k">end</span>  <span class="c1">//that&#39;s the end of the program definition</span>

do_something_else

<span class="c1">//now for a program that actually does something useful.</span>
<span class="c1">//NOTE: this would be more efficient with loops, but those come later</span>

<span class="k">capture program drop</span> table1
<span class="k">program</span> define table1
<span class="k">    disp</span> <span class="s">&quot;Variable&quot;</span> _col(<span class="m">20</span>) <span class="s">&quot;mean (SD)&quot;</span> _col(<span class="m">40</span>) <span class="s">&quot;range&quot;</span>
<span class="k">    quietly sum</span> age
<span class="k">    disp</span> <span class="s">&quot;age &quot;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean) <span class="s">&quot; (&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> <span class="cs">///</span>
            _col(<span class="m">40</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(max)
<span class="k">    quietly sum</span> wait_yrs
<span class="k">    disp</span> <span class="s">&quot;wait_yrs&quot;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean) <span class="s">&quot; (&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> <span class="cs">///</span>
            _col(<span class="m">40</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(max)
<span class="k">    quietly sum</span> bmi
<span class="k">    disp</span> <span class="s">&quot;bmi&quot;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean) <span class="s">&quot; (&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> <span class="cs">///</span>
            _col(<span class="m">40</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(max)
<span class="k">end</span>

<span class="k">use</span> transplants,<span class="k"> clear</span>
table1

<span class="c1">//table1 program from lecture 2</span>
<span class="k">capture program drop</span> table1
<span class="k">program</span> define table1
<span class="k">    disp</span> <span class="s">&quot;Variable&quot;</span> _col(<span class="m">20</span>) <span class="s">&quot;mean (SD)&quot;</span> _col(<span class="m">40</span>) <span class="s">&quot;range&quot;</span>
<span class="k">    quietly sum</span> age
<span class="k">    disp</span> <span class="s">&quot;age&quot;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean) <span class="s">&quot; (&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> <span class="cs">///</span>
            _col(<span class="m">40</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(max)
<span class="k">    quietly sum</span> wait_yrs
<span class="k">    disp</span> <span class="s">&quot;wait_yrs&quot;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean) <span class="s">&quot; (&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> <span class="cs">///</span>
            _col(<span class="m">40</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(max)
<span class="k">    quietly sum</span> bmi
<span class="k">    disp</span> <span class="s">&quot;bmi&quot;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean) <span class="s">&quot; (&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> <span class="cs">///</span>
            _col(<span class="m">40</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(max)
<span class="k">end</span>

table1
table1 age peak_pra

<span class="c1">//add &quot;syntax varlist&quot; to control the list of variables</span>
<span class="k">capture program drop</span> table1_v
<span class="k">program</span> define table1_v
<span class="k">    syntax varlist</span>
    <span class="c1">//write out a nicely formatted table </span>
    <span class="c1">//NOTE: could also write out with commas instead of spacing</span>
    <span class="c1">//which would make it easier to import into Excel</span>
<span class="k">    disp</span> <span class="s">&quot;Variable&quot;</span> _col(<span class="m">15</span>) <span class="s">&quot;mean(SD)&quot;</span> _col(<span class="m">30</span>) <span class="s">&quot;range&quot;</span>
<span class="k">    foreach</span> v of<span class="k"> varlist</span> <span class="nv">`varlist&#39;</span> {
<span class="k">        quietly sum</span> <span class="nv">`v&#39;</span>
<span class="k">        disp</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> _col(<span class="m">15</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean) <span class="s">&quot;(&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> _col(<span class="m">30</span>) <span class="cs">///</span>
            <span class="nx">%3.2f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(max)
    }
<span class="k">end</span>

table1_v age wait_yrs rec_wgt_kg 

<span class="c1">//demonstrate behavior of local macros inside programs</span>
<span class="k">program</span> define varprogram
<span class="k">    syntax varlist</span>  
<span class="k">    disp</span> <span class="s">&quot;</span><span class="nv">`varlist&#39;</span><span class="s">&quot;</span>  <span class="c1">//displays the varlist macro</span>
<span class="k">end</span>

<span class="c1">//syntax varname: exactly one variable</span>
<span class="k">program</span> define varfavorite
<span class="k">    syntax</span> varname  
<span class="k">    disp</span> <span class="s">&quot;My favorite variable is </span><span class="nv">`varlist&#39;</span><span class="s">&quot;</span>  <span class="c1">//displays the varlist macro</span>
<span class="k">end</span>

varfavorite fake_id

varprogram fake_id
<span class="k">disp</span> <span class="s">&quot;</span><span class="nv">`varlist&#39;</span><span class="s">&quot;</span>  <span class="c1">//displays nothing. Stata has forgotten the varlist macro</span>

<span class="k">program</span> define macroprog
<span class="k">    local</span> a=<span class="m">4</span>   <span class="c1">//define local macro a</span>
<span class="k">    disp</span> <span class="s">&quot;</span><span class="nv">`a&#39;</span><span class="s">        </span><span class="nv">`b&#39;</span><span class="s">&quot;</span>  <span class="c1">//Stata knows macro a, but macro b is empty</span>
<span class="k">end</span>
<span class="k">local</span> b=<span class="m">3</span>   <span class="c1">//define local macro b</span>
macroprog
<span class="k">disp</span> <span class="s">&quot;</span><span class="nv">`a&#39;</span><span class="s">        </span><span class="nv">`b&#39;</span><span class="s">&quot;</span>  <span class="c1">//Stata knows macro b, but macro a is empty</span>


<span class="k">program</span> define varprogram2
<span class="k">    syntax</span> [varlist]   <span class="c1">//now, &quot;varlist&quot; is optional</span>
<span class="k">    disp</span> <span class="s">&quot;</span><span class="nv">`varlist&#39;</span><span class="s">&quot;</span>
<span class="k">end</span>


varprogram2 fake_id
varprogram2 

<span class="k">program</span> define myif
<span class="k">    syntax</span> [if]  <span class="c1">//accepts an optional &quot;if&quot; statement</span>
<span class="k">    if</span> <span class="s">&quot;</span><span class="nv">`if&#39;</span><span class="s">&quot;</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> {  <span class="c1">//if there&#39;s something in the &quot;if&quot; statement...</span>
<span class="k">        disp</span> <span class="s">&quot;</span><span class="nv">`if&#39;</span><span class="s">&quot;</span>    <span class="c1">//display it</span>
    }
<span class="k">    else</span> {
<span class="k">        disp</span> <span class="s">&quot;No if statement&quot;</span>  <span class="c1">//otherwise, display this message</span>
    }
<span class="k">end</span>



myif  <span class="c1">//displays &quot;no if statement&quot;</span>
myif<span class="k"> if</span> age <span class="o">&gt;</span> <span class="m">35</span>  <span class="c1">//displays &quot;if age &gt; 35&quot;</span>

<span class="k">capture program drop</span> countif
<span class="k">program</span> define countif 
<span class="k">    syntax if</span>
<span class="k">    quietly count</span> <span class="nv">`if&#39;</span>
<span class="k">    disp</span> <span class="s">&quot;total count is &quot;</span> <span class="nf">r</span>(N)
<span class="k">end</span>




<span class="k">capture program drop</span> table1_if
<span class="k">program</span> define table1_if
<span class="k">    syntax varlist</span> [if]
    <span class="c1">//write out a nicely formatted table</span>
<span class="k">    disp</span> <span class="s">&quot;Variable&quot;</span> _col(<span class="m">12</span>) <span class="s">&quot;mean(SD)&quot;</span> _col(<span class="m">25</span>) <span class="s">&quot;range&quot;</span>
<span class="k">    foreach</span> v of<span class="k"> varlist</span> <span class="nv">`varlist&#39;</span> {
<span class="k">        quietly sum</span> <span class="nv">`v&#39;</span> <span class="nv">`if&#39;</span> 
<span class="k">        disp</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> _col(<span class="m">12</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean) <span class="s">&quot;(&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> _col(<span class="m">25</span>) <span class="cs">///</span>
            <span class="nx">%3.2f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(max)
    }
<span class="k">end</span>

table1_if age peak_pra wait_yrs
table1_if age peak_pra wait_yrs<span class="k"> if</span> race<span class="o">==</span><span class="m">1</span> <span class="c1">//summarize for only race==1</span>

<span class="c1">//tempvar</span>

<span class="c1">//non-working program - as an example</span>
<span class="k">capture program drop</span> tabyear0
<span class="k">program</span> define tabyear0
<span class="k">    syntax</span> varname
<span class="k">    gen</span> year = <span class="nf">year</span>(<span class="nv">`varlist&#39;</span>)
<span class="k">    tab</span> year
<span class="k">end</span>

<span class="c1">//here&#39;s how you *should* do it (using a temporary variable)</span>
<span class="k">capture program drop</span> tabyear
<span class="k">program</span> define tabyear
<span class="k">    syntax</span> varname
<span class="k">    tempvar</span> year  <span class="c1">//create a temporary variable called year</span>
    <span class="c1">//use backquote-apostrophe to refer to the temporary variable (like a macro)</span>
    <span class="c1">//NOTE: even if, by some chance, there&#39;s already a variable called &quot;year&quot;,</span>
    <span class="c1">//this code will still work</span>
<span class="k">    gen</span> <span class="nv">`year&#39;</span> = <span class="nf">year</span>(<span class="nv">`varlist&#39;</span>)
<span class="k">    tab</span> <span class="nv">`year&#39;</span>
    <span class="c1">//the temporary variable disappears automatically when the program is done</span>
<span class="k">end</span>

tabyear transplant_date
tabyear end_date

<span class="c1">//an example of what *not* to do when you want to temporarily alter the dataset</span>
<span class="k">capture program drop</span> savesample0
<span class="k">program</span> define savesample0
    <span class="c1">//save random 10% of records</span>
<span class="k">    syntax</span> using<span class="o">/</span> , [replace]
<span class="k">    sample</span> <span class="m">10</span> <span class="c1">//delete 90% of records!</span>
<span class="k">    save</span> <span class="nv">`using&#39;</span>, <span class="nv">`replace&#39;</span>
<span class="k">end</span>

<span class="c1">//here&#39;s how you should do it</span>
<span class="k">capture program drop</span> savesample
<span class="k">program</span> define savesample
    <span class="c1">//save random 10% of records</span>
<span class="k">    syntax</span> using<span class="o">/</span> , [replace]
<span class="k">    preserve</span>   <span class="c1">//save a temporary copy of the data</span>
<span class="k">    sample</span> <span class="m">10</span> <span class="c1">//no worries</span>
<span class="k">    save</span> <span class="nv">`using&#39;</span> , <span class="nv">`replace&#39;</span>
    <span class="c1">//when the program reaches the end, the temporary copy is reloaded,</span>
    <span class="c1">//undoing any changes</span>
<span class="k">end</span>

<span class="k">count</span>
savesample using tenpct<span class="m">.</span>dta,<span class="k"> replace</span>
<span class="k">count</span>

<span class="c1">//another way to do table1_if</span>
<span class="k">capture program drop</span> table1_if2
<span class="k">program</span> define table1_if2
<span class="k">    syntax varlist</span> [if]
<span class="k">    preserve</span>
<span class="k">    capture keep</span> <span class="nv">`if&#39;</span>
    <span class="c1">//write out a nicely formatted table</span>
<span class="k">    disp</span> <span class="s">&quot;Variable&quot;</span> _col(<span class="m">12</span>) <span class="s">&quot;mean(SD)&quot;</span> _col(<span class="m">25</span>) <span class="s">&quot;range&quot;</span>
<span class="k">    foreach</span> v of<span class="k"> varlist</span> <span class="nv">`varlist&#39;</span> {
<span class="k">        quietly sum</span> <span class="nv">`v&#39;</span> <span class="nv">`if&#39;</span> 
<span class="k">        disp</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> _col(<span class="m">12</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean) <span class="s">&quot;(&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> _col(<span class="m">25</span>) <span class="cs">///</span>
            <span class="nx">%3.2f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(max)
    }
<span class="k">end</span>

table1_if2 age peak_pra wait_yrs
table1_if age peak_pra wait_yrs<span class="k"> if</span> age<span class="o">&lt;</span><span class="m">40</span> <span class="c1">//summarize for only age&lt;40</span>
</pre></div>
</div>
</section>
<section id="id1">
<h3>3.3.44 <code class="docutils literal notranslate"><span class="pre">by</span></code><a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//by</span>

<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">sort</span> abo
<span class="k">by</span> abo:<span class="k"> gen</span> cat_n = _N <span class="c1">//cat_n = # records in each abo category</span>

<span class="k">sort</span> abo age
<span class="k">by</span> abo:<span class="k"> gen</span> cat_id = _n <span class="c1">//1 for youngest patient, 2 for next youngest, etc.</span>
</pre></div>
</div>
</section>
<section id="egen">
<h3>3.3.45 <code class="docutils literal notranslate"><span class="pre">egen</span></code><a class="headerlink" href="#egen" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="o">/</span>egen

<span class="c1">//obtaining mean age and storing it in a variable</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">egen</span> mean_age =<span class="k"> mean</span>(age)

<span class="c1">//more egen examples</span>
<span class="k">egen</span> median_age =<span class="k"> median</span>(age)
<span class="k">egen</span> max_age = <span class="nf">max</span>(age)
<span class="k">egen</span> min_age = <span class="nf">min</span>(age)
<span class="k">egen</span> age_q1 =<span class="k"> pctile</span>(age), p(<span class="m">25</span>) <span class="c1">//25th percentile</span>
<span class="k">egen</span> age_sd = sd(age)  <span class="c1">//standard deviation</span>
<span class="k">egen</span> total_prev =<span class="k"> sum</span>(prev) <span class="c1">//add all the values (all are 1 or 0 in this case)</span>

<span class="c1">//using egen with by</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">sort</span> dx
<span class="k">by</span> dx:<span class="k"> egen</span> mean_age =<span class="k"> mean</span>(age)
<span class="k">by</span> dx:<span class="k"> egen</span> min_bmi = <span class="nf">min</span>(bmi)

<span class="c1">//combining sort and by to get bysort / bys</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">bys</span> abo:<span class="k"> egen</span> m_bmi=mean(bmi)
<span class="k">bys</span> abo gender:<span class="k"> egen</span> max_bmi = <span class="nf">max</span>(bmi)
<span class="k">bys</span> abo gender:<span class="k"> egen</span> min_bmi = <span class="nf">min</span>(bmi)
<span class="k">gen</span> spread = max_bmi <span class="o">-</span> min_bmi
</pre></div>
</div>
</section>
<section id="id2">
<h3>3.3.46 <code class="docutils literal notranslate"><span class="pre">tag</span></code><a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//egen = tag</span>
<span class="k">egen</span> grouptag = tag(abo gender)
<span class="c1">//now, for all gorups of abo/gender, (1/M, 3/F, etc), there&#39;s exactly one</span>
<span class="c1">//record that has grouptag = &quot;1&quot;. All others have grouptag = &quot;0&quot;.</span>

<span class="k">list</span> abo gender spread<span class="k"> if</span> grouptag


<span class="c1">//graphing example with egen and tag</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">egen</span> tag_race = tag(race)
<span class="k">bys</span> race:<span class="k"> egen</span> mean_bmi=mean(bmi)
<span class="k">bys</span> race:<span class="k"> egen</span> mean_age=mean(age)

<span class="k">label</span> define race_label <span class="m">1</span> <span class="s">&quot;White&quot;</span> <span class="cs">///</span>
    <span class="m">2</span> <span class="s">&quot;Black/AA&quot;</span> <span class="m">4</span> <span class="s">&quot;Hispanic/Latino&quot;</span> <span class="cs">///</span>
    <span class="m">5</span> <span class="s">&quot;East Asian&quot;</span> <span class="m">6</span> <span class="s">&quot;Native American&quot;</span> <span class="cs">///</span>
    <span class="m">7</span> <span class="s">&quot;Asian Indian&quot;</span> <span class="m">9</span> <span class="s">&quot;Other&quot;</span>  <span class="c1">//create a label race_label</span>

<span class="c1">//I personally find this more legible than cond() with seven cases,</span>
<span class="c1">//although cond() has its champions</span>
<span class="k">gen</span> racedesc = <span class="s">&quot;White/Caucasian&quot;</span><span class="k"> if</span> race<span class="o">==</span><span class="m">1</span>
<span class="k">replace</span> racedesc = <span class="s">&quot;Black/AA&quot;</span><span class="k"> if</span> race<span class="o">==</span><span class="m">2</span>
<span class="k">replace</span> racedesc = <span class="s">&quot;Hispanic/Latino&quot;</span><span class="k"> if</span> race<span class="o">==</span><span class="m">4</span>
<span class="k">replace</span> racedesc = <span class="s">&quot;Native American&quot;</span><span class="k"> if</span> race<span class="o">==</span><span class="m">5</span>
<span class="k">replace</span> racedesc = <span class="s">&quot;East Asian&quot;</span><span class="k"> if</span> race<span class="o">==</span><span class="m">6</span>
<span class="k">replace</span> racedesc = <span class="s">&quot;Asian Indian&quot;</span><span class="k"> if</span> race<span class="o">==</span><span class="m">7</span>
<span class="k">replace</span> racedesc = <span class="s">&quot;Other&quot;</span><span class="k"> if</span> race<span class="o">==</span><span class="m">9</span>

<span class="k">twoway scatter m</span><span class="o">~</span>_bmi<span class="k"> m</span><span class="o">~</span>_age<span class="k"> if</span> tag_race, <span class="cs">///</span>
    title(<span class="s">&quot;Mean age and BMI by race/ethnicity&quot;</span>) <span class="cs">///</span>
    xtitle(<span class="s">&quot;Mean age&quot;</span>) ytitle(<span class="s">&quot;Mean BMI&quot;</span>) <span class="cs">///</span>
    xlabel(<span class="m">40</span>(<span class="m">2</span>)<span class="m">60</span>) ylabel(<span class="m">20</span>(<span class="m">2</span>)<span class="m">30</span>) <span class="cs">///</span>
    mlabel(racedesc)
<span class="k">graph</span> export graph_lecture3<span class="m">.</span>png,<span class="k"> replace</span> width(<span class="m">2400</span>)
</pre></div>
</div>
</section>
<section id="if">
<h3>3.3.47 <code class="docutils literal notranslate"><span class="pre">if</span></code><a class="headerlink" href="#if" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//conditional if</span>
<span class="k">if</span> _N <span class="o">&gt;</span> <span class="m">100</span> {
<span class="k">    disp</span> <span class="s">&quot;Meh. That&#39;s a big dataset&quot;</span>
}
<span class="k">if</span> _N <span class="o">&gt;</span> <span class="m">10000</span> { 
<span class="k">    disp</span> <span class="s">&quot;That&#39;s a huge dataset&quot;</span>
}
<span class="k">else</span> {
<span class="k">    disp</span> <span class="s">&quot;Bah! Not so big.&quot;</span>
}



<span class="k">tab</span> dx gender, chi2
<span class="k">if</span> <span class="nf">r</span>(p) <span class="o">&lt;</span> <span class="m">0.05</span> {
<span class="k">    disp</span> <span class="s">&quot;p&lt;0.05&quot;</span>
}
<span class="k">else</span> {
<span class="k">    disp</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(p)
}

<span class="k">count if</span> <span class="o">!</span><span class="nf">inlist</span>(rec_hcv_antibody, <span class="m">0</span>, <span class="m">1</span>, .)
<span class="k">if</span> <span class="nf">r</span>(N) <span class="o">==</span> <span class="m">0</span> {
<span class="k">    logistic</span> rec_hcv_antibody age
}
<span class="k">else</span> {
<span class="k">    disp</span> <span class="s">&quot;Non-binary outcome. &quot;</span> <span class="cs">///</span>
        <span class="s">&quot;can&#39;t do logistic regression&quot;</span>
}

<span class="c1">//note the line continuation ( ///) in the previous else-statement. </span>
<span class="c1">//line continuations can be used to improve readibility of a do-file, but </span>
<span class="c1">//they should not change functionality.</span>
<span class="c1">//stata interprets &quot; ///&quot; as if the next line is on the same line</span>
</pre></div>
</div>
</section>
<section id="for">
<h3>3.3.48 <code class="docutils literal notranslate"><span class="pre">for</span></code><a class="headerlink" href="#for" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//for loops.</span>
<span class="k">forvalues</span> i = <span class="m">1</span><span class="o">/</span><span class="m">5</span> {  <span class="c1">//first time: create a macro i, set it equal to 1</span>
<span class="k">    disp</span> <span class="nv">`i&#39;</span>        <span class="c1">//display macro i</span>
}                  <span class="c1">//go back to the &quot;forvalues&quot; statement.</span>
<span class="c1">//the second time, macro i will equal 2 and it will run again.</span>
<span class="c1">//then it will go back and set i equal to 3 and run again</span>
<span class="c1">//and then run a fourth time with i equal to 4</span>
<span class="c1">//finally, it will run one last time with i equal to 5</span>
<span class="c1">//then it will stop.</span>

<span class="c1">//all the output from a &quot;forvalues&quot; loop is displayed together, because</span>
<span class="c1">//Stata doesn&#39;t actually start running code in the loop until you type the</span>
<span class="c1">//closing brace }. So if you have a bunch of &quot;disp&quot; statements and you want</span>
<span class="c1">//all the display to appear together (instead of separately, after each </span>
<span class="c1">//&quot;disp&quot; command in your code) you can put it all inside a loop that</span>
<span class="c1">//only runs once.</span>

<span class="c1">//another example of &quot;forvalues&quot;</span>
<span class="k">forvalues</span> b = <span class="m">35</span><span class="o">/</span><span class="m">45</span> {
<span class="k">    quietly count if</span> age<span class="o">&gt;=</span><span class="nv">`b&#39;</span> <span class="o">&amp;</span> age<span class="o">&lt;</span><span class="nv">`b&#39;</span><span class="o">+</span><span class="m">1</span>
<span class="k">    disp</span> <span class="s">&quot;Age of </span><span class="nv">`b&#39;</span><span class="s">: &quot;</span> <span class="nf">r</span>(N) <span class="s">&quot; patients&quot;</span>
}


<span class="k">foreach</span> v of<span class="k"> varlist</span> age wait_yrs died {
<span class="k">    if</span> <span class="nf">inlist</span>(<span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span>, <span class="s">&quot;age&quot;</span>,  <span class="s">&quot;wait_yrs&quot;</span>) {
<span class="k">        quietly sum</span> <span class="nv">`v&#39;</span>
<span class="k">        disp</span> <span class="s">&quot;Mean </span><span class="nv">`v&#39;</span><span class="s">: &quot;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean)
    }
<span class="k">    else</span> {
<span class="k">        quietly sum</span> <span class="nv">`v&#39;</span>
<span class="k">        disp</span> <span class="s">&quot;Percent </span><span class="nv">`v&#39;</span><span class="s">: &quot;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="m">100</span> <span class="o">*</span> <span class="nf">r</span>(mean) <span class="s">&quot;%&quot;</span>
    }
}

<span class="c1">//foreach works like forvalues. Except that forvalues sets the macro</span>
<span class="c1">//equal to a number which increases each time, and foreach sets the macro</span>
<span class="c1">//equal to something from a list.</span>
<span class="c1">//there are actually several varieties of foreach, but a useful one is </span>
<span class="c1">//foreach... of varlist...</span>

<span class="c1">//first time through the loop, macro v will equal &quot;age&quot;. Second time it will</span>
<span class="c1">//equal &quot;wait_yrs&quot;. Third time it will equal &quot;died&quot;.</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> age wait_yrs died { 
<span class="k">    quietly sum</span> <span class="nv">`v&#39;</span> <span class="c1">//summarize whatever variable is referred to by &quot;v&quot;</span>
<span class="k">    disp</span> <span class="s">&quot;Max </span><span class="nv">`v&#39;</span><span class="s">: &quot;</span> _col(<span class="m">10</span>) <span class="nf">r</span>(max) <span class="c1">//display maximum value</span>
}


<span class="c1">//example of foreach.. of varlist with if-statement</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> age wait_yrs died {
<span class="k">    if</span> <span class="nf">inlist</span>(<span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span>, <span class="s">&quot;age&quot;</span>,  <span class="s">&quot;wait_yrs&quot;</span>) {
<span class="k">        quietly sum</span> <span class="nv">`v&#39;</span>
<span class="k">        disp</span> <span class="s">&quot;Mean </span><span class="nv">`v&#39;</span><span class="s">: &quot;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean)
    }
<span class="k">    else</span> {
<span class="k">        quietly sum</span> <span class="nv">`v&#39;</span>
<span class="k">        disp</span> <span class="s">&quot;Percent </span><span class="nv">`v&#39;</span><span class="s">: &quot;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="m">100</span> <span class="o">*</span> <span class="nf">r</span>(mean) <span class="s">&quot;%&quot;</span>
    }
}
</pre></div>
</div>
</section>
<section id="table1">
<h3>3.3.49 <code class="docutils literal notranslate"><span class="pre">table1</span></code><a class="headerlink" href="#table1" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//table1 program from lecture 2</span>
<span class="k">capture program drop</span> table1
<span class="k">program</span> define table1
<span class="k">    disp</span> <span class="s">&quot;Variable&quot;</span> _col(<span class="m">20</span>) <span class="s">&quot;mean (SD)&quot;</span> _col(<span class="m">40</span>) <span class="s">&quot;range&quot;</span>
<span class="k">    quietly sum</span> age
<span class="k">    disp</span> <span class="s">&quot;age&quot;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean) <span class="s">&quot; (&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> <span class="cs">///</span>
            _col(<span class="m">40</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(max)
<span class="k">    quietly sum</span> wait_yrs
<span class="k">    disp</span> <span class="s">&quot;wait_yrs&quot;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean) <span class="s">&quot; (&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> <span class="cs">///</span>
            _col(<span class="m">40</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(max)
<span class="k">    quietly sum</span> bmi
<span class="k">    disp</span> <span class="s">&quot;bmi&quot;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean) <span class="s">&quot; (&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> <span class="cs">///</span>
            _col(<span class="m">40</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(max)
<span class="k">end</span>

table1
table1 age peak_pra

<span class="c1">//add &quot;syntax varlist&quot; to control the list of variables</span>
<span class="k">capture program drop</span> table1_v
<span class="k">program</span> define table1_v
<span class="k">    syntax varlist</span>
    <span class="c1">//write out a nicely formatted table </span>
    <span class="c1">//NOTE: could also write out with commas instead of spacing</span>
    <span class="c1">//which would make it easier to import into Excel</span>
<span class="k">    disp</span> <span class="s">&quot;Variable&quot;</span> _col(<span class="m">15</span>) <span class="s">&quot;mean(SD)&quot;</span> _col(<span class="m">30</span>) <span class="s">&quot;range&quot;</span>
<span class="k">    foreach</span> v of<span class="k"> varlist</span> <span class="nv">`varlist&#39;</span> {
<span class="k">        quietly sum</span> <span class="nv">`v&#39;</span>
<span class="k">        disp</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> _col(<span class="m">15</span>) <span class="nx">%3.2f</span> <span class="nf">r</span>(mean) <span class="s">&quot;(&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> _col(<span class="m">30</span>) <span class="cs">///</span>
            <span class="nx">%3.2f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(max)
    }
<span class="k">end</span>

table1_v age wait_yrs rec_wgt_kg
</pre></div>
</div>
</section>
<section id="merge">
<h3>3.3.50 <code class="docutils literal notranslate"><span class="pre">merge</span></code><a class="headerlink" href="#merge" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// Merging</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>

<span class="c1">//examples of syntax for merging</span>
<span class="c1">//NOTE: after each example we reload transplants.dta</span>

<span class="c1">//simplest merge: link data in memory (transplants.dta) to donors_recipients.dta</span>
<span class="c1">//by matching on the variable fake_id which appears in both datasets</span>
<span class="c1">//NOTE: rename your datasets after downloading </span>
<span class="c1">//e.g. donors_recipients2022.dta -&gt; donors_recipients.dta</span>
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> fake_id using donors_recipients

<span class="c1">//the merge command creates a new variable, _merge</span>
<span class="c1">//check how many records matched</span>
<span class="k">tab</span> _merge

<span class="c1">//&quot;master&quot; = dataset that was in memory before we merged</span>
<span class="c1">//&quot;using&quot; = dataset that we are bringing in with the merge command</span>
<span class="c1">//&quot;match&quot; = appears in both master and using datasets</span>

<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> fake_id using donors_recipients,<span class="k"> keep</span>(match)
<span class="c1">//only keep records that appear both in the original dataset and in the new dataset</span>


<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> fake_id using donors_recipients,<span class="k"> keep</span>(master match)
<span class="c1">//only keep records that appear in the master dataset only, or both datasets</span>

<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> fake_id using donors_recipients,<span class="k"> keep</span>(master using)
<span class="c1">//only keep records that appear in the master dataset only, </span>
<span class="c1">//or the using dataset only, but not both</span>

<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> fake_id using donors_recipients,<span class="k"> keep</span>(master match)<span class="k"> gen</span>(mergevar)
<span class="c1">//call the newly created created variable &quot;mergevar&quot; instead of &quot;_merge&quot;</span>

<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> fake_id using donors_recipients,<span class="k"> keep</span>(match) nogen
<span class="c1">//don&#39;t create a new variable</span>

<span class="k">merge m</span>:<span class="m">1</span> fake_don_id using donors,<span class="k"> keep</span>(match) nogen keepusing(age_don)
<span class="c1">//don&#39;t load all the new variables from the donors dataset.</span>
<span class="c1">//just load age_don.</span>

<span class="k">corr</span> age<span class="o">*</span>
<span class="c1">//are donor age and recipient age correlated in our fake data? No.</span>

<span class="c1">//merging: using assert to make sure that all your records match</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> fake_id using donors_recipients,<span class="k"> keep</span>(master match)
<span class="k">assert</span> _merge<span class="o">==</span><span class="m">3</span>
<span class="k">drop</span> _merge

<span class="c1">//merging: using assert to make sure that *most* of your records match</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> fake_id using donors_recipients,<span class="k"> keep</span>(master match)
<span class="k">assert</span> <span class="nf">inlist</span>(_merge, <span class="m">1</span>, <span class="m">3</span>) <span class="c1">//master only, or matched</span>
<span class="k">quietly count if</span> _merge <span class="o">==</span> <span class="m">3</span>
<span class="k">assert</span> <span class="nf">r</span>(N)<span class="o">/</span>_N <span class="o">&gt;</span> <span class="m">0.99</span>  <span class="c1">//99% of records have _merge==3</span>
<span class="k">drop</span> _merge
</pre></div>
</div>
</section>
<section id="postfile">
<h3>3.3.51 <code class="docutils literal notranslate"><span class="pre">postfile</span></code><a class="headerlink" href="#postfile" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//minimal postfile example</span>

<span class="c1">//create a new dataset. The &quot;postname&quot; (what we&#39;ll call this dataset within</span>
<span class="c1">//our Stata script) is &quot;mypost&quot;. There will be three variables, a, b, and c.</span>
<span class="c1">//the file name on disk will be abc.dta</span>
<span class="k">postfile</span> mypost a b c using abc<span class="m">.</span>dta,<span class="k"> replace</span>

<span class="c1">//write three rows of data directly into the new dataset.</span>
<span class="c1">//note that each value has to be surrounded by parentheses</span>
<span class="k">post</span> mypost (<span class="m">1</span>) (<span class="m">2</span>) (<span class="m">3</span>)
<span class="k">post</span> mypost (<span class="m">4</span>) (<span class="m">5</span>) (<span class="m">6</span>)
<span class="k">post</span> mypost (<span class="m">7</span>) (<span class="m">8</span>) (<span class="o">-</span><span class="m">2</span>)

<span class="c1">//all done. Save the file and close it</span>
<span class="k">postclose</span> mypost

<span class="c1">//check out our results</span>
<span class="k">use</span> abc,<span class="k"> clear</span>
<span class="k">list</span>, clean noobs


<span class="k">use</span> transplants,<span class="k"> clear</span>

<span class="k">regress</span> bmi gender age 
<span class="k">postfile</span> pp str80 coef double(result CIleft CIright pvalue) <span class="cs">///</span>
    using betas<span class="m">.</span>dta,<span class="k"> replace</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> gender age {
<span class="k">    local</span> res=_b[<span class="nv">`v&#39;</span>]
<span class="k">    local</span> left=_b[<span class="nv">`v&#39;</span>]<span class="o">+</span>_se[<span class="nv">`v&#39;</span>]<span class="o">*</span><span class="nf">invttail</span>(<span class="nf">e</span>(df_r),<span class="m">0.975</span>)
<span class="k">    local</span> right=_b[<span class="nv">`v&#39;</span>]<span class="o">+</span>_se[<span class="nv">`v&#39;</span>]<span class="o">*</span><span class="nf">invttail</span>(<span class="nf">e</span>(df_r),<span class="m">0.025</span>)
<span class="k">    local</span> pval=<span class="m">2</span><span class="o">*</span><span class="nf">ttail</span>(<span class="nf">e</span>(df_r), <span class="nf">abs</span>(_b[<span class="nv">`v&#39;</span>]<span class="o">/</span>_se[<span class="nv">`v&#39;</span>]))
<span class="k">    post</span> pp (<span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span>) (<span class="nv">`res&#39;</span>) (<span class="nv">`left&#39;</span>) (<span class="nv">`right&#39;</span>) (<span class="nv">`pval&#39;</span>)
}
<span class="k">postclose</span> pp

<span class="c1">//let&#39;s have a look</span>
<span class="k">use</span> betas,<span class="k"> clear</span>
<span class="k">list</span>, clean noobs
</pre></div>
</div>
</section>
<section id="export-excel">
<h3>3.3.52 <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">excel</span></code><a class="headerlink" href="#export-excel" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>export excel coef result CIleft CIright using betas_table<span class="m">.</span>xlsx,<span class="k"> replace</span>

<span class="k">format</span> <span class="nx">%3.2f</span> result

<span class="k">gen ci</span> = <span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="nf">string</span>(CIleft, <span class="s">&quot;%3.2f&quot;</span>) <span class="o">+</span> <span class="s">&quot;, &quot;</span> <span class="o">+</span> <span class="nf">string</span>(CIright, <span class="s">&quot;%3.2f&quot;</span>) <span class="o">+</span> <span class="s">&quot;)&quot;</span>

export excel coef result<span class="k"> ci</span> using betas_table2<span class="m">.</span>xlsx,<span class="k"> replace</span> firstrow(variables)

<span class="k">label var</span> coef <span class="s">&quot;Variable&quot;</span>
<span class="k">label var</span> result <span class="s">&quot;Coefficient&quot;</span>
<span class="k">label var ci</span> <span class="s">&quot;95% CI&quot;</span>
export excel coef result<span class="k"> ci</span> using betas_table3<span class="m">.</span>xlsx,<span class="k"> replace</span> firstrow(varlabels)
</pre></div>
</div>
</section>
<section id="options">
<h3>3.3.53 Options<a class="headerlink" href="#options" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//demonstrate options</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>

<span class="k">capture program drop</span> opt_demo
<span class="k">program</span> define opt_demo
<span class="k">    syntax</span>, [myoption]  <span class="c1">//the user can choose to specify &quot;myoption&quot;</span>
<span class="k">    if</span> <span class="s">&quot;</span><span class="nv">`myoption&#39;</span><span class="s">&quot;</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> {  <span class="c1">//if they said &quot;myoption&quot;, display it</span>
<span class="k">        disp</span> <span class="s">&quot;You picked the option </span><span class="nv">`myoption&#39;</span><span class="s">&quot;</span>
    }
<span class="k">    else</span> {
<span class="k">        disp</span> <span class="s">&quot;No option&quot;</span> <span class="c1">//otherwise, display this</span>
    }
<span class="k">end</span>

opt_demo   <span class="c1">//&quot;No option&quot;</span>
opt_demo, myoption   <span class="c1">//&quot;You picked the option myoption&quot;</span>

<span class="k">capture program drop</span> table1_o
<span class="k">program</span> define table1_o
<span class="k">    syntax varlist</span> [if] , [round]

    <span class="c1">//set display format</span>
    <span class="c1">//if they specified &quot;round&quot;, then macro round will equal the word &quot;round&quot;</span>
    <span class="c1">//otherwise, it&#39;s blank (equals &quot;&quot;)</span>
<span class="k">    if</span> <span class="s">&quot;</span><span class="nv">`round&#39;</span><span class="s">&quot;</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> {  
<span class="k">        local</span> D <span class="nx">%1.0f</span>  <span class="c1">//macro D will contain the display format</span>
    }
<span class="k">    else</span> {
<span class="k">        local</span> D <span class="nx">%3.2f</span>  <span class="c1">//set macro D to %3.2f</span>
    }

<span class="k">    disp</span> <span class="s">&quot;Variable&quot;</span> _col(<span class="m">12</span>) <span class="s">&quot;mean(SD)&quot;</span> _col(<span class="m">25</span>) <span class="s">&quot;range&quot;</span>
<span class="k">    foreach</span> v of<span class="k"> varlist</span> <span class="nv">`varlist&#39;</span> {
<span class="k">        quietly sum</span> <span class="nv">`v&#39;</span> <span class="nv">`if&#39;</span>
<span class="k">        disp</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> _col(<span class="m">12</span>) <span class="nv">`D&#39;</span> <span class="nf">r</span>(mean) <span class="s">&quot;(&quot;</span> <span class="nv">`D&#39;</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> _col(<span class="m">25</span>) <span class="cs">///</span>
            <span class="nv">`D&#39;</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nv">`D&#39;</span> <span class="nf">r</span>(max)  <span class="c1">//notice we use macro D for format</span>
    }
<span class="k">end</span>


table1_o age bmi wait_yrs<span class="k"> if</span> age<span class="o">&lt;</span><span class="m">40</span>
table1_o age bmi wait_yrs<span class="k"> if</span> age<span class="o">&gt;</span><span class="m">40</span>, round

<span class="k">capture program drop</span> minmax
<span class="k">program</span> define minmax
<span class="k">    syntax</span>  , [<span class="nf">min</span>(int <span class="m">0</span>) <span class="nf">max</span>(int <span class="m">99</span>)]
<span class="k">    disp</span> <span class="s">&quot;Min: </span><span class="nv">`min&#39;</span><span class="s">&quot;</span> _col(<span class="m">12</span>) <span class="s">&quot;Max: </span><span class="nv">`max&#39;</span><span class="s">&quot;</span>
<span class="k">end</span>
minmax
minmax, <span class="nf">min</span>(<span class="m">20</span>)
minmax, <span class="nf">min</span>(<span class="m">20</span>) <span class="nf">max</span>(<span class="m">40</span>)

<span class="c1">//another example</span>
<span class="k">capture program drop</span> list_top
<span class="k">program</span> define list_top
<span class="k">    syntax</span> varname, [top(int <span class="m">10</span>)]
    <span class="c1">//list the top `top&#39; values</span>
    <span class="c1">//if `top&#39; not specified, list the top 10</span>
<span class="k">    preserve</span>
<span class="k">    gsort</span> <span class="o">-</span><span class="nv">`varlist&#39;</span>
<span class="k">    list</span> <span class="nv">`varlist&#39;</span><span class="k"> in</span> <span class="m">1</span><span class="o">/</span><span class="nv">`top&#39;</span>, clean noobs
<span class="k">end</span>

list_top age
list_top age, top(<span class="m">5</span>)

<span class="c1">//illustrating a function that takes a string option</span>
<span class="k">capture program drop</span> disptwice
<span class="k">program</span> define disptwice
<span class="k">    syntax</span>, [mystring(string)]
<span class="k">    disp</span> <span class="s">&quot;</span><span class="nv">`mystring&#39;</span><span class="s">&quot;</span>
<span class="k">    disp</span> <span class="s">&quot;</span><span class="nv">`mystring&#39;</span><span class="s">&quot;</span>
<span class="k">end</span>


<span class="k">program</span> define birthday
<span class="k">    syntax</span>, name(string)
    disptwice, mystring(<span class="s">&quot;Happy Birthday to you&quot;</span>)
<span class="k">    disp</span> <span class="s">&quot;Happy Birthday, dear </span><span class="nv">`name&#39;</span><span class="s">&quot;</span>
<span class="k">    disp</span> <span class="s">&quot;Happy birthday to you&quot;</span>
<span class="k">end</span>

birthday, name(<span class="s">&quot;Gugu Mbatha&quot;</span>)  <span class="c1">//04/21/1983</span>


<span class="c1">//combining several of the above techniques into a &quot;table1&quot; program</span>
<span class="k">capture program drop</span> table1_nice
<span class="k">program</span> define table1_nice
<span class="k">    syntax varlist</span> [if] , [replace] [precision(int <span class="m">1</span>)] [title(string)]
    <span class="c1">//if: specify records to include in analysis (optional)</span>
    <span class="c1">//precision: # of digits to the right of decimal point (optional, default 1)</span>
    <span class="c1">//title: title to display before the table (optional)</span>

<span class="k">    preserve</span>
<span class="k">    capture keep</span> <span class="nv">`if&#39;</span> <span class="c1">//temporarily drop any records not required</span>

    <span class="c1">//set display format</span>
<span class="k">    assert</span> <span class="nf">inrange</span>(<span class="nv">`precision&#39;</span>, <span class="m">0</span>, <span class="m">6</span>) <span class="c1">//allow 0-6 digits to R of decimal point</span>
<span class="k">    local</span> pplus = <span class="nv">`precision&#39;</span> <span class="o">+</span> <span class="m">1</span> <span class="c1">//first number for formatting code</span>
<span class="k">    local</span> D %<span class="nv">`pplus&#39;</span>.<span class="nv">`precision&#39;</span>f

<span class="k">    if</span> <span class="s">&quot;</span><span class="nv">`title&#39;</span><span class="s">&quot;</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> {
<span class="k">        disp</span> <span class="s">&quot;</span><span class="nv">`title&#39;</span><span class="s">&quot;</span>
    }

<span class="k">    disp</span> <span class="s">&quot;Variable&quot;</span> _col(<span class="m">12</span>) <span class="s">&quot;mean(SD)&quot;</span> _col(<span class="m">25</span>) <span class="s">&quot;range&quot;</span>
<span class="k">    foreach</span> v of<span class="k"> varlist</span> <span class="nv">`varlist&#39;</span> {
<span class="k">        quietly sum</span> <span class="nv">`v&#39;</span> <span class="nv">`if&#39;</span>
<span class="k">        disp</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> _col(<span class="m">12</span>) <span class="nv">`D&#39;</span> <span class="nf">r</span>(mean) <span class="s">&quot;(&quot;</span> <span class="nv">`D&#39;</span> <span class="nf">r</span>(sd) <span class="s">&quot;)&quot;</span> _col(<span class="m">25</span>) <span class="cs">///</span>
            <span class="nv">`D&#39;</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nv">`D&#39;</span> <span class="nf">r</span>(max)  <span class="c1">//notice we use macro D for format</span>
    }
<span class="k">end</span>


table1_nice age bmi wait_yrs<span class="k"> if</span> age<span class="o">&gt;</span><span class="m">40</span>, precision(<span class="m">2</span>)<span class="k"> replace</span> <span class="cs">///</span>
    title(<span class="s">&quot;Study population&quot;</span>)





<span class="c1">//put it in a program</span>
<span class="k">capture program drop</span> model
<span class="k">program</span> define model
    <span class="c1">//takes a varlist of independent (x) variables,</span>
    <span class="c1">//a filename to post the data to,</span>
    <span class="c1">//and the name of a dependent (y) variable</span>
<span class="k">    syntax varlist</span>, yvar(varname) filename(string)

<span class="k">    regress</span> <span class="nv">`yvar&#39;</span> <span class="nv">`varlist&#39;</span>

<span class="k">    postfile</span> pp str80 variable double(result CIleft CIright pvalue) <span class="cs">///</span>
        using <span class="nv">`filename&#39;</span>,<span class="k"> replace</span>
<span class="k">    foreach</span> v of<span class="k"> varlist</span> <span class="nv">`varlist&#39;</span> {
<span class="k">        local</span> res=_b[<span class="nv">`v&#39;</span>]
<span class="k">        local</span> left=_b[<span class="nv">`v&#39;</span>]<span class="o">+</span>_se[<span class="nv">`v&#39;</span>]<span class="o">*</span><span class="nf">invttail</span>(<span class="nf">e</span>(df_r),<span class="m">0.975</span>)
<span class="k">        local</span> right=_b[<span class="nv">`v&#39;</span>]<span class="o">+</span>_se[<span class="nv">`v&#39;</span>]<span class="o">*</span><span class="nf">invttail</span>(<span class="nf">e</span>(df_r),<span class="m">0.025</span>)
<span class="k">        local</span> pval=<span class="m">2</span><span class="o">*</span><span class="nf">ttail</span>(<span class="nf">e</span>(df_r), <span class="nf">abs</span>(_b[<span class="nv">`v&#39;</span>]<span class="o">/</span>_se[<span class="nv">`v&#39;</span>]))
<span class="k">        post</span> pp (<span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span>) (<span class="nv">`res&#39;</span>) (<span class="nv">`left&#39;</span>) (<span class="nv">`right&#39;</span>) (<span class="nv">`pval&#39;</span>)
    }
<span class="k">    postclose</span> pp
<span class="k">end</span>

<span class="k">use</span> transplants,<span class="k"> clear</span>
model age wait_yrs gender rec_hcv_antibody, yvar(bmi) filename(model_bmi)


<span class="k">use</span> model_bmi,<span class="k"> clear</span>
<span class="k">list</span>, clean noobs

<span class="c1">//BONUS: make it fancy</span>
<span class="k">capture program drop</span> model2
<span class="k">program</span> define model2
<span class="k">    syntax varlist</span>, cmd(string) [show<span class="k"> replace</span>] filename(string)

    <span class="nv">`cmd&#39;</span> <span class="nv">`varlist&#39;</span>
<span class="k">     local</span> cmd1=<span class="nf">word</span>(<span class="s">&quot;</span><span class="nv">`cmd&#39;</span><span class="s">&quot;</span>,<span class="m">1</span>)

<span class="k">    assert</span> <span class="nf">inlist</span>(<span class="s">&quot;</span><span class="nv">`cmd1&#39;</span><span class="s">&quot;</span>, <span class="s">&quot;regress&quot;</span>, <span class="s">&quot;logit&quot;</span>, <span class="s">&quot;logistic&quot;</span>)

<span class="k">    postfile</span> pp str80 variable double(result CIleft CIright pvalue) <span class="cs">///</span>
        using <span class="nv">`filename&#39;</span>, <span class="nv">`replace&#39;</span>
<span class="k">    foreach</span> v of<span class="k"> varlist</span> <span class="nv">`varlist&#39;</span> {
<span class="k">        if</span> <span class="s">&quot;</span><span class="nv">`cmd1&#39;</span><span class="s">&quot;</span><span class="o">==</span><span class="s">&quot;logistic&quot;</span> | <span class="s">&quot;</span><span class="nv">`cmd1&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;logit&quot;</span> {
<span class="k">            local</span> res=<span class="nf">exp</span>(_b[<span class="nv">`v&#39;</span>])
<span class="k">            local</span> left=<span class="nf">exp</span>(_b[<span class="nv">`v&#39;</span>]<span class="o">+</span>_se[<span class="nv">`v&#39;</span>]<span class="o">*</span><span class="nf">invnormal</span>(<span class="m">0.025</span>))
<span class="k">            local</span> right=<span class="nf">exp</span>(_b[<span class="nv">`v&#39;</span>]<span class="o">+</span>_se[<span class="nv">`v&#39;</span>]<span class="o">*</span><span class="nf">invnormal</span>(<span class="m">0.975</span>))
<span class="k">            local</span> pval=(<span class="m">1</span><span class="o">-</span><span class="nf">normal</span>(<span class="nf">abs</span>(_b[<span class="nv">`v&#39;</span>]<span class="o">/</span>_se[<span class="nv">`v&#39;</span>])))<span class="o">*</span><span class="m">2</span>
        }
<span class="k">        else if</span> <span class="s">&quot;</span><span class="nv">`cmd1&#39;</span><span class="s">&quot;</span><span class="o">==</span><span class="s">&quot;regress&quot;</span> {
<span class="k">            local</span> res=_b[<span class="nv">`v&#39;</span>]
<span class="k">            local</span> left=_b[<span class="nv">`v&#39;</span>]<span class="o">+</span>_se[<span class="nv">`v&#39;</span>]<span class="o">*</span><span class="nf">invttail</span>(<span class="nf">e</span>(df_r),<span class="m">0.975</span>)
<span class="k">            local</span> right=_b[<span class="nv">`v&#39;</span>]<span class="o">+</span>_se[<span class="nv">`v&#39;</span>]<span class="o">*</span><span class="nf">invttail</span>(<span class="nf">e</span>(df_r),<span class="m">0.025</span>)
<span class="k">            local</span> pval=<span class="m">2</span><span class="o">*</span><span class="nf">ttail</span>(<span class="nf">e</span>(df_r), <span class="nf">abs</span>(_b[<span class="nv">`v&#39;</span>]<span class="o">/</span>_se[<span class="nv">`v&#39;</span>]))
        }
<span class="k">        post</span> pp (<span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span>) (<span class="nv">`res&#39;</span>) (<span class="nv">`left&#39;</span>) (<span class="nv">`right&#39;</span>) (<span class="nv">`pval&#39;</span>)
    }
<span class="k">    postclose</span> pp

<span class="k">    quietly</span> {
<span class="k">        preserve</span>
<span class="k">        use</span> <span class="nv">`filename&#39;</span>,<span class="k"> clear</span>
<span class="k">        if</span> <span class="s">&quot;</span><span class="nv">`show&#39;</span><span class="s">&quot;</span><span class="o">!=</span><span class="s">&quot;&quot;</span> {
<span class="k">            noisily list</span>, clean noobs
        }
<span class="k">        compress</span>
<span class="k">        save</span>,<span class="k"> replace</span>
<span class="k">        format</span> <span class="nx">%3.2f</span> result CIleft CIright pvalue
        export excel using <span class="nv">`filename&#39;</span>.xlsx,<span class="k"> replace</span> firstrow(variables)
    }
<span class="k">end</span>

<span class="k">use</span> transplants,<span class="k"> clear</span>
model2 gender race age, filename(model_bmi) cmd(<span class="s">&quot;regress bmi&quot;</span>) show<span class="k"> replace</span>
model2 bmi race age, filename(model_gender) cmd(<span class="s">&quot;logistic gender&quot;</span>) show<span class="k"> replace</span>
</pre></div>
</div>
<p>Certainly! Let’s break down and annotate the Stata code more clearly, focusing on key sections and explaining their purposes in smaller, more digestible parts. I’ll highlight a few important commands and provide explanatory notes on how they’re used.</p>
</section>
<section id="set">
<h3>3.3.54 <code class="docutils literal notranslate"><span class="pre">set</span></code><a class="headerlink" href="#set" title="Permalink to this heading">#</a></h3>
<p><strong>Setting Up the Stata Environment</strong></p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">version</span> <span class="m">18</span>
<span class="k">clear</span> all
<span class="k">macro drop</span> _all
<span class="k">set more</span> off
<span class="k">set</span> linesize <span class="m">80</span>
<span class="k">set</span> varabbrev<span class="k"> on</span>
</pre></div>
</div>
<p>Here we configure the Stata environment:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">version</span> <span class="pre">18</span></code>: Ensures that the session uses Stata version 11’s features and syntax.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clear</span> <span class="pre">all</span></code>: Clears all data from memory to start with a clean slate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">macro</span> <span class="pre">drop</span> <span class="pre">_all</span></code>: Deletes all existing macros to prevent unexpected behavior.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">more</span> <span class="pre">off</span></code>: Outputs all results at once without pausing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">linesize</span> <span class="pre">80</span></code>: Sets the output line width to 80 characters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">varabbrev</span> <span class="pre">on</span></code>: Allows using abbreviated names for variables.</p></li>
</ul>
</section>
<section id="collapse">
<h3>3.3.55 <code class="docutils literal notranslate"><span class="pre">collapse</span></code><a class="headerlink" href="#collapse" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">describe</span> ctr_id
<span class="k">tab</span> ctr_id,<span class="k"> sum</span>(age)
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">transplants,</span> <span class="pre">clear</span></code>: Loads the “transplants” dataset, clearing any existing data in memory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">describe</span> <span class="pre">ctr_id</span></code>: Displays details about the ‘ctr_id’ variable, such as its storage type and labels.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tab</span> <span class="pre">ctr_id,</span> <span class="pre">sum(age)</span></code>: Tabulates the ‘ctr_id’ variable, summarizing the ‘age’ data alongside to provide insight into the distribution of ages within each ‘ctr_id’ group.</p></li>
</ul>
<p><strong>Data Aggregation</strong></p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">collapse</span> (mean) age,<span class="k"> by</span>(ctr_id)
<span class="k">list</span>, clean
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">collapse</span> <span class="pre">(mean)</span> <span class="pre">age,</span> <span class="pre">by(ctr_id)</span></code>: This command collapses the dataset to one observation per ‘ctr_id’ group, calculating the mean age for each group.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">list,</span> <span class="pre">clean</span></code>: Displays the collapsed data in a simple, clean format.</p></li>
</ul>
<p><strong>Alternative Syntax for Aggregation</strong></p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">collapse</span> (mean) mean_age=age,<span class="k"> by</span>(ctr_id)
<span class="k">list</span>, clean
</pre></div>
</div>
<ul class="simple">
<li><p>After reloading the dataset, this snippet performs a similar collapse but assigns a new variable name ‘mean_age’ for the mean age, making the output more understandable.</p></li>
</ul>
<p><strong>Multiple Variable Aggregation</strong></p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">collapse</span> (mean) age wait bmi,<span class="k"> by</span>(ctr_id)
<span class="k">list</span>, clean noobs
</pre></div>
</div>
<ul class="simple">
<li><p>This section shows how to collapse multiple variables at once, calculating the mean of ‘age’, ‘wait’, and ‘BMI’ by each ‘ctr_id’.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">noobs</span></code> option in the <code class="docutils literal notranslate"><span class="pre">list</span></code> command omits observation numbers for a cleaner display.</p></li>
</ul>
<p>These snippets and explanations provide a clearer picture of what each part of the code is doing, making it less intimidating and more approachable. If you need further details or explanations on other sections, feel free to ask!</p>
</section>
<section id="reshape">
<h3>3.3.56 <code class="docutils literal notranslate"><span class="pre">reshape</span></code><a class="headerlink" href="#reshape" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//example of reshape wide</span>
<span class="k">reshape</span> wide<span class="k"> n</span>, i(ctr_id) j(yr)
<span class="k">list</span> ctr_id n2007<span class="o">-</span>n2010, clean noobs


<span class="c1">//go back to long</span>
<span class="k">reshape</span> long

<span class="c1">//and again</span>
<span class="k">reshape</span> wide
<span class="k">reshape</span> long
<span class="k">reshape</span> wide

<span class="c1">//change missingness of n2006-n2015 variables to 0</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> n20<span class="o">*</span> {
<span class="k">    replace</span> <span class="nv">`v&#39;</span> = <span class="m">0</span><span class="k"> if</span> <span class="nf">missing</span>(<span class="nv">`v&#39;</span>)
}

<span class="k">reshape</span> long

<span class="c1">//syntax for reshaping wide to long</span>
<span class="c1">//setup</span>
<span class="k">reshape</span> wide
<span class="k">reshape clear</span>

<span class="k">reshape</span> long<span class="k"> n</span>, i(ctr_id) j(yr)
<span class="k">list</span>, clean noobs
 
</pre></div>
</div>
</section>
<section id="expand">
<h3>3.3.57 <code class="docutils literal notranslate"><span class="pre">expand</span></code><a class="headerlink" href="#expand" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//expand</span>

<span class="c1">//a simple example with expand</span>
<span class="c1">//prep work</span>
<span class="k">clear</span>
<span class="k">set</span> obs <span class="m">3</span>   <span class="c1">//set # of records in dataset</span>
<span class="k">gen</span> id = _n
<span class="k">list</span>,clean 

<span class="c1">//expand 3 (2 more of each observation)</span>
<span class="k">expand</span> <span class="m">3</span>
<span class="k">list</span>,clean


<span class="c1">//prep work for more complicated &quot;expand&quot; example</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">gen</span> int<span class="k"> n</span>=<span class="m">1</span>
<span class="k">collapse</span> (sum)<span class="k"> n</span> (mean)mean_age=age (sd)sd_age=age,<span class="k"> by</span>(ctr_id)
<span class="k">save</span> ctr_age,<span class="k"> replace</span>

<span class="k">list if</span> ctr_id<span class="o">==</span><span class="m">24</span>, clean noobs

<span class="c1">//now we have a dataset of transplant centers</span>
<span class="c1">//we want one record per patient</span>
<span class="c1">//perhaps we&#39;re going to do some sort of simulation</span>

<span class="k">use</span> ctr_age,<span class="k"> clear</span>
<span class="k">count</span>
<span class="k">expand n</span> <span class="c1">//make n copies of each record</span>
<span class="k">count</span> 
<span class="c1">//since the original transplants.dta has 2000 records, after doing our</span>
<span class="c1">//collapse then expand we should still have 2000 records</span>
<span class="k">assert</span> <span class="nf">r</span>(N) <span class="o">==</span> <span class="m">6000</span>

<span class="c1">//now generate sim ages (just as a demonstration)</span>
<span class="k">gen</span> sim_age = mean_age<span class="o">+</span><span class="nf">rnormal</span>()<span class="o">*</span>sd_age

<span class="c1">//were the sim ages realistic?</span>
<span class="k">sum</span> sim_age
</pre></div>
</div>
</section>
<section id="local-extended">
<h3>3.3.58 <code class="docutils literal notranslate"><span class="pre">local</span></code>, extended<a class="headerlink" href="#local-extended" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">sum</span> age
<span class="c1">//mean+SD are similar, but sim ages had more extreme values than the real ones</span>

<span class="c1">//extended macro functions</span>
<span class="k">local</span> ll: variable<span class="k"> label</span> race
<span class="k">disp</span> <span class="s">&quot;</span><span class="nv">`ll&#39;</span><span class="s">&quot;</span>   <span class="c1">//display &quot;Patient race&quot;</span>

<span class="k">local</span> ll: variable<span class="k"> label</span> gender
<span class="k">disp</span> <span class="s">&quot;</span><span class="nv">`ll&#39;</span><span class="s">&quot;</span>   <span class="c1">//nothing</span>

<span class="k">local</span> vlabel: value<span class="k"> label</span> race
<span class="k">disp</span> <span class="s">&quot;</span><span class="nv">`vlabel&#39;</span><span class="s">&quot;</span>   <span class="c1">//display &quot;race&quot; which is the name of race&#39;s value label</span>

<span class="k">local</span> val:<span class="k"> label</span> race <span class="m">4</span>
<span class="k">disp</span> <span class="s">&quot;</span><span class="nv">`val&#39;</span><span class="s">&quot;</span>   <span class="c1">//display &quot;4=Hispanic&quot;</span>

<span class="k">sum</span> wait_yrs
<span class="k">local</span> m1:<span class="k"> disp</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(mean)
<span class="k">disp</span> <span class="s">&quot;</span><span class="nv">`m1&#39;</span><span class="s">&quot;</span>

<span class="k">sum</span> wait_yrs
<span class="k">local</span> m2:<span class="k"> di</span> <span class="s">&quot;Mean: &quot;</span> <span class="nx">%3.2f</span> <span class="nf">r</span>(mean)
<span class="k">display</span> <span class="s">&quot;</span><span class="nv">`m2&#39;</span><span class="s">&quot;</span>

<span class="k">sum</span> wait_yrs
<span class="k">local</span> m3:<span class="k"> di</span> <span class="s">&quot;Range: &quot;</span> <span class="cs">///</span>
    <span class="nx">%3.1f</span> <span class="nf">r</span>(min) <span class="s">&quot;-&quot;</span> <span class="nx">%3.1f</span> <span class="nf">r</span>(max)
<span class="k">display</span> <span class="s">&quot;</span><span class="nv">`m3&#39;</span><span class="s">&quot;</span>
</pre></div>
</div>
</section>
<section id="global-vs-local">
<h3>3.3.59 <code class="docutils literal notranslate"><span class="pre">global</span></code> vs. <code class="docutils literal notranslate"><span class="pre">local</span></code><a class="headerlink" href="#global-vs-local" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//global vs local macros</span>
<span class="k">global</span> mymacro = <span class="m">11</span>
<span class="k">disp</span> <span class="s">&quot;Here is </span><span class="vg">$mymacro</span><span class="s">&quot;</span>

<span class="k">local</span> mymacro = <span class="m">7</span>
<span class="k">global</span> mymacro = <span class="m">11</span>
<span class="k">disp</span> <span class="s">&quot;Headed to the </span><span class="nv">`mymacro&#39;</span><span class="s">-</span><span class="vg">$mymacro</span><span class="s">&quot;</span>

<span class="c1">//show the difference between local and global macros</span>
<span class="k">capture program drop</span> macro_show
<span class="k">program</span> define macro_show
<span class="k">    local</span> inside = <span class="s">&quot;in Vegas&quot;</span>
<span class="k">    global</span> inside = <span class="s">&quot;in Vegas&quot;</span>
<span class="k">    disp</span> <span class="s">&quot;Local: </span><span class="nv">`inside&#39;</span><span class="s">  </span><span class="nv">`outside&#39;</span><span class="s">&quot;</span>
<span class="k">    disp</span> <span class="s">&quot;Global: </span><span class="vg">$inside</span><span class="s">  </span><span class="vg">$outside</span><span class="s">&quot;</span>
<span class="k">    disp</span> <span class="s">&quot;Done.&quot;</span>
<span class="k">end</span>
<span class="k">local</span> outside = <span class="s">&quot;At home&quot;</span>
<span class="k">global</span> outside = <span class="s">&quot;At home&quot;</span>
macro_show
<span class="k">disp</span> <span class="s">&quot;Local: </span><span class="nv">`inside&#39;</span><span class="s">  </span><span class="nv">`outside&#39;</span><span class="s">&quot;</span>
<span class="k">disp</span> <span class="s">&quot;Global: </span><span class="vg">$inside</span><span class="s">  </span><span class="vg">$outside</span><span class="s">&quot;</span>

<span class="k">capture program drop</span> mystery_program
<span class="k">program</span> define mystery_program
<span class="k">    local</span> myvalue = <span class="m">24</span>
<span class="k">    global</span> myvalue = <span class="m">24</span>
<span class="k">end</span>

<span class="k">local</span> myvalue = <span class="m">5</span>
<span class="k">global</span> myvalue = <span class="m">5</span>
mystery_program
<span class="k">disp</span> <span class="s">&quot;I have </span><span class="nv">`myvalue&#39;</span><span class="s"> fingers.&quot;</span>
<span class="k">disp</span> <span class="s">&quot;I have </span><span class="vg">$myvalue</span><span class="s"> fingers.&quot;</span>


<span class="c1">//skeleton &quot;unlabeled&quot; program</span>
<span class="c1">//fill this in as an in-class exercise</span>
<span class="k">capture program drop</span> unlabeled
<span class="k">program</span> define unlabeled 
   <span class="c1">//list variables with no variable label</span>
<span class="k">   syntax varlist</span>
<span class="k">   foreach</span> v of<span class="k"> varlist</span> <span class="nv">`varlist&#39;</span> {
<span class="k">       local</span> vlabel: variable<span class="k"> label</span> <span class="nv">`v&#39;</span>
<span class="k">       if</span> <span class="s">&quot;</span><span class="nv">`vlabel&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> {
<span class="k">            disp</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span>
       }
       <span class="c1">//What goes here?</span>
   }
<span class="k">end</span>

<span class="c1">//test</span>
unlabeled age race ctr_id don_ecd

<span class="k">capture program drop</span> labelval
<span class="k">program</span> define labelval 
   <span class="c1">//labelval abo, val(3) prints &quot;3=B&quot;</span>
<span class="k">   syntax</span> varname, val(int)
<span class="k">   local</span> labname: value<span class="k"> label</span> <span class="nv">`varlist&#39;</span>
<span class="k">   local</span> opt:<span class="k"> label</span> <span class="nv">`labname&#39;</span> <span class="nv">`val&#39;</span>
<span class="k">   disp</span> <span class="s">&quot;</span><span class="nv">`opt&#39;</span><span class="s">&quot;</span>
   <span class="c1">//What goes here?</span>
<span class="k">end</span>

<span class="c1">//test</span>
labelval abo, val(<span class="m">3</span>)
</pre></div>
</div>
</section>
<section id="histogram">
<h3>3.3.60 <code class="docutils literal notranslate"><span class="pre">histogram</span></code><a class="headerlink" href="#histogram" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//histograms</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>


<span class="c1">//basic histogram (density histogram)</span>
<span class="k">hist</span> bmi

<span class="c1">//specify that each bar of the histogram covers an interval of two units</span>
<span class="k">hist</span> bmi, width(<span class="m">2</span>)

<span class="c1">//specify age interval of two years, and start the graph at age 0</span>
<span class="k">hist</span> bmi, width(<span class="m">2</span>) start(<span class="m">0</span>)

<span class="c1">//specify that we want ten bars</span>
<span class="k">hist</span> bmi, bin(<span class="m">10</span>)

<span class="c1">//a *density* histogram (the default)</span>
<span class="k">hist</span> rec_wgt_kg, width(<span class="m">2</span>)
<span class="k">hist</span> rec_wgt_kg, width(<span class="m">10</span>)

<span class="c1">//specify that we want a *fraction* histogram (height of 0.1=10% of all values)</span>
<span class="k">hist</span> rec_wgt_kg, fraction width(<span class="m">2</span>)
<span class="k">hist</span> rec_wgt_kg, fraction width(<span class="m">10</span>)

<span class="c1">//a *percent* histogram (height of 10 = 10% of all values)</span>
<span class="k">hist</span> rec_wgt_kg, percent width(<span class="m">2</span>)
<span class="k">hist</span> rec_wgt_kg, percent width(<span class="m">10</span>)

<span class="c1">//a *frequency* histogram (height = # of records represented by one bar)</span>
<span class="k">hist</span> rec_wgt_kg, freq width(<span class="m">2</span>)
<span class="k">hist</span> rec_wgt_kg, freq width(<span class="m">10</span>)

<span class="c1">//illustrating hist, discrete discrete</span>
<span class="k">hist</span> dx <span class="c1">//each bar is &lt; 1 diagnosis - histogram looks weird</span>
<span class="k">hist</span> dx, discrete <span class="c1">//1 bar per diagnosis</span>



<span class="c1">//random number generation</span>
<span class="c1">//setup</span>
<span class="k">clear</span>
<span class="k">set</span> obs <span class="m">1000</span>
<span class="k">gen n</span> = _n

<span class="c1">//random numbers - uniform distribution</span>
<span class="k">disp</span> <span class="nf">runiform</span>()  <span class="c1">//displays random number uniformly distributed between 0 and 1</span>
<span class="k">disp</span> <span class="nf">runiform</span>()
<span class="k">disp</span> <span class="nf">runiform</span>()

<span class="k">gen</span> unif1 = <span class="nf">runiform</span>()
<span class="k">hist</span> unif1, width(.<span class="m">05</span>) start(<span class="m">0</span>) freq

<span class="c1">//setting the random number seed</span>
<span class="k">set</span> seed <span class="m">40301</span>
<span class="c1">//should be . 43463916</span>
<span class="k">disp</span> <span class="nf">runiform</span>() 

<span class="c1">//random number between 0 and 10</span>
<span class="k">gen</span> unif10 = <span class="nf">runiform</span>()<span class="o">*</span><span class="m">10</span>
<span class="k">hist</span> unif10, width(<span class="m">1</span>) start(<span class="m">0</span>) freq

<span class="c1">//random number between 0 and 10</span>
<span class="k">gen</span> unif15 = <span class="nf">runiform</span>()<span class="o">*</span><span class="m">10+5</span>
<span class="k">hist</span> unif15, width(<span class="m">1</span>) start(<span class="m">0</span>) freq

<span class="k">gen</span> norm1 = <span class="nf">rnormal</span>()
<span class="k">hist</span> norm1, width(<span class="m">0.5</span>) freq

<span class="c1">//mean 5, SD 1</span>
<span class="k">gen</span> norm5 = <span class="nf">rnormal</span>(<span class="m">5</span>)
<span class="k">hist</span> norm5, width(<span class="m">0.5</span>) start(<span class="m">0</span>) freq

<span class="c1">//mean 20, SD 4</span>
<span class="k">gen</span> norm20 = <span class="nf">rnormal</span>(<span class="m">20</span>,<span class="m">3</span>)
<span class="k">hist</span> norm20, width(<span class="m">1</span>) start(<span class="m">0</span>) freq

<span class="c1">//binomial</span>
<span class="k">gen</span> binom = <span class="nf">rbinomial</span>(<span class="m">10</span>,<span class="m">0.5</span>)
<span class="k">hist</span> binom, discrete percent
</pre></div>
</div>
</section>
<section id="twoway">
<h3>3.3.61 <code class="docutils literal notranslate"><span class="pre">twoway</span></code><a class="headerlink" href="#twoway" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//scatter plots</span>
<span class="k">use</span> donors,<span class="k"> clear</span>
<span class="k">graph twoway scatter</span> don_wgt don_hgt

<span class="c1">//abbreviation</span>
<span class="k">twoway scatter</span> don_wgt don_hgt
<span class="k">tw sc</span> don_wgt don_hgt

<span class="c1">//line plots</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">collapse</span> (mean) don_ecd,<span class="k"> by</span>(age) <span class="c1">//ececd = 0 or 1, so for each age get </span>
<span class="c1">//proportion of transplants that were ecd</span>
<span class="k">graph twoway line</span> don_ecd age



<span class="c1">//math functions</span>

<span class="c1">//setup for math functions</span>
<span class="k">clear</span>
<span class="k">set</span> obs <span class="m">1000</span>
<span class="k">gen n</span> = _n<span class="o">/</span><span class="m">100</span> <span class="o">-</span> <span class="m">5</span>

<span class="c1">//rounding method 1: floor</span>
<span class="k">disp</span> <span class="nf">floor</span>(<span class="o">-</span><span class="m">0.3</span>)
<span class="k">disp</span> <span class="nf">floor</span>(<span class="m">4.5</span>)
<span class="k">disp</span> <span class="nf">floor</span>(<span class="m">8.9</span>)
<span class="k">gen</span> nfloor = <span class="nf">floor</span>(n)
<span class="k">graph twoway line</span> nfloor<span class="k"> n</span>

<span class="c1">//overlay the function y=x</span>
<span class="k">graph twoway line</span> nfloor<span class="k"> n</span> || function y=x,<span class="k"> range</span>(n)

<span class="c1">//rounding method 2: ceil</span>
<span class="k">disp</span> <span class="nf">ceil</span>(<span class="o">-</span><span class="m">0.3</span>)
<span class="k">disp</span> <span class="nf">ceil</span>(<span class="m">4.5</span>)
<span class="k">disp</span> <span class="nf">ceil</span>(<span class="m">8.9</span>)
<span class="k">gen</span> nceil = <span class="nf">ceil</span>(n)
<span class="k">local</span> DIAG || function y=x,<span class="k"> range</span>(n)
<span class="k">graph twoway line</span> nceil<span class="k"> n</span> <span class="nv">`DIAG&#39;</span>

<span class="c1">//rounding method 3: int</span>
<span class="k">disp</span> <span class="nf">int</span>(<span class="o">-</span><span class="m">0.3</span>)
<span class="k">disp</span> <span class="nf">int</span>(<span class="m">4.5</span>)
<span class="k">disp</span> <span class="nf">int</span>(<span class="m">8.9</span>)
<span class="k">gen</span> nint = <span class="nf">int</span>(n)
<span class="k">graph twoway line</span> nint<span class="k"> n</span> <span class="nv">`DIAG&#39;</span>

<span class="c1">//rounding method 4: round</span>
<span class="k">disp</span> <span class="nf">round</span>(<span class="o">-</span><span class="m">0.3</span>)
<span class="k">disp</span> <span class="nf">round</span>(<span class="m">4.5</span>)
<span class="k">disp</span> <span class="nf">round</span>(<span class="m">8.9</span>)
<span class="k">gen</span> nround = <span class="nf">round</span>(n)
<span class="k">graph twoway line</span> nround<span class="k"> n</span> <span class="nv">`DIAG&#39;</span>

<span class="c1">//using round to round to something other than nearest integer</span>
<span class="k">disp</span> <span class="nf">round</span>(<span class="o">-</span><span class="m">0.32</span>, <span class="m">0.1</span>)  <span class="c1">//round to nearest 0.1</span>
<span class="k">disp</span> <span class="nf">round</span>(<span class="m">4.5</span>, <span class="m">2</span>)   <span class="c1">//round to nearest 2</span>
<span class="k">disp</span> <span class="nf">round</span>(<span class="m">8.9</span>, <span class="m">10</span>)  <span class="c1">//round to nearest 10</span>
<span class="k">gen</span> round2 = <span class="nf">round</span>(n,<span class="m">2</span>)
<span class="k">twoway line</span> round2<span class="k"> n</span> <span class="nv">`DIAG&#39;</span>
</pre></div>
</div>
</section>
<section id="min-max">
<h3>3.3.62 <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code><a class="headerlink" href="#min-max" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//min and max</span>
<span class="k">disp</span> <span class="nf">min</span>(<span class="m">8</span>,<span class="m">6</span>,<span class="m">7</span>,<span class="m">5</span>,<span class="m">3</span>,<span class="m">0</span>,<span class="m">9</span>) <span class="c1">//display minimum value</span>
<span class="k">disp</span> <span class="nf">max</span>(<span class="m">8</span>,<span class="m">6</span>,<span class="m">7</span>,<span class="m">5</span>,<span class="m">3</span>,<span class="m">0</span>,<span class="m">9</span>) <span class="c1">//display maximum value</span>

<span class="k">use</span> ctr_yr<span class="k"> if</span> yr<span class="o">&gt;=</span><span class="m">2015</span>,<span class="k"> clear</span>
<span class="k">reshape</span> wide<span class="k"> n</span>, i(ctr_id) j(yr)
<span class="k">gen</span> max_vol = <span class="nf">max</span>(n2015,n2016,n2017, n2018, n2019) <span class="c1">//max of all variables</span>
<span class="k">gen</span> min_vol = <span class="nf">min</span>(n2015,n2016,n2017, n2018, n2019) <span class="c1">//min of all variables</span>

<span class="c1">//other math functions</span>
<span class="k">disp</span> <span class="nf">exp</span>(<span class="m">1</span>)  <span class="c1">//exponent. e^1 = e.</span>
<span class="k">disp</span> <span class="nf">ln</span>(<span class="m">20</span>)  <span class="c1">//log of 20 ~ 3</span>
<span class="k">disp</span> <span class="nf">sqrt</span>(<span class="m">729</span>)  <span class="c1">//27</span>

<span class="k">disp</span> <span class="nf">abs</span>(<span class="o">-</span><span class="m">6</span>)  <span class="c1">//absolute value</span>
<span class="k">disp</span> <span class="nf">mod</span>(<span class="m">529</span>, <span class="m">10</span>) <span class="c1">//modulus (remainder)</span>
<span class="k">disp</span> <span class="nf">c</span>(pi)  <span class="c1">//constant pi (for illustration of sine)</span>
<span class="k">disp</span> <span class="nf">sin</span>(<span class="nf">c</span>(pi)<span class="o">/</span><span class="m">2</span>) <span class="c1">//sine function</span>
</pre></div>
</div>
</section>
<section id="strings">
<h3>3.3.63 strings<a class="headerlink" href="#strings" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>//string functions
use transplants, clear
list extended_dgn in 1/5, clean

disp word(&quot;Hello, is there anybody in there?&quot;, 4)
list extended_dgn if word(ext, 5) != &quot;&quot;, clean noobs
disp strlen(&quot;Same as it ever was&quot;)
list extended_dgn if strlen(ext)&lt; 6, clean
assert regexm(&quot;Earth&quot;, &quot;art&quot;)
assert !regexm(&quot;team&quot;, &quot;I&quot;)

tab ext if regexm(ext, &quot;HTN&quot;)
list ext if regexm(ext, &quot;^A&quot;) 
//starts with A

list ext if regexm(ext, &quot;X$&quot;) 
//ends with X

tab ext if regexm(ext, &quot;HIV.*Y&quot;) 
//contains &quot;HIV&quot;, then some other stuff, then Y


</pre></div>
</div>
</section>
<section id="special-numeric-variables-dates-times">
<h3>3.3.64 special numeric variables: dates &amp; times<a class="headerlink" href="#special-numeric-variables-dates-times" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//date and time functions</span>
<span class="c1">//review of number formats</span>
<span class="k">disp</span> <span class="nx">%3.2f</span> <span class="nf">exp</span>(<span class="m">1</span>)
<span class="k">disp</span> <span class="nx">%4.1f</span> <span class="m">3.14159</span>

<span class="c1">//examples of the %td format for dates (days since 1/1/1960)</span>
<span class="k">disp</span> <span class="nx">%td</span> <span class="m">19400</span>
<span class="k">disp</span> <span class="nx">%td</span> <span class="m">366</span>
<span class="k">disp</span> <span class="nx">%td</span> <span class="o">-</span><span class="m">5</span>

<span class="c1">//example of %tc format for times (milliseconds since 1/1/1960)</span>
<span class="k">disp</span> <span class="nx">%tc</span> <span class="m">4</span><span class="o">*</span><span class="m">365.25</span><span class="o">*</span><span class="m">24</span><span class="o">*</span><span class="m">60</span><span class="o">*</span><span class="m">60</span><span class="o">*</span><span class="m">1000</span>

<span class="c1">//doing math on Stata dates</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">gen</span> oneweek = transplant_date <span class="o">+</span><span class="m">7</span>
<span class="k">format</span> <span class="nx">%td</span> oneweek
<span class="k">list</span> transplant_date  oneweek<span class="k"> in</span> <span class="m">1</span><span class="o">/</span><span class="m">3</span>

<span class="c1">//date and time functions</span>
<span class="c1">//td() function to give integer date for a given calendar date</span>
<span class="k">disp</span> <span class="nf">td</span>(04jul1976)

<span class="c1">//Assignment 2 due date (time travel?)</span>
<span class="k">disp</span> <span class="nf">td</span>(5may2021) 

<span class="c1">//mdy() function to give integer date for a given month/day/year</span>
<span class="k">disp</span> <span class="nf">mdy</span>(<span class="m">7</span>,<span class="m">4</span>,<span class="m">1976</span>)

<span class="c1">//Assignment 2 due date</span>
<span class="k">disp</span> <span class="nf">mdy</span>(<span class="m">5</span>, <span class="m">5</span>, <span class="m">2021</span>) 




<span class="c1">//date() function to convert strings to dates</span>
<span class="c1">//Woodstock festival starts</span>
<span class="k">disp</span> <span class="nf">date</span>(<span class="s">&quot;August 15, 1969&quot;</span>, <span class="s">&quot;MDY&quot;</span>)
<span class="c1">//Next perihelion of Halley&#39;s comet</span>
<span class="k">disp</span> <span class="nf">date</span>(<span class="s">&quot;2061 28 July&quot;</span>, <span class="s">&quot;YDM&quot;</span>)

<span class="c1">//mdyhms() function to get a date and time</span>
<span class="k">disp</span> <span class="nx">%15.0f</span> <span class="nf">mdyhms</span>(<span class="m">1</span>,<span class="m">1</span>,<span class="m">2011</span>,<span class="m">5</span>,<span class="m">15</span>,<span class="m">00</span>)

<span class="c1">//Summer solstice 2019 (UTC)</span>
<span class="k">disp</span> <span class="nx">%15.0f</span> <span class="nf">Clock</span>(<span class="s">&quot;June 20, 2021 23:31:00&quot;</span>, <span class="s">&quot;MDYhms&quot;</span>)

<span class="k">disp</span> <span class="s">&quot;</span><span class="vg">$S_DATE</span><span class="s">&quot;</span>
<span class="k">disp</span> <span class="s">&quot;</span><span class="vg">$S_TIME</span><span class="s">&quot;</span>
<span class="c1">//using the Clock() function to time a command</span>
<span class="k">local</span> start = <span class="nf">Clock</span>(<span class="s">&quot;</span><span class="vg">$S_DATE</span><span class="s"> </span><span class="vg">$S_TIME</span><span class="s">&quot;</span>, <span class="s">&quot;DMYhms&quot;</span>)

<span class="c1">//using timer to time a command</span>
<span class="k">timer clear</span>
<span class="k">timer on</span> <span class="m">37</span>

<span class="c1">//some code to waste time</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">quietly roccomp</span> gender bmi transplant_date  wait_yrs
<span class="k">local end</span> = <span class="nf">Clock</span>(<span class="s">&quot;</span><span class="vg">$S_DATE</span><span class="s"> </span><span class="vg">$S_TIME</span><span class="s">&quot;</span>, <span class="s">&quot;DMYhms&quot;</span>)
<span class="k">timer</span> off <span class="m">37</span>

<span class="k">disp</span> (<span class="nv">`end&#39;</span><span class="o">-</span><span class="nv">`start&#39;</span>)<span class="o">/</span><span class="m">1000</span> <span class="s">&quot; seconds&quot;</span>
<span class="k">timer list</span>
<span class="k">disp</span> <span class="s">&quot;More precisely, &quot;</span> <span class="nf">r</span>(t37) <span class="s">&quot; seconds&quot;</span>
</pre></div>
</div>
</section>
<section id="cond">
<h3>3.3.65 <code class="docutils literal notranslate"><span class="pre">cond</span></code><a class="headerlink" href="#cond" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//cond</span>
<span class="k">capture program drop</span> datasize
<span class="k">program</span> define datasize
<span class="k">    disp</span> _c <span class="s">&quot;The dataset is &quot;</span>
<span class="k">    disp</span> <span class="nf">cond</span>(_N<span class="o">&gt;=</span><span class="m">1000</span>, <span class="s">&quot;big&quot;</span>, <span class="s">&quot;small&quot;</span>)
<span class="k">end</span>

datasize

<span class="k">gen</span> m_f = <span class="nf">cond</span>(gender<span class="o">==</span><span class="m">1</span>, <span class="s">&quot;Female&quot;</span>, <span class="s">&quot;Male&quot;</span>)
<span class="k">tab</span> gender m_f
</pre></div>
</div>
</section>
<section id="nested-macros">
<h3>3.3.70 Nested Macros<a class="headerlink" href="#nested-macros" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//example: nested macros</span>
<span class="k">local</span> a6 = <span class="m">35</span>
<span class="k">local</span> b = <span class="m">6</span>
<span class="k">disp</span> <span class="nv">`a`b&#39;&#39;</span>  <span class="c1">//get 35</span>


<span class="c1">//more complicated example</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">local</span> vars age bmi prev_ki
<span class="k">regress</span> peak_pra <span class="nv">`vars&#39;</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="nv">`vars&#39;</span> {
<span class="k">    local</span> beta_<span class="nv">`v&#39;</span> = _b[<span class="nv">`v&#39;</span>]
}
<span class="c1">//other stuff</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="nv">`vars&#39;</span> {
<span class="k">    disp</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> _col(<span class="m">10</span>) <span class="nx">%3.2f</span> <span class="nv">`beta_`v&#39;&#39;</span> 
}

<span class="c1">//even more complicated example</span>
<span class="k">local</span> vars age bmi prev_ki
<span class="k">regress</span> peak_pra <span class="nv">`vars&#39;</span><span class="k"> if</span> gender<span class="o">==</span><span class="m">0</span>  <span class="c1">//get coefficients for males</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="nv">`vars&#39;</span> {
<span class="k">    local</span> beta_<span class="nv">`v&#39;</span>_m = _b[<span class="nv">`v&#39;</span>]
}
<span class="k">regress</span> peak_pra <span class="nv">`vars&#39;</span><span class="k"> if</span> gender<span class="o">==</span><span class="m">1</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="nv">`vars&#39;</span> {
<span class="k">    local</span> beta_<span class="nv">`v&#39;</span>_f = _b[<span class="nv">`v&#39;</span>]
}
<span class="k">local</span> header = <span class="m">1</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="nv">`vars&#39;</span> {
<span class="k">    if</span> <span class="nv">`header&#39;</span> <span class="o">==</span> <span class="m">1</span> {
<span class="k">        display</span> <span class="s">&quot;Variable&quot;</span> _col(<span class="m">10</span>) <span class="s">&quot;Overall&quot;</span> _col(<span class="m">20</span>) <span class="s">&quot;Male&quot;</span> _col(<span class="m">30</span>) <span class="s">&quot;Female&quot;</span>
<span class="k">        local</span> header = <span class="m">0</span>
    }
<span class="k">    disp</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> _col(<span class="m">10</span>) <span class="nx">%3.2f</span> <span class="nv">`beta_`v&#39;&#39;</span> _col(<span class="m">20</span>) <span class="nx">%3.2f</span> <span class="nv">`beta_`v&#39;_m&#39;</span> _c
<span class="k">    disp</span> _col(<span class="m">30</span>) <span class="nx">%3.2f</span> <span class="nv">`beta_`v&#39;_f&#39;</span>
}
</pre></div>
</div>
</section>
<section id="graph">
<h3>3.3.71 <code class="docutils literal notranslate"><span class="pre">graph</span></code><a class="headerlink" href="#graph" title="Permalink to this heading">#</a></h3>
<p>In this script, we’re working with data from transplant records, focusing particularly on the gender distribution and type of transplants over the years. Let’s break down the script:</p>
<ol class="arabic simple">
<li><p>Data Preparation:</p></li>
</ol>
<ul class="simple">
<li><p>You begin by loading a dataset named transplants and immediately cleaning it up by generating year information and preparing gender-related and transplant type (ECD vs. SCD) variables.</p></li>
<li><p>You collapse the data to get yearly sums of total transplants, number of ECD transplants, and number of female transplants.</p></li>
<li><p>From these sums, you calculate the number of SCD transplants and male transplants.</p></li>
<li><p>This dataset is then saved for later use.</p></li>
</ul>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">capture graph drop</span> _all

<span class="c1">//prep work:</span>
<span class="c1">//make a dataset of # SCD and ECD transplants for each year</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">gen</span> int yr = <span class="nf">year</span>(transplant_date)  <span class="c1">//year of transplant</span>
<span class="k">gen</span> byte<span class="k"> n</span>=<span class="m">1</span> 
<span class="k">rename</span> gender female <span class="c1">//total # female transplants</span>
<span class="c1">//n = total # records; sum(ecd) = # SCD transplants; sum(female) = # females</span>
<span class="k">rename</span> don_ecd ecd
<span class="k">collapse</span> (sum)<span class="k"> n</span> ecd female,<span class="k"> by</span>(yr) 
<span class="k">gen</span> int scd =<span class="k"> n</span><span class="o">-</span>ecd
<span class="k">gen</span> int male =<span class="k"> n</span><span class="o">-</span>female
<span class="k">save</span> tx_yr,<span class="k"> replace</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Basic Graphing:</p></li>
</ol>
<ul class="simple">
<li><p>You create various simple graphs like line, connected, area, bar, and scatter plots to visualize the data. Each type of graph highlights different aspects of the data, such as trends over time or relationships between variables.</p></li>
<li><p>Function plots with specified ranges and combinations of different plots are also included to showcase more advanced graphing capabilities.</p></li>
</ul>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//show various kinds of graph in their simplest form</span>
<span class="k">graph twoway line n</span> yr  <span class="c1">//line graph</span>
<span class="k">graph twoway</span> connected<span class="k"> n</span> yr  <span class="c1">//connected graph</span>
<span class="k">graph twoway</span> area<span class="k"> n</span> yr  <span class="c1">//area graph</span>
<span class="k">graph twoway</span> bar<span class="k"> n</span> yr  <span class="c1">//bar graph</span>
<span class="k">graph twoway scatter</span> ecd scd  <span class="c1">//scatter plot</span>
<span class="k">graph twoway</span> function y=x<span class="o">^</span><span class="m">2+2</span>  <span class="c1">//function</span>


<span class="c1">//range() option for function</span>
<span class="k">graph twoway</span> function y=x<span class="o">^</span><span class="m">2+2</span>,<span class="k"> range</span> (<span class="m">1</span> <span class="m">10</span>)  <span class="c1">//function</span>
<span class="k">graph twoway</span> function y=x<span class="o">^</span><span class="m">2+2</span>,<span class="k"> range</span>(yr)

<span class="c1">//graphing more than one Y variable</span>
<span class="k">graph twoway line</span> ecd scd yr
<span class="k">graph twoway line n</span> ecd scd yr
<span class="k">graph twoway</span> area ecd scd yr <span class="c1">//ecd area is hidden by scd area</span>
<span class="k">graph twoway</span> area scd ecd yr <span class="c1">//now ecd area shows, since it&#39;s drawn second</span>
<span class="k">graph twoway</span> bar  scd ecd yr 

<span class="c1">//combining several plots</span>
<span class="k">graph twoway line n</span> yr || connected male female yr

<span class="c1">//another way of writing the same thing, using /// to continue the same</span>
<span class="c1">//command on two lines</span>
<span class="k">graph twoway line n</span> yr <span class="cs">///</span>
     || connected male female yr

<span class="c1">//overlay observed data with linear regression fit</span>
<span class="k">regress n</span> yr
<span class="k">graph twoway line n</span> yr <span class="cs">///</span>
  || function y=_b[_cons]<span class="o">+</span>_b[yr]<span class="o">*</span>x,<span class="k"> range</span>(yr)
<span class="k">graph copy</span> Graph slide51


<span class="c1">//illustrate that you can combine lots of plots in one graph</span>
<span class="k">graph twoway line</span> female yr <span class="cs">///</span>
  ||<span class="k"> line</span> male yr <span class="cs">///</span>
  ||<span class="k"> line</span> scd yr <span class="cs">///</span>
  ||<span class="k"> line</span> ecd yr <span class="cs">///</span>
  ||<span class="k"> line n</span> yr

<span class="c1">//of course, you could make the same graph with</span>
<span class="c1">//graph twoway line female male scd ecd n yr</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Advanced Graphing Features:</p></li>
</ol>
<ul class="simple">
<li><p>Further customization is applied using options like yscale, xscale, and graph labels to enhance the readability and presentation of the graphs. These options adjust the axis ranges, orientations, and legends, helping to clarify the data presentation for different audiences.</p></li>
<li><p>Examples include log scaling, reversing axes, hiding axes, custom labels, and legend manipulations.</p></li>
</ul>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//xscale/yscale</span>
<span class="k">graph twoway line n</span> yr, yscale(range(<span class="m">0</span>)) <span class="c1">//range of Y axis includes zero</span>
<span class="k">graph twoway line n</span> yr, yscale(range(<span class="m">0</span> <span class="m">700</span>)) <span class="c1">//Y axis range includes 0 and 700</span>

<span class="c1">//specify ranges for both X and Y axes</span>
<span class="k">graph twoway line n</span> yr, xscale(range(<span class="m">2050</span>)) 

<span class="k">graph twoway line</span> female yr, yscale(log) <span class="c1">//write Y axis on a log scale</span>
<span class="k">graph twoway line</span> female yr, xscale(reverse) <span class="c1">//reverse the X axis - mirror image</span>
<span class="k">graph twoway line</span> female yr, xscale(off) yscale(off) <span class="c1">//suppress axes entirely</span>

<span class="c1">//combining several scale options</span>
<span class="c1">//this graph doesn&#39;t look great. For the variables that we&#39;re using for this</span>
<span class="c1">//exercise, the default Stata axes look pretty good. But this illustrates</span>
<span class="c1">//that you can combine as many scale options as you want.</span>
<span class="k">graph twoway line</span> ecd yr, xscale(off) yscale(log<span class="k"> range</span>(<span class="m">1</span>) reverse)

<span class="c1">//graph label options</span>
<span class="c1">//Pick &quot;approximately four&quot; nice values based on axis range</span>
<span class="k">graph twoway line n</span> yr, yscale(range(<span class="m">0</span>)) ylabel(#<span class="m">4</span>)

<span class="c1">//label minimum and maximum values</span>
<span class="k">graph twoway line n</span> yr, yscale(range(<span class="m">0</span>)) ylabel(minmax)

<span class="c1">//start at 0, and go in increments of 100 up to 600</span>
<span class="k">graph twoway line n</span> yr, yscale(range(<span class="m">0</span>)) ylabel(<span class="m">0</span>(<span class="m">100</span>)<span class="m">600</span>)

<span class="c1">//custom labels</span>
<span class="k">graph twoway line n</span> yr, ylabel(<span class="m">0</span>(<span class="m">100</span>)<span class="m">600</span>) <span class="cs">///</span>
    xlabel(<span class="m">2005</span> <span class="m">2007</span> <span class="s">&quot;policy change&quot;</span> <span class="m">2010</span>(<span class="m">5</span>)<span class="m">2020</span>)
 

<span class="c1">//add &quot;ticks&quot; (small vertical line) every unlabeled year in X axis</span>
<span class="k">graph twoway line n</span> yr, yscale(range(<span class="m">0</span>)) ylabel(<span class="m">0</span>(<span class="m">100</span>)<span class="m">600</span>) xtick(<span class="m">2005</span>(<span class="m">1</span>)<span class="m">2020</span>)

<span class="c1">//axis titles</span>
<span class="c1">//DDKT = deceased donor kidney transplant</span>
<span class="k">graph twoway line n</span> yr, xtitle(<span class="s">&quot;Calendar year&quot;</span>) ytitle(<span class="s">&quot;DDKT&quot;</span>) ylabel(<span class="m">0</span>(<span class="m">100</span>)<span class="m">600</span>)

<span class="c1">//minor ticks</span>
<span class="k">graph twoway line n</span> yr, ylabel(<span class="m">0</span>(<span class="m">200</span>)<span class="m">600</span>) ymlabel(<span class="m">100</span>(<span class="m">200</span>)<span class="m">500</span>)
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Exporting and Managing Graphs:</p></li>
</ol>
<ul class="simple">
<li><p>The script also demonstrates how to export graphs into PNG format for inclusion in documents, and how to manage saved graphs within Stata.</p></li>
<li><p>This functionality is crucial for documenting and sharing results in professional or academic settings.</p></li>
</ul>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">graph</span> export l7_mlabel<span class="m">.</span>png,<span class="k"> replace</span> width(<span class="m">600</span>)

<span class="c1">//angle</span>
<span class="k">graph twoway line n</span> yr,  ylabel(<span class="m">0</span>(<span class="m">100</span>)<span class="m">600</span>, angle(horizontal))
<span class="k">graph</span> export l7_angle<span class="m">.</span>png,<span class="k"> replace</span> width(<span class="m">600</span>)

<span class="c1">//graph titles</span>
<span class="k">graph twoway line n</span> yr, title(<span class="s">&quot;Transplants per year&quot;</span>) ylabel(<span class="m">0</span>(<span class="m">100</span>)<span class="m">600</span>)

<span class="c1">//title and subtitle</span>
<span class="k">graph twoway line n</span> yr, title(<span class="s">&quot;Transplants per year&quot;</span>) ylabel(<span class="m">0</span>(<span class="m">100</span>)<span class="m">600</span>) <span class="cs">///</span>
    subtitle(<span class="s">&quot;2006-2018&quot;</span>) 

<span class="c1">//note and caption options</span>
<span class="k">graph twoway line n</span> yr, title(<span class="s">&quot;title&quot;</span>) subtitle(<span class="s">&quot;subtitle&quot;</span>) <span class="cs">///</span>
<span class="k">  note</span>(<span class="s">&quot;note&quot;</span>) caption(<span class="s">&quot;caption&quot;</span>)
<span class="k"> graph copy</span> Graph slide79

<span class="c1">//stacking up the options</span>
<span class="k">graph twoway line</span> male female yr, title(<span class="s">&quot;Transplants per year, 2006-2018&quot;</span>) subtitle(<span class="s">&quot;stratified by gender&quot;</span>) 
 

 
<span class="c1">//legend options</span>
<span class="c1">//put the legend inside the graph</span>
<span class="k">graph twoway line</span> male female yr, legend(ring(<span class="m">0</span>)) 

<span class="c1">//put the legend inside the graph, in upper-left corner (&quot;eleven o&#39;clock&quot;)</span>
<span class="k">graph twoway line</span> male female yr, legend(ring(<span class="m">0</span>) pos(<span class="m">11</span>)) 

<span class="c1">//put the legend inside the graph, in lower-right corner (&quot;five o&#39;clock&quot;)</span>
<span class="k">graph twoway line</span> male female yr, legend(ring(<span class="m">0</span>) pos(<span class="m">5</span>)) 

<span class="c1">//put the legend at 5:00 - change Y range so it fits</span>
<span class="k">graph twoway line</span> male female yr, legend(ring(<span class="m">0</span>) pos(<span class="m">5</span>)) yscale(range(<span class="m">0</span>))

<span class="c1">//put the different legend &quot;keys&quot; in one column</span>
<span class="k">graph twoway line</span> male female yr, legend(ring(<span class="m">0</span>) pos(<span class="m">5</span>) cols(<span class="m">1</span>)) 

<span class="c1">//change the order of the &quot;keys&quot;</span>
<span class="c1">//in this case, you just could do &quot;twoway line female male yr&quot;</span>
<span class="c1">//but order() is really handy when you have complicated graphs containing</span>
<span class="c1">//multiple types of plot</span>
<span class="k">graph twoway line</span> male female yr, legend(ring(<span class="m">0</span>) pos(<span class="m">5</span>) <span class="k"> order</span>(<span class="m">2</span> <span class="m">1</span>)) 
<span class="k">graph twoway line</span> male female yr, legend(ring(<span class="m">0</span>) pos(<span class="m">5</span>) cols(<span class="m">1</span>)<span class="k"> order</span>(<span class="m">2</span> <span class="m">1</span>)) 

<span class="c1">//print the legend for males but not females</span>
<span class="c1">// (&quot;order&quot;) suppresses legend for anything that&#39;s not included)</span>
<span class="k">graph twoway line</span> male female yr, legend(ring(<span class="m">0</span>) pos(<span class="m">5</span>) cols(<span class="m">1</span>)<span class="k"> order</span>(<span class="m">1</span>)) 

<span class="c1">//legend labels</span>
<span class="k">graph twoway line</span> male female yr, <span class="cs">///</span>
    legend(ring(<span class="m">0</span>) pos(<span class="m">5</span>) cols(<span class="m">1</span>)<span class="k"> label</span>(<span class="m">1</span> <span class="s">&quot;Men&quot;</span>)<span class="k"> label</span>(<span class="m">2</span> <span class="s">&quot;Women&quot;</span>))
<span class="k">	graph copy</span> Graph slide88

<span class="c1">//force legend to print (when it normally wouldn&#39;t)</span>
<span class="k">graph twoway line n</span> yr, legend(on)

<span class="c1">//force legend *NOT* to print (when it normally would)</span>
<span class="k">graph twoway line</span> male female yr, legend(off)

<span class="c1">//line options</span>
<span class="k">twoway line n</span> yr, xline(<span class="m">2007</span>)
<span class="k">twoway line n</span> yr, yline(<span class="m">500</span>)

<span class="c1">//text option</span>
<span class="c1">//add the text &quot;policy change&quot; at y=450 x=2007 on the graph</span>
<span class="k">twoway line n</span> yr, xline(<span class="m">2007</span>) text(<span class="m">450</span> <span class="m">2007</span> <span class="s">&quot;Policy change&quot;</span>)

<span class="k">twoway line n</span> yr, ylabel(<span class="m">0</span>(<span class="m">100</span>)<span class="m">600</span>) text(<span class="m">600</span> <span class="m">2017</span> <span class="s">&quot;Local peak in 2017&quot;</span>)

<span class="c1">//twoway line options</span>
<span class="c1">//sort</span>
<span class="c1">//first, we have to *UN*sort</span>

<span class="k">sort n</span>
<span class="k">list</span>, clean noobs

<span class="c1">//display unsorted graph</span>
<span class="k">twoway line n</span> yr, ylabel(<span class="m">0</span>(<span class="m">100</span>)<span class="m">600</span>)

<span class="c1">//now display the graph with the line drawn properly</span>
<span class="k">twoway line n</span> yr, ylabel(<span class="m">0</span>(<span class="m">100</span>)<span class="m">600</span>)<span class="k"> sort</span> 

<span class="c1">//options for drawing the line: line color</span>
<span class="k">twoway line</span>  scd ecd yr, lcolor(green pink)<span class="k"> sort</span>

<span class="c1">//line thickness</span>
<span class="k">twoway line</span> scd ecd  yr, lwidth(thick thick)<span class="k"> sort</span>
<span class="c1">//valid thicknesses are:</span>
<span class="c1">//vvthin vthin thin medthin medium medthick thick vthick vvthick vvvthick </span>


<span class="c1">//line pattern</span>
<span class="k">twoway line</span> scd ecd yr, lpattern(solid dash)<span class="k"> sort</span>
<span class="k">graph copy</span> Graph slide105
<span class="c1">//valid patterns are:</span>
<span class="c1">//solid dash dot dash_dot shortdash shortdash_dot longdash longdash_dot blank </span>

<span class="c1">//scatter plot options</span>
<span class="k">use</span> transplants<span class="m">.</span>dta,<span class="k"> clear</span>
<span class="k">keep if</span> peak_pra <span class="o">&lt;=</span> <span class="m">10</span>
<span class="k">graph twoway scatter</span> peak_pra age

<span class="c1">//add jitter (random noise)</span>
<span class="k">graph twoway scatter</span> peak_pra age, jitter(<span class="m">2</span>)

<span class="k">graph twoway scatter</span> bmi age<span class="k"> if</span> gender<span class="o">==</span><span class="m">0</span>, mcolor(orange) <span class="cs">///</span>
 ||<span class="k"> scatter</span> bmi age<span class="k"> if</span> gender<span class="o">==</span><span class="m">1</span>, mcolor(black)
<span class="k"> graph copy</span> Graph slide110

<span class="c1">//marker symbol</span>
<span class="k">graph twoway scatter</span> bmi age<span class="k"> if</span> gender<span class="o">==</span><span class="m">0</span>, msymbol(D) <span class="cs">///</span>
    ||<span class="k"> scatter</span> bmi age<span class="k"> if</span> gender<span class="o">==</span><span class="m">1</span>, msymbol(<span class="o">+</span>)

<span class="c1">//marker size</span>
<span class="k">graph twoway scatter</span> bmi age<span class="k"> if</span> gender<span class="o">==</span><span class="m">0</span>, msize(small) <span class="cs">///</span>
    ||<span class="k"> scatter</span> bmi age<span class="k"> if</span> gender<span class="o">==</span><span class="m">1</span>, msize(large)
<span class="c1">//valid sizes:</span>
<span class="c1">// tiny vsmall small medsmall medium medlarge large vlarge huge </span>


<span class="c1">//displaying a graph stored from earlier</span>
<span class="k">graph display</span> slide51
<span class="k">graph dir</span>
<span class="k">assert</span> <span class="m">0</span>

<span class="c1">//saving a graph as a Stata .gph file</span>
<span class="k">graph save</span> slide51<span class="m">.</span>gph,<span class="k"> replace</span>

<span class="c1">//exporting a graph to .PNG (for putting in a document)</span>
<span class="k">graph</span> export slide51<span class="m">.</span>png,<span class="k"> replace</span>
</pre></div>
</div>
<p>These practice examples attempt to be comprehensive and utilize Stata’s capabilities to analyze and visualize <code class="docutils literal notranslate"><span class="pre">transplant.dta</span></code>.</p>
</section>
<section id="frame">
<h3>3.3.80 <code class="docutils literal notranslate"><span class="pre">frame</span></code><a class="headerlink" href="#frame" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//no log file because this is supposed to be called from lecture8_2022.do</span>

<span class="c1">//frames</span>

<span class="c1">//only works in Stata 16 or later</span>
<span class="k">version</span> <span class="m">16</span>

<span class="c1">//frames demo</span>

<span class="c1">//create a new frame</span>
<span class="k">capture</span> frame<span class="k"> drop</span> donors
frame create donors

<span class="c1">//load donors.dta into the new frame</span>
frame donors:<span class="k"> use</span> donors,<span class="k"> clear</span>

<span class="c1">//count how many records there are in frame &quot;donors&quot;</span>
frame donors:<span class="k"> count</span>

<span class="c1">//load in transplants.dta into our main frame</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">count</span>

<span class="c1">//do some more work in frame donors</span>
frame donors {
<span class="k">    count</span> 
<span class="k">    sum</span> don_creat
<span class="k">    corr</span> don_creat age_don
}

<span class="c1">//switch to frame donors</span>
frame change donors
<span class="k">count</span>

<span class="c1">//switch back to the default frame, which has transplants.dta loaded</span>
frame change default
<span class="k">count</span>

<span class="c1">//copy existing data into a new frame</span>
<span class="k">capture</span> frame<span class="k"> drop</span> kids
frame put fake_id age gender race died<span class="k"> if</span> age<span class="o">&lt;</span><span class="m">18</span>, into(kids)

frame kids:<span class="k"> list in</span> <span class="m">1</span><span class="o">/</span><span class="m">10</span>, clean

frame kids {
<span class="k">     count</span>
<span class="k">     sum</span> age
}

<span class="k">count</span>
<span class="k">sum</span> age

frame change kids
<span class="k">count</span>
<span class="k">sum</span> age

frame change default
<span class="k">count</span>
<span class="k">sum</span> age
</pre></div>
</div>
</section>
<section id="putdocx">
<h3>3.3.81 <code class="docutils literal notranslate"><span class="pre">putdocx</span></code><a class="headerlink" href="#putdocx" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//putdocx: make Word docs</span>

<span class="c1">//only works in Stata 15 or later</span>
<span class="k">version</span> <span class="m">15</span>

<span class="c1">//do a &quot;hello, world&quot; with putdocx</span>
putdocx<span class="k"> clear</span>

<span class="c1">//start a new doc</span>
putdocx begin

<span class="c1">//required before &quot;putdocx text&quot; otherwise r(198) &quot;no active paragraph&quot;</span>
putdocx paragraph

putdocx text (<span class="s">&quot;Fourth quarter is almost over&quot;</span>)

<span class="c1">//NOTE: &quot;putdocx save&quot; requires the Word document to  be closed</span>
<span class="c1">//otherwise r(603) &quot;failed to save document&quot;</span>
putdocx<span class="k"> save</span> doc1<span class="m">.</span>docx,<span class="k"> replace</span>

<span class="c1">//fancier text</span>
putdocx begin

putdocx paragraph
putdocx text (<span class="s">&quot;Fourth quarter is &quot;</span>)
putdocx text (<span class="s">&quot;almost over&quot;</span>), bold
putdocx text (<span class="s">&quot;.&quot;</span>)

putdocx paragraph
putdocx text (<span class="s">&quot;Some of us are &quot;</span>)
putdocx text (<span class="s">&quot;graduating&quot;</span>), underline
putdocx text (<span class="s">&quot;!&quot;</span>)
putdocx<span class="k"> save</span> doc2<span class="m">.</span>docx,<span class="k"> replace</span>

<span class="c1">//let&#39;s do a logistic regression and output the results</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="c1">//who is more likely to get an ECD donor?</span>
<span class="k">logistic</span> don_ecd age i<span class="m">.</span>abo bmi i<span class="m">.</span>race i<span class="m">.</span>gender

putdocx begin

<span class="c1">//how many participants in the regression model?</span>
<span class="k">count if e</span>(sample)
<span class="k">local</span> nn = <span class="nf">r</span>(N)

putdocx paragraph
putdocx text <span class="cs">///</span>
    (<span class="s">&quot;Table 1: Characteristics associated with receiving an ECD kidney,&quot;</span>), bold 

<span class="c1">//write a macro right into the Word doc</span>
putdocx text (<span class="s">&quot; from Stata class dataset (N=</span><span class="nv">`nn&#39;</span><span class="s">)&quot;</span>), bold

<span class="c1">//NOTE: you have to run your model *right before* using &quot;putdocx table=etable&quot;</span>
<span class="c1">//(or replay it)</span>
<span class="k">logistic</span>
putdocx<span class="k"> table</span> model1_table = etable

<span class="c1">//jump to a new page</span>
putdocx pagebreak

<span class="c1">//start a new paragraph</span>
putdocx paragraph
putdocx text <span class="cs">///</span>
    (<span class="s">&quot;Figure 1: Age of DDKT recipients, stratified by donor type.&quot;</span>), bold 

<span class="c1">//make a figure</span>
<span class="k">label</span> define ecd <span class="m">0</span> <span class="s">&quot;SCD donor&quot;</span> <span class="m">1</span> <span class="s">&quot;ECD donor&quot;</span>
<span class="k">label</span> values don_ecd ecd
<span class="k">graph</span> box age, over(don_ecd) title(<span class="s">&quot;&quot;</span>) <span class="c1">//no title bc it&#39;s gonna have a caption</span>
<span class="k">graph</span> export figure1<span class="m">.</span>png,<span class="k"> replace</span> width(<span class="m">2400</span>)

putdocx paragraph, halign(center) <span class="c1">//center the paragraph containing the image</span>
putdocx image figure1<span class="m">.</span>png, width(<span class="m">7</span>)  <span class="c1">//make it 7 inches wide</span>
<span class="c1">//width(15cm) = 15 cm. Can also be width(360pt) = 360 points (5 inches)</span>
 

putdocx<span class="k"> save</span> doc3<span class="m">.</span>docx,<span class="k"> replace</span>
</pre></div>
</div>
</section>
<section id="levelsof">
<h3>3.3.82 <code class="docutils literal notranslate"><span class="pre">levelsof</span></code><a class="headerlink" href="#levelsof" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//levelsof</span>
<span class="k">levelsof</span> race
<span class="k">disp</span> <span class="nf">r</span>(levels)
<span class="k">local</span> rlevel = <span class="nf">r</span>(levels)
<span class="k">foreach</span> r<span class="k"> in</span> <span class="nv">`rlevel&#39;</span> {
<span class="k">    sum</span> age<span class="k"> if</span> race<span class="o">==</span><span class="nv">`r&#39;</span>
}
</pre></div>
</div>
</section>
<section id="tables-beyond-table1">
<h3>3.3.83 tables beyond <code class="docutils literal notranslate"><span class="pre">table1</span></code><a class="headerlink" href="#tables-beyond-table1" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">//PROGRAMS FOR WRITING OUT STATA TABLES</span>

<span class="k">capture program drop</span> v14_setup
<span class="k">program</span> define v14_setup
<span class="k">    syntax</span>, filename(string)
    putexcel<span class="k"> set</span> <span class="nv">`filename&#39;</span>, modify

    putexcel B1= (<span class="s">&quot;aOR&quot;</span>)
    putexcel C1= (<span class="s">&quot;p&quot;</span>)
<span class="k">end</span>

<span class="k">capture program drop</span> v14_writerow
<span class="k">program</span> define v14_writerow
<span class="k">    syntax</span>, row(int)<span class="k"> label</span>(string) parameter(string)
    <span class="c1">//&quot;int&quot; = row we&#39;re writing to</span>
    <span class="c1">//&quot;label&quot; = label of first column</span>
    <span class="c1">//&quot;parameter&quot; = parameter to do in this row</span>

<span class="k">    lincom</span> <span class="nv">`parameter&#39;</span>  <span class="c1">//obtain estimate, 95% CI, p value</span>
                       <span class="c1">//NOTE: v13/14 lincom gives only estimate and se</span>
<span class="c1">//     return list</span>
<span class="c1">//     assert 0</span>
<span class="k">    local</span> lb:<span class="k"> disp</span> <span class="nx">%2.1f</span> <span class="nf">r</span>(lb)
<span class="k">    local</span> ub:<span class="k"> disp</span> <span class="nx">%2.1f</span> <span class="nf">r</span>(ub)
<span class="k">    local</span> p = <span class="nf">r</span>(p)
<span class="k">    local est</span>:<span class="k"> disp</span> <span class="nx">%2.1f</span> <span class="nf">r</span>(estimate)

<span class="k">    local</span> pdisp:<span class="k"> disp</span> <span class="nx">%2.1f</span> <span class="nv">`p&#39;</span>
<span class="k">    if</span> <span class="nv">`p&#39;</span> <span class="o">&lt;</span> <span class="m">0.15</span> {
<span class="k">        local</span> pdisp:<span class="k"> disp</span> <span class="nx">%3.2f</span> <span class="nv">`p&#39;</span>
    }
<span class="k">    if</span> <span class="nf">inrange</span>(<span class="nv">`p&#39;</span>, <span class="m">0.045</span>, <span class="m">0.055</span>) {
<span class="k">        local</span> pdisp:<span class="k"> disp</span> <span class="nx">%4.3f</span> <span class="nv">`p&#39;</span>
    }
<span class="k">    if</span> <span class="nv">`p&#39;</span> <span class="o">&lt;</span> <span class="m">0.01</span> {
<span class="k">        local</span> pdisp = <span class="s">&quot;&lt;0.01&quot;</span>
    }
<span class="k">    if</span> <span class="nv">`p&#39;</span> <span class="o">&lt;</span> <span class="m">0.001</span> {
<span class="k">        local</span> pdisp = <span class="s">&quot;&lt;0.001&quot;</span>
    }

    putexcel A<span class="nv">`row&#39;</span>=(<span class="s">&quot;</span><span class="nv">`label&#39;</span><span class="s">&quot;</span>)
    putexcel B<span class="nv">`row&#39;</span> = (<span class="s">&quot;</span><span class="nv">`est&#39;</span><span class="s"> (</span><span class="nv">`lb&#39;</span><span class="s">-</span><span class="nv">`ub&#39;</span><span class="s">)&quot;</span>)
    putexcel C<span class="nv">`row&#39;</span> = (<span class="s">&quot;</span><span class="nv">`pdisp&#39;</span><span class="s">&quot;</span>)
<span class="k">end</span>




<span class="k">capture program drop</span> v15_docsetup
<span class="k">program</span> define v15_docsetup
    putdocx<span class="k"> clear</span>
    putdocx begin
<span class="k">end</span>

<span class="k">capture program drop</span> v15_tablesetup
<span class="k">program</span> define v15_tablesetup
<span class="k">    syntax</span>, caption(string)<span class="k"> table</span>(string)

    putdocx paragraph, font(Calibri,<span class="m">11</span>, black)
    putdocx text (<span class="s">&quot;</span><span class="nv">`caption&#39;</span><span class="s">&quot;</span>), bold

    <span class="c1">//create a custom-formatted table</span>
    putdocx<span class="k"> table</span> <span class="nv">`table&#39;</span> = (<span class="m">6</span>,<span class="m">3</span>), <span class="cs">///    6 rows, 3 columns</span>
        halign(center)          <span class="cs">///       center the table</span>
        border(insideH,, white) <span class="cs">///       interior horiz borders are white</span>
        border(insideV,, white) <span class="cs">///       interior vert  borders are white</span>
        border(start,, white)  <span class="cs">///        left border is white</span>
        border(end,, white)  <span class="cs">///          right border is white</span>
        border(top,, black)  <span class="cs">///          top border is black</span>
        border(bottom,, black)  <span class="cs">///       bottom border is black</span>
        width(<span class="m">70</span>%)         <span class="c1">//             make the table 70% as wide as the page</span>

    <span class="c1">//make the top row (header) have a black bottom border</span>
    <span class="c1">//NOTE: must have *no space* between table name and parenthesis</span>
    <span class="c1">//because Stata is soooo fussy about spaces</span>
    putdocx<span class="k"> table</span> <span class="nv">`table&#39;</span>(<span class="m">1</span>,.), border(bottom,,black)


    <span class="c1">//write header text</span>
    <span class="c1">//NOTE: produces an error if there&#39;s a space between the &quot;e&quot; and the &quot;(&quot;</span>
    <span class="c1">//because of course it does</span>
    putdocx<span class="k"> table</span> <span class="nv">`table&#39;</span>(<span class="m">1</span>,<span class="m">2</span>) = (<span class="s">&quot;aOR&quot;</span>), halign(center)
    putdocx<span class="k"> table</span> <span class="nv">`table&#39;</span>(<span class="m">1</span>,<span class="m">3</span>) = (<span class="s">&quot;p&quot;</span>), halign(center)

<span class="k">end</span>

<span class="k">capture program drop</span> v15_writerow
<span class="k">program</span> define v15_writerow
<span class="k">    syntax</span>,<span class="k"> table</span>(string) row(int)<span class="k"> label</span>(string) parameter(string)
    <span class="c1">//&quot;table&quot; = name of the table we&#39;re writing to</span>
    <span class="c1">//&quot;int&quot; = row we&#39;re writing to</span>
    <span class="c1">//&quot;label&quot; = label of first column</span>
    <span class="c1">//&quot;parameter&quot; = parameter to do in this row</span>

    <span class="c1">//put the label for the table row (first column)</span>
    <span class="c1">//remember: no space between table name and parenthesis</span>
    putdocx<span class="k"> table</span> <span class="nv">`table&#39;</span>(<span class="nv">`row&#39;</span>, <span class="m">1</span>)=(<span class="s">&quot;</span><span class="nv">`label&#39;</span><span class="s">&quot;</span>)

    <span class="c1">//calculate OR for parameter</span>
    <span class="c1">//use lincom so that we can pass, say, 10*age</span>
<span class="k">    lincom</span> <span class="nv">`parameter&#39;</span>
<span class="k">    local</span> lb:<span class="k"> disp</span> <span class="nx">%2.1f</span> <span class="nf">r</span>(lb)
<span class="k">    local</span> ub:<span class="k"> disp</span> <span class="nx">%2.1f</span> <span class="nf">r</span>(ub)
<span class="k">    local</span> p = <span class="nf">r</span>(p)
<span class="k">    local est</span>:<span class="k"> disp</span> <span class="nx">%2.1f</span> <span class="nf">r</span>(estimate)
<span class="k">    if</span> <span class="nf">r</span>(p)<span class="o">&lt;</span><span class="m">0.05</span> {
<span class="k">        local</span> b = <span class="s">&quot;bold&quot;</span>
    }

    <span class="c1">//p value</span>
<span class="k">    local</span> pdisp:<span class="k"> disp</span> <span class="nx">%2.1f</span> <span class="nv">`p&#39;</span>
<span class="k">    if</span> <span class="nv">`p&#39;</span> <span class="o">&lt;</span> <span class="m">0.15</span> {
<span class="k">        local</span> pdisp:<span class="k"> disp</span> <span class="nx">%3.2f</span> <span class="nv">`p&#39;</span>
    }
<span class="k">    if</span> <span class="nf">inrange</span>(<span class="nv">`p&#39;</span>, <span class="m">0.045</span>, <span class="m">0.055</span>) {
<span class="k">        local</span> pdisp:<span class="k"> disp</span> <span class="nx">%4.3f</span> <span class="nv">`p&#39;</span>
    }
<span class="k">    if</span> <span class="nv">`p&#39;</span> <span class="o">&lt;</span> <span class="m">0.01</span> {
<span class="k">        local</span> pdisp = <span class="s">&quot;&lt;0.01&quot;</span>
    }
<span class="k">    if</span> <span class="nv">`p&#39;</span> <span class="o">&lt;</span> <span class="m">0.001</span> {
<span class="k">        local</span> pdisp = <span class="s">&quot;&lt;0.001&quot;</span>
    }

    <span class="c1">//whew! Now actually put the stuff in the table</span>
    putdocx<span class="k"> table</span> <span class="nv">`table&#39;</span>(<span class="nv">`row&#39;</span>, <span class="m">2</span>) = (<span class="s">&quot;</span><span class="nv">`lb&#39;</span><span class="s">&quot;</span>), <span class="nv">`b&#39;</span> halign(center) script(sub)
    putdocx<span class="k"> table</span> <span class="nv">`table&#39;</span>(<span class="nv">`row&#39;</span>, <span class="m">2</span>) = (<span class="s">&quot; </span><span class="nv">`est&#39;</span><span class="s"> &quot;</span>), <span class="nv">`b&#39;</span><span class="k"> append</span>
    putdocx<span class="k"> table</span> <span class="nv">`table&#39;</span>(<span class="nv">`row&#39;</span>, <span class="m">2</span>) = (<span class="s">&quot;</span><span class="nv">`ub&#39;</span><span class="s">&quot;</span>), <span class="nv">`b&#39;</span> script(sub)<span class="k"> append</span>

    putdocx<span class="k"> table</span> <span class="nv">`table&#39;</span>(<span class="nv">`row&#39;</span>, <span class="m">3</span>) = (<span class="s">&quot;</span><span class="nv">`pdisp&#39;</span><span class="s">&quot;</span>), halign(center)
<span class="k">end</span>

<span class="c1">//a bit of prep work</span>
<span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="c1">//new functional form of race/ethnicity based on prior regression</span>
<span class="k">gen</span> byte race_aa = race<span class="o">==</span><span class="m">2</span>  <span class="c1">//African-American</span>
<span class="k">gen</span> byte race_na = race<span class="o">==</span><span class="m">5</span>  <span class="c1">//Native American/indigenous</span>

<span class="k">logistic</span> don_ecd age race_aa race_na gender bmi

<span class="c1">//this code requires Stata 15.1 or later to work</span>
<span class="k">assert</span> <span class="nf">c</span>(stata_version)<span class="o">&gt;=</span><span class="m">15.1</span>

<span class="c1">//Stata 13/14</span>

<span class="k">if</span> <span class="nf">c</span>(stata_version)<span class="o">&lt;</span><span class="m">15</span> {
    v14_setup, filename(<span class="s">&quot;table_v14.xlsx&quot;</span>)

    v14_writerow, row(<span class="m">2</span>)<span class="k"> label</span>(<span class="s">&quot;Age (per 10y)&quot;</span>) parameter(<span class="m">10</span><span class="o">*</span>age)
    v14_writerow, row(<span class="m">3</span>)<span class="k"> label</span>(<span class="s">&quot;African-American&quot;</span>) parameter(race_aa)
    v14_writerow, row(<span class="m">4</span>)<span class="k"> label</span>(<span class="s">&quot;Native American&quot;</span>) parameter(race_na)
    v14_writerow, row(<span class="m">5</span>)<span class="k"> label</span>(<span class="s">&quot;Female&quot;</span>) parameter(gender)
    v14_writerow, row(<span class="m">6</span>)<span class="k"> label</span>(<span class="s">&quot;BMI (per 5 units)&quot;</span>) parameter(<span class="m">5</span><span class="o">*</span>bmi)
}
<span class="k">else</span> {
    <span class="c1">//Stata 15 version</span>
    putdocx begin
    v15_tablesetup,<span class="k"> table</span>(t1) <span class="cs">///</span>
    caption(<span class="s">&quot;Table 1. Characteristics associated with receiving an ECD kidney.&quot;</span>)


    v15_writerow,<span class="k"> table</span>(t1) row(<span class="m">2</span>)<span class="k"> label</span>(<span class="s">&quot;Age (per 10y)&quot;</span>) parameter(<span class="m">10</span><span class="o">*</span>age)
    v15_writerow,<span class="k"> table</span>(t1) row(<span class="m">3</span>)<span class="k"> label</span>(<span class="s">&quot;African-American&quot;</span>) parameter(race_aa)
    v15_writerow,<span class="k"> table</span>(t1) row(<span class="m">4</span>)<span class="k"> label</span>(<span class="s">&quot;Native American&quot;</span>) parameter(race_na)
    v15_writerow,<span class="k"> table</span>(t1) row(<span class="m">5</span>)<span class="k"> label</span>(<span class="s">&quot;Female&quot;</span>) parameter(gender)
    v15_writerow,<span class="k"> table</span>(t1) row(<span class="m">6</span>)<span class="k"> label</span>(<span class="s">&quot;BMI (per 5 units)&quot;</span>) parameter(<span class="m">5</span><span class="o">*</span>bmi)

    putdocx<span class="k"> save</span> doc4<span class="m">.</span>docx,<span class="k"> replace</span>
}
</pre></div>
</div>
</section>
</section>
<section id="lab">
<h2>3.4 Lab<a class="headerlink" href="#lab" title="Permalink to this heading">#</a></h2>
<p>Use the <code class="docutils literal notranslate"><span class="pre">transplants.dta</span></code> dataset with these practice questions:</p>
<ol class="arabic simple">
<li><p>Calculate the standard deviation of age among patients with blood type O (<code class="docutils literal notranslate"><span class="pre">abo==4</span></code>). Print the following sentence: <code class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">SD</span> <span class="pre">of</span> <span class="pre">age</span> <span class="pre">among</span> <span class="pre">patients</span> <span class="pre">with</span> <span class="pre">blood</span> <span class="pre">type</span> <span class="pre">O</span> <span class="pre">is</span> <span class="pre">XX.X</span></code>. Replace <code class="docutils literal notranslate"><span class="pre">XX</span></code> with correct values. Round to tenths (e.g. 8.2)<a class="reference internal" href="lab3sol.html"><span class="doc std std-doc">.</span></a></p></li>
<li><p>Regress BMI on age and sex (using <code class="docutils literal notranslate"><span class="pre">regress</span> <span class="pre">bmi</span> <span class="pre">age</span> <span class="pre">gender</span></code>) without displaying the regression output. Print the following sentence: <code class="docutils literal notranslate"><span class="pre">Per</span> <span class="pre">1-year</span> <span class="pre">increase</span> <span class="pre">in</span> <span class="pre">age,</span> <span class="pre">BMI</span> <span class="pre">increases</span> <span class="pre">by</span> <span class="pre">X.XX</span></code>. Replace <code class="docutils literal notranslate"><span class="pre">XX</span></code> with the regression coefficient of age. Round to hundredths (e.g. 0.74). Review week 3.3 Miscellany: <a class="reference external" href="https://jhustata.github.io/basic/chapter3.html#more-on-return-values">3.3.22 More on return values</a> on how to extract <code class="docutils literal notranslate"><span class="pre">r()</span></code> class return values following a regression.</p></li>
<li><p>Now we will do the same thing, but using a program. Define a program named <code class="docutils literal notranslate"><span class="pre">bmi_age</span></code>. This program will regress BMI on age and sex without displaying the regression output, and print: <code class="docutils literal notranslate"><span class="pre">Per</span> <span class="pre">1-year</span> <span class="pre">increase</span> <span class="pre">in</span> <span class="pre">age,</span> <span class="pre">BMI</span> <span class="pre">increases</span> <span class="pre">by</span> <span class="pre">X.XX</span></code>. Replace <code class="docutils literal notranslate"><span class="pre">XX</span></code> with the regression coefficient of <code class="docutils literal notranslate"><span class="pre">age</span></code>. Round to hundredths (e.g. 0.74).</p></li>
<li><p>Let’s consider how you may allow the user of <code class="docutils literal notranslate"><span class="pre">bmi_age</span></code> to utilize this program on a dataset with any variable name</p></li>
</ol>
</section>
<section id="homework">
<h2>3.5 Homework<a class="headerlink" href="#homework" title="Permalink to this heading">#</a></h2>
<section id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h3>
<p>Write a <code class="docutils literal notranslate"><span class="pre">.do</span> <span class="pre">file</span></code> which imports data from <a class="reference external" href="https://jhustata.github.io/book/_downloads/884b9e06eb29f89b1b87da4eab39775d/hw1.txt">hw1.txt</a> and performs the tasks described below. Name it <code class="docutils literal notranslate"><span class="pre">hw3.lastname.firstname.do</span></code> and it should create a log file called <code class="docutils literal notranslate"><span class="pre">hw1.lastname.firstname.log</span></code>. Please avoid some of the common mistakes we observed in your HW1. While you didn’t drop points for those mistakes as beginners, you’ll drop some points in HW3 if you repeat these mistakes. Make sure your log file displays only the output of interest. But do not submit your log files as part of the assignment.</p>
<p>Evaluation will be based on the log file produced when we run your script on our machines.</p>
<p>Codebook</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>transplants.dta</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fake_id</span></code></p></td>
<td><p>Patient ID</p></td>
<td><p>Numeric</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bmi</span></code></p></td>
<td><p>Body mass index (kg/m2)</p></td>
<td><p>Numeric</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dx</span></code></p></td>
<td><p>Primary diagnosis</p></td>
<td><p>String (see dataset)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">init_age</span></code></p></td>
<td><p>Age</p></td>
<td><p>Numeric</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">prev</span></code></p></td>
<td><p>History of previous transplant</p></td>
<td><p>0=No / 1=Yes</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">peak_pra</span></code></p></td>
<td><p>Peak PRA</p></td>
<td><p>Numeric</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">female</span></code></p></td>
<td><p>Sex</p></td>
<td><p>0=No / 1=Yes</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">received_kt</span></code></p></td>
<td><p>Patient eventually received a kidney transplant?</p></td>
<td><p>0=No / 1=Yes</p></td>
</tr>
</tbody>
</table>
<p>This dataset contains simulated data on registrants for the deceased donor kidney waitlist.</p>
<p><strong>Question 1.</strong> Create a new numeric variable named <code class="docutils literal notranslate"><span class="pre">htn</span></code>, which takes a value of 1 if the variable <code class="docutils literal notranslate"><span class="pre">dx</span></code> has a value of <code class="docutils literal notranslate"><span class="pre">4=Hypertensive</span></code>, and <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise. This variable should have value labels, <code class="docutils literal notranslate"><span class="pre">Yes</span></code> for 1 and <code class="docutils literal notranslate"><span class="pre">No</span></code> for 0. (Hint: what is the data type of this new variable? Is it a numeric or a string?) Run <code class="docutils literal notranslate"><span class="pre">tab</span> <span class="pre">htn</span></code> in your assignment do-file so that it would print the following result.</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>        htn |       Freq.       Percent       Cum.
<span class="o">------------+-------------------------------------</span>
         No |       XXXX        XXXX          XXXX
        Yes |       XXXX        XXXX          XXXX
<span class="o">------------+-------------------------------------</span>
      Total |       XXXX        XXXX
</pre></div>
</div>
<p><strong>Question 2</strong>. Create your first automated Table 1! Write a program called <code class="docutils literal notranslate"><span class="pre">question2</span></code> that prints the following table (including <code class="docutils literal notranslate"><span class="pre">Question</span> <span class="pre">2</span></code> in the header). The <code class="docutils literal notranslate"><span class="pre">XX</span></code> values should be replaced with correct values found in the dataset, and should be rounded to the nearest whole number for age and to <u>one decimal place</u> to the right of the decimal point for other variables. Make sure the summary statistics are vertically aligned and justified along the left margin. Run your program and display the table on your results window, in your <code class="docutils literal notranslate"><span class="pre">.log</span></code> file, and in a <code class="docutils literal notranslate"><span class="pre">question2.xlsx</span></code>. (The key challenge: reporting continuous and binary variables. Next week we’ll include categorical variables)</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>Question <span class="m">2</span>                Males (N=XX)        Females (N=XX)
Age,<span class="k"> median</span> (IQR)         XX (XX<span class="o">-</span>XX)          XX (XX<span class="o">-</span>XX)
Previous transplant, %    XX<span class="m">.</span>X               XX<span class="m">.</span>X
</pre></div>
</div>
<p>To align output on your Stata results window, and thus in your <code class="docutils literal notranslate"><span class="pre">.log</span></code> file, you may use the column <code class="docutils literal notranslate"><span class="pre">_col()</span></code> syntax. Use the example below as a guide</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">local</span> study_arms:<span class="k"> di</span> _col(<span class="m">30</span>) <span class="s">&quot;Trial&quot;</span> _col(<span class="m">60</span>) <span class="s">&quot;Control&quot;</span>
<span class="k">di</span> <span class="s">&quot;</span><span class="nv">`study_arms&#39;</span><span class="s">&quot;</span>
</pre></div>
</div>
<p>And also consider using a “hardcoded” template to write your initial code for <code class="docutils literal notranslate"><span class="pre">.xlsx</span></code> output</p>
<Details>
   <Summary> Here's an Example </Summary>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>cls
<span class="k">use</span> transplants,<span class="k"> clear</span> 
<span class="c1">//col1</span>
putexcel<span class="k"> set</span> table1,<span class="k"> replace</span>
putexcel A1=<span class="s">&quot;Question 2&quot;</span>
putexcel A2=<span class="s">&quot;Age, median (IQR)&quot;</span>
putexcel A3=<span class="s">&quot;Previous transplant, %&quot;</span>

<span class="c1">//col2</span>
putexcel B1=<span class="s">&quot;Males (N=XX)&quot;</span>
putexcel B2=<span class="s">&quot;XX (XX-XX)&quot;</span>
putexcel B3=<span class="s">&quot;XX.X&quot;</span>

<span class="c1">//col3</span>
putexcel C1=<span class="s">&quot;Females (N=XX)&quot;</span>
putexcel C2=<span class="s">&quot;XX (XX-XX)&quot;</span>
putexcel C3=<span class="s">&quot;XX.X&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>This code is adapted from the foundational code shared <a class="reference external" href="https://jhustata.github.io/basic/chapter2.html#results-output">here</a> in week two</p></li>
<li><p>Your next steps involve replace the “XX” with the appropriate macro</p></li>
<li><p>In later weeks you may consider using loops for efficiency</p></li>
<li><p>And perhaps later, you may write an automated program to generalize this task beyond <code class="docutils literal notranslate"><span class="pre">transplants.dta</span></code></p></li>
</ul>
</Details></section>
<section id="common-mistakes-from-hw1">
<h3>Common Mistakes from HW1<a class="headerlink" href="#common-mistakes-from-hw1" title="Permalink to this heading">#</a></h3>
<details>
   <Summary></Summary>
<ol class="arabic simple">
<li><p>Your first line of code should create a <code class="docutils literal notranslate"><span class="pre">.log</span></code> file &amp; your last line should close it</p></li>
<li><p>Do not use <code class="docutils literal notranslate"><span class="pre">exit</span></code> at end of the <code class="docutils literal notranslate"><span class="pre">.do</span></code> files you submit since it closes Stata on our machines</p></li>
<li><p>May not be necessary to use <code class="docutils literal notranslate"><span class="pre">clear</span> <span class="pre">all</span></code> when <code class="docutils literal notranslate"><span class="pre">clear</span></code> suffices</p></li>
<li><p>When you load a dataset, always include the option <code class="docutils literal notranslate"><span class="pre">clear</span></code> in case there is another dataset in memory</p></li>
<li><p><strong>Always</strong> run your .do files more than once before submission to uncover subtle omissions like <code class="docutils literal notranslate"><span class="pre">capture</span> <span class="pre">log</span> <span class="pre">close</span></code>, <code class="docutils literal notranslate"><span class="pre">clear</span></code>, <code class="docutils literal notranslate"><span class="pre">log</span> <span class="pre">close</span></code>, etc</p></li>
<li><p>Never use absolute file paths to call files on your machine; these paths don’t exist on our machines. Assume we are working in the directory with the necessary file</p></li>
<li><p>For the same reason, do not use the <code class="docutils literal notranslate"><span class="pre">cd</span></code> command in your .do files</p></li>
<li><p>In grading HW3 and beyond, you’ll drop some points if you neglect these tips</p></li>
<li><p>Please <strong>do not</strong> submit <code class="docutils literal notranslate"><span class="pre">.log</span></code>, <code class="docutils literal notranslate"><span class="pre">.pdf</span></code>, <code class="docutils literal notranslate"><span class="pre">.docx</span></code>, or any other files formats. We are only interested in your <code class="docutils literal notranslate"><span class="pre">.do</span></code> files</p></li>
</ol>
</details></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="chapter2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2. Return values, macros, programs</p>
      </div>
    </a>
    <a class="right-next"
       href="chapter4.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">4. Basic file management, Programming options</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loops">3<span class="xref myst">.</span>1 Loops</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forvalues">3.1.1 <code class="docutils literal notranslate"><span class="pre">forvalues</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-this-does">What This Does</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-it-s-useful">Why It’s Useful</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#but-here-s-the-catch">But Here’s the Catch</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#foreach">3.1.2 <code class="docutils literal notranslate"><span class="pre">foreach</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#syntax-varlist">3.2 <code class="docutils literal notranslate"><span class="pre">syntax</span> <span class="pre">varlist</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#myfirst">3.2.1 myfirst</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mysecond">3.2.2 mysecond</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mythird">3.2.3 mythird</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#myfourth">3.2.4. myfourth</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#miscellany">3.3 Miscellany</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import">3.3.0 <code class="docutils literal notranslate"><span class="pre">import</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xlxs"><code class="docutils literal notranslate"><span class="pre">.xlxs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#csv"><code class="docutils literal notranslate"><span class="pre">.csv</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sav"><code class="docutils literal notranslate"><span class="pre">.sav</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sas7bdat"><code class="docutils literal notranslate"><span class="pre">.sas7bdat</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jdbc">JDBC</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#obdc">OBDC</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#txt"><code class="docutils literal notranslate"><span class="pre">.txt</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#v8xpt-xpt"><code class="docutils literal notranslate"><span class="pre">.v8xpt</span></code>, <code class="docutils literal notranslate"><span class="pre">.xpt</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fred">FRED</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dbf"><code class="docutils literal notranslate"><span class="pre">.dbf</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#commands-that-run-without-additional-syntax">3.3.1 Commands that run without additional syntax</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#anatomy-of-a-command-with-syntax">3.3.2 Anatomy of a command with syntax</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#taking-on-one-or-more-options">3.3.3 Taking on one or more options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#some-command-options-take-arguments-describing-the-options">3.3.4 Some command options take arguments describing the options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#involving-file-name-usually-preceeded-by-using-or-delimited">3.3.5 Involving file name, usually preceeded by <code class="docutils literal notranslate"><span class="pre">using</span></code> or <code class="docutils literal notranslate"><span class="pre">delimited</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulating-data-with-conditional-statements-if-in">3.3.6 Manipulating data with conditional statements: <code class="docutils literal notranslate"><span class="pre">if</span></code>, <code class="docutils literal notranslate"><span class="pre">in</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log">3.3.7 <code class="docutils literal notranslate"><span class="pre">log</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stuff-that-belongs-in-every-do-file">3.3.7 Stuff that belongs in every <code class="docutils literal notranslate"><span class="pre">.do</span></code> file</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-github-to-manage-versions-of-your-do-and-ado-files">3.3.8 Use GitHub to manage versions of your <code class="docutils literal notranslate"><span class="pre">.do</span></code> and <code class="docutils literal notranslate"><span class="pre">ado.</span></code> files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-a-file-into-memory">3.3.9 Loading a file into memory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#describe">3.3.10 <code class="docutils literal notranslate"><span class="pre">describe</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codebook">3.3.12 <code class="docutils literal notranslate"><span class="pre">codebook</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#list">3.3.13 <code class="docutils literal notranslate"><span class="pre">list</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#count">3.3.14 <code class="docutils literal notranslate"><span class="pre">count</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tabulate">3.3.15 <code class="docutils literal notranslate"><span class="pre">tabulate</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summarize">3.3.16 <code class="docutils literal notranslate"><span class="pre">summarize</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#if-missing">3.3.17 <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">missing</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate">3.3.18 <code class="docutils literal notranslate"><span class="pre">generate</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-for-your-practice">3.3.19 More for your practice</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preserve-restore">3.3.20 <code class="docutils literal notranslate"><span class="pre">preserve</span></code>, <code class="docutils literal notranslate"><span class="pre">restore</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#by">3.3.21 <code class="docutils literal notranslate"><span class="pre">by</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creturn-list-ereturn-list-return-list">3.3.22 <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">ereturn</span> <span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">list</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#line-continuation">3.3.23 Line continuation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#label-variable">3.3.24 <code class="docutils literal notranslate"><span class="pre">label</span> <span class="pre">variable</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tag">3.3.25 <code class="docutils literal notranslate"><span class="pre">tag</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drop-keep">3.3.26 <code class="docutils literal notranslate"><span class="pre">drop</span></code>, <code class="docutils literal notranslate"><span class="pre">keep</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replace">3.3.27 <code class="docutils literal notranslate"><span class="pre">replace</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rename">3.3.28 <code class="docutils literal notranslate"><span class="pre">rename</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sort-gsort">3.3.29 <code class="docutils literal notranslate"><span class="pre">sort</span></code>, <code class="docutils literal notranslate"><span class="pre">gsort</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recode">3.3.30 <code class="docutils literal notranslate"><span class="pre">recode</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#display">3.3.31 <code class="docutils literal notranslate"><span class="pre">display</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#capture">3.3.32 <code class="docutils literal notranslate"><span class="pre">capture</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assert">3.3.33 <code class="docutils literal notranslate"><span class="pre">assert</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalars-macros-matrices">3.3.34 Scalars, macros, matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#return-list">3.3.35 <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">list</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-from-the-r-class">Examples from the R-class</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ereturn-list">3.3.36 <code class="docutils literal notranslate"><span class="pre">ereturn</span> <span class="pre">list</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creturn-list">3.3.37 <code class="docutils literal notranslate"><span class="pre">creturn</span> <span class="pre">list</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#indentation">3.3.38 Indentation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notes-on-indentation">Notes on Indentation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#general-annotation-tips">General Annotation Tips</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regress">3.3.39 <code class="docutils literal notranslate"><span class="pre">regress</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#local">3.3.40 <code class="docutils literal notranslate"><span class="pre">local</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quietly">3.3.41 <code class="docutils literal notranslate"><span class="pre">quietly</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#which">3.3.42 <code class="docutils literal notranslate"><span class="pre">which</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#program-define">3.3.43 <code class="docutils literal notranslate"><span class="pre">program</span> <span class="pre">define</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3.3.44 <code class="docutils literal notranslate"><span class="pre">by</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#egen">3.3.45 <code class="docutils literal notranslate"><span class="pre">egen</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">3.3.46 <code class="docutils literal notranslate"><span class="pre">tag</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#if">3.3.47 <code class="docutils literal notranslate"><span class="pre">if</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for">3.3.48 <code class="docutils literal notranslate"><span class="pre">for</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#table1">3.3.49 <code class="docutils literal notranslate"><span class="pre">table1</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge">3.3.50 <code class="docutils literal notranslate"><span class="pre">merge</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#postfile">3.3.51 <code class="docutils literal notranslate"><span class="pre">postfile</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#export-excel">3.3.52 <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">excel</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#options">3.3.53 Options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set">3.3.54 <code class="docutils literal notranslate"><span class="pre">set</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collapse">3.3.55 <code class="docutils literal notranslate"><span class="pre">collapse</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reshape">3.3.56 <code class="docutils literal notranslate"><span class="pre">reshape</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#expand">3.3.57 <code class="docutils literal notranslate"><span class="pre">expand</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#local-extended">3.3.58 <code class="docutils literal notranslate"><span class="pre">local</span></code>, extended</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#global-vs-local">3.3.59 <code class="docutils literal notranslate"><span class="pre">global</span></code> vs. <code class="docutils literal notranslate"><span class="pre">local</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram">3.3.60 <code class="docutils literal notranslate"><span class="pre">histogram</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#twoway">3.3.61 <code class="docutils literal notranslate"><span class="pre">twoway</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#min-max">3.3.62 <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#strings">3.3.63 strings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#special-numeric-variables-dates-times">3.3.64 special numeric variables: dates &amp; times</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cond">3.3.65 <code class="docutils literal notranslate"><span class="pre">cond</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nested-macros">3.3.70 Nested Macros</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graph">3.3.71 <code class="docutils literal notranslate"><span class="pre">graph</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frame">3.3.80 <code class="docutils literal notranslate"><span class="pre">frame</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#putdocx">3.3.81 <code class="docutils literal notranslate"><span class="pre">putdocx</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#levelsof">3.3.82 <code class="docutils literal notranslate"><span class="pre">levelsof</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tables-beyond-table1">3.3.83 tables beyond <code class="docutils literal notranslate"><span class="pre">table1</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab">3.4 Lab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#homework">3.5 Homework</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-mistakes-from-hw1">Common Mistakes from HW1</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Abimereki Muzaale
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>